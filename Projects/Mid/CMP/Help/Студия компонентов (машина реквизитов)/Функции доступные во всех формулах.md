#Функции, доступные во всех формулах 

Эти функции доступны во всех формулах, используемых при настройке программы: 
* Формулах параметрических отчетов
* Формулах для вычисления реквизитов
* Формулах для вычисления лимитов

Перечень общедоступных функций: 

####Функция "RGB"

Описание функции:
     func RGB(Red :Integer; Green :Integer; Blue :Integer) :Integer; 

Функция позволяет получить необходимый цвет на основании заданных уровней красного, синего и зеленого цвета. Возвращает целое число, определяющее цвет в 24-битном формате. 

Через параметры Red, Green и Blue передаются уровни (целые числа) красного, зеленого и синего цвета соответственно. Так как любой цвет можно определить как сочетание красного, зеленого и синего цвета. 

####Метод "ВызватьФункцию"

Описание метода:

     func ВызватьФункцию(
      const аПолноеИмяМетода :String; 
      const аПараметры :Variant[]
     ) :Variant;

В функциях вычислителя параметрических отчетов, вероятно, реализованы не все возможности, которые могут потребоваться настройщику при решении его задач. Поэтому реализован механизм "расширения" списка доступных для использования функций процедурами, написанными самим настройщиком. Такое "расширение" можно осуществить, реализовав в надпроекте нужную процедуру и вызвав ее с помощью метода ВызватьФункцию. 

В метод ВызватьФункцию передается полное имя процедуры, написанной настройщиком, включающее имя проекта (аПолноеИмяМетода), и список параметров, необходимых для его процедуры (аПараметры). 

####Функция "Загл"

Описание функции:
     func Загл synonym СБольшойБуквы(аИсходнаяСтрока :String) :String; 
Функция возвращает строку аИсходнаяСтрока, в которой первая буква заменена на заглавную. 

####Функция "Падеж"

Описание функции:

    func Падеж synonym ВернутьСловоформу( 
      аОписаниеСловоформ :String;
      аПадежЧисло :Integer = фсИменительныйЕдин; 
      аСБольшойБуквы :Logical = True;
      аОписаниеСловоформПоУмолчанию :String = '' 
    ) :String;
Функция выделяет из строки в формате описания словоформ (строка с разделителями, в которой перечислены различные падежные формы одного существительного), передаваемой в параметре аОписаниеСловоформ, конкретную словоформу, заданную падежом и числом (единственным или множественным). Для указания требуемой словоформы в качестве параметра аПадежЧисло можно использовать следующие константы: 

    фсИменительныйЕдин
    фсИменительныйМнож
    фсРодительныйЕдин
    фсРодительныйМнож
    фсДательныйЕдин
    фсДательныйМнож
    фсВинительныйЕдин
    фсВинительныйМнож
    фсТворительныйЕдин
    фсТворительныйМнож
    фсПредложныйЕдин
    фсПредложныйМнож

Параметр аСБольшойБуквы указывает, следует ли делать первую букву возвращаемой словоформы заглавной (по умолчанию - следует). А в параметре аОписаниеСловоформПоУмолчанию в функцию можно передать дополнительное, "страховочное" описание словоформ, которое будет использовано, если в основном описании нет словоформы для требуемых падежа и числа. 

Пример использования функции "Падеж" в формулах реквизитов: 
    Падеж(%1.Менеджер.СловоФормаДолжность, фсДательныйЕдин)
где %1 - ссылка на конкретный реквизит (например, "ПроцессОткуда"). 

####Функция "ПересчитатьВ" (ConvertTo)

Описание функции:
    func ПересчитатьВ synonym ConvertTo( 
      const Сумма :Numeric;
      const Откуда, Куда :Справочники.ЕдиницаИзмерения;
      const ДатаПересчета :Date = Today; 
      const ОкруглятьДоТочностиЕдИзм :Logical = False;
      const НольЕслиНеСовместимы :Logical = False;
      const СообщениеЕслиНесовместимыЕдИзм, СообщениеЕслиКоэфНоль :String = '';
      const ФиксированныйКурс :Numeric = 0 
    ): Numeric

Функция пересчитывает сумму, переданную в параметре Сумма, из одной единицы измерения или валюты (параметр Откуда) в другую (параметр Куда). 

В параметре ДатаПересчета указывается дата, на которую берется курс. Если же дата не указана, то берется текущая дата. 

Параметр ОкруглятьДоТочностиЕдИзм указывает, округлять ли результат до точности единицы измерения. По умолчанию округление не производится. 

Если параметр НольЕслиНеСовместимы равен True, то при несовместимости валют или единиц измерения (например, при попытке пересчета из рублей в штуки) функция вернет 0, а не выдаст ошибку. Если же (как и по умолчанию) данный параметр равен False, то при несовместимости единиц измерений будет возбуждена ошибка с текстом, передаваемом в параметре "СообщениеЕслиНесовместимыЕдИзм". 

Аналогично, в параметре "СообщениеЕслиКоэфНоль" передается текст сообщения об ошибке, выдаваемой, если курс между заданными валютами или единицами измерения - нулевой. 

В параметре ФиксированныйКурс можно указать фиксированный курс пересчета. Если же данный параметр опущен, то курс, по которому будет идти пересчет, берется из значения курсов валют или отношений единиц измерения на заданную дату. 

####Функция "ПоследнееЗначение / LastValue"

Описание функции:
   ПоследнееЗначение synonym LastValue(
    аИмяПараметра       :String;
    аКонечнаяДата       :Date;
    аУсловиеНаПараметры :String;
    аУсловиеНаСчета     :String = 'УправленческийПлан:Об'
    ) :Variant

Функция возвращает значение указанного параметра из дебетовой полупроводки последней проводки на указанную дату окончания и удовлетворяющую заданным условиям. 

Параметры функции: 

аИмяПараметра - имя параметра проводки, для которого требуется найти значение. 

аКонечнаяДата - дата, на которое требуется найти последнее значение. 

аУсловиеНаПараметры - условие отбора проводок по параметрам. 

аУсловиеНаСчета - условие отбора проводок по счетам. Для управленческих проводок данный параметр можно отпустить, для бухгалтерских проводок - следует указать. 

Результатом функции является произвольное значение. 

####Функция Право

Функция предназначена для получения значения права доступа с именем, переданном через единственный параметр.

Описание функции:
    func Право(аНаименованиеПрава :String) :Variant; 

В функции Право в качестве параметра передается одна из нижеприведенных строк, рядом указан тип возвращаемого значения и его смысл.

   системные права
    'Kernel.LoginSchema'     строка       название действующей схемы доступа
    'Kernel.SetupInterface'  логическое   разрешено настраивать пользовательский интерфейс
    'Kernel.DesignTemplate'  логическое   разрешено переключать бланк в дизайн-режим
    'Kernel.CorrectRefs'     логическое   разрешено проводить коррекцию ссылок
    'Kernel.FullRefresh'     логическое   разрешено проводить полную обработку журналов и справоников
    'Kernel.OpenBlankList'   логическое   разрешено открывать список бланков
    'Kernel.OpenCardList'    логическое   разрешено открывать список картотек
    'Kernel.OpenReports'     логическое   разрешено открывать диалог встроенных отчетов
    'Kernel.OpenRecordsView' логическое   разрешено открывать окно просмотра всех записей
    'Kernel.OpenAccountView' логическое   разрешено открывать список счетов
    'Kernel.AccountFilter'   строка       фильтр на видимые счета
    'Kernel.CloseJurs'       логическое   разрешено закрывать период

Функция возвращает значение указанного права. Тип значения определяется сущностью запрашиваемого права.

####Функция "РабочийДеньПоНомеру"

Описание функции:
    func РабочийДеньПоНомеру(
     НаДату :Date;
     Номер  :Integer;
     Шестидневка :Logical = False
    ) :Date;

Функция возвращает дату рабочего дня по номеру указанному в параметре Номер (если указано отрицательное число, то поиск происходит от конца месяца). Первый параметр (НаДату) определяет год и месяц в котором определяется дата рабочего дня. Параметр Шестидневка определяет количество рабочих дней в неделе, если параметр равен True то количество рабочих дней шесть, иначе пять; 

####Функция "РежимУстановлен" / Функция "РежимыУстановлены" 

Описание функций:
    РежимУстановлен(аРежим :Integer) :Logical
    РежимыУстановлены(аРежимы :Integer[]) :Logical

Функции проверяют, установлен ли определенный режим. Режим - это предопределенная в системе целочисленная константа, указывающая на то, что в данный момент на клиентском месте запущен и работает один из стандартных сервисов. 

В функцию РежимУстановлен в качестве параметра передается константа режима, который требуется проверить, и она возвращает True, если этот режим в настоящий момент установлен. Аналогично, в функцию РежимыУстановлены - список констант в виде массива, и она возвращает True, если в настоящий момент установлен хотя бы один режим из переданных в списке. 

**Константы стандартных режимов**

Константы стандартных режимов, относящиеся к базовым сервисам, реализованным в проекте: 
* рсРасстановкаПартий = 1. Данный режим установлен, пока работает алгоритм локальной или глобальной расстановки партий. 
* рсСозданиеЗаполнениеНаОсновании = 2. Данный режим установлен, пока работает сервис заполнения документа "на основании". 
* рсСверткаСтрок = 3. Данный режим установлен, пока работает сервис "Свернуть позиции". 
* рсРасстановкаПартийЛок = 4. Данный режим установлен, пока работает локальный сервис расстановки партий (одновременно с режимом рсРасстановкаПартий). 
* рсРасстановкаПартийГлоб = 5. Данный режим установлен, пока работает глобальный сервис расстановки партий (одновременно с режимом рсРасстановкаПартий). 
* рсИмпортер = 6. Данный режим установлен, пока работает сервис "Импорт документа". 

**Использование режимов в условиях пересчетов**

Режим можно использовать при пересчетах в условиях или в формулах, заполняя редактор формул. В примере производится проверка стандартного режима сервиса "Заполнить на основании". Если функция возвращает истину, то условие выполнимо, иначе - нет.


####Функция "ТекущийСубъект"

Описание функции:
     func ТекущийСубъект :Управление.Данные.Субъект; 
Функция возвращает запись типа Управление.Данные.Субъект, соответствующую текущему пользователю системы. Результат функции может использоваться, например, для того, чтобы записать ссылку на текущего субъекта в поля документа "Сдал" или "Принял".
