/**
 * @license
 *
 * DHTMLX ToDo v.1.2.0 Professional
 *
 * This software is covered by DHTMLX Commercial License.
 * Usage without proper license is prohibited.
 *
 * (c) XB Software.
 */
var todo=function(t){"use strict";function e(t,e="data-id"){let n=t;for(!n.tagName&&t.target&&(n=t.target);n;){if(n.getAttribute){if(n.getAttribute(e))return n}n=n.parentNode}return null}function n(t,n="data-id"){const s=e(t,n);return s?function(t){if("string"==typeof t){const e=1*t;if(!isNaN(e))return e}return t}(s.getAttribute(n)):null}function s(t,s){let o=null;t.addEventListener("click",(function(t){const n=e(t);if(!n)return;const i=parseInt(n.dataset.id);let r,a=t.target;for(;a!=n;){if(r=a.dataset?a.dataset.action:null,r){s[r]&&s[r](i,t),o=(new Date).valueOf();break}a=a.parentNode}s.click&&!r&&s.click(i,t)})),t.addEventListener("dblclick",(function(t){if(o&&(new Date).valueOf()-o<200)return;const e=n(t);e&&s.dblclick&&s.dblclick(e,t)}))}function o(t,e){const n=["click"],s=n=>{!t||t.contains(n.target)||n.defaultPrevented||e(n)};return n.forEach((t=>document.addEventListener(t,s,!0))),{destroy(){n.forEach((t=>document.removeEventListener(t,s,!0)))}}}function i(t){return t&&"object"==typeof t&&!Array.isArray(t)}function r(t,e){for(const n in e){const s=e[n];i(t[n])&&i(s)?t[n]=r({...t[n]},e[n]):t[n]=e[n]}return t}function a(t){return{getGroup(e){const n=t[e];return t=>n&&n[t]||t},getRaw:()=>t,extend(e,n){if(!e)return this;let s;return s=n?r({...e},t):r({...t},e),a(s)}}}function c(){}function l(t,e){for(const n in e)t[n]=e[n];return t}function d(t){return t()}function u(){return Object.create(null)}function p(t){t.forEach(d)}function f(t){return"function"==typeof t}function h(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function m(t,...e){if(null==t)return c;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function g(t,e,n){t.$$.on_destroy.push(m(e,n))}function $(t,e,n,s){if(t){const o=k(t,e,n,s);return t[0](o)}}function k(t,e,n,s){return t[1]&&s?l(n.ctx.slice(),t[1](s(e))):n.ctx}function v(t,e,n,s){if(t[2]&&s){const o=t[2](s(n));if(void 0===e.dirty)return o;if("object"==typeof o){const t=[],n=Math.max(e.dirty.length,o.length);for(let s=0;s<n;s+=1)t[s]=e.dirty[s]|o[s];return t}return e.dirty|o}return e.dirty}function x(t,e,n,s,o,i){if(o){const r=k(e,n,s,i);t.p(r,o)}}function y(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}function w(t){const e={};for(const n in t)"$"!==n[0]&&(e[n]=t[n]);return e}function b(t,e){const n={};e=new Set(e);for(const s in t)e.has(s)||"$"===s[0]||(n[s]=t[s]);return n}function _(t){return null==t?"":t}function S(t){return t&&f(t.destroy)?t.destroy:c}function T(t,e){t.appendChild(e)}function j(t,e,n){t.insertBefore(e,n||null)}function C(t){t.parentNode.removeChild(t)}function I(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function M(t){return document.createElement(t)}function D(t){return document.createTextNode(t)}function P(){return D(" ")}function E(){return D("")}function N(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function A(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function F(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function L(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function R(t,e){t.value=null==e?"":e}function O(t,e,n,s){t.style.setProperty(e,n,s?"important":"")}function z(t,e,n){t.classList[n?"add":"remove"](e)}(new Date).valueOf();class H{constructor(){this.e=this.n=null}c(t){this.h(t)}m(t,e,n=null){this.e||(this.e=M(e.nodeName),this.t=e,this.c(t)),this.i(n)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}i(t){for(let e=0;e<this.n.length;e+=1)j(this.t,this.n[e],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(C)}}let Y;function q(t){Y=t}function B(){if(!Y)throw new Error("Function called outside component initialization");return Y}function J(t){B().$$.on_mount.push(t)}function G(t){B().$$.after_update.push(t)}function W(){const t=B();return(e,n)=>{const s=t.$$.callbacks[e];if(s){const o=function(t,e,n=!1){const s=document.createEvent("CustomEvent");return s.initCustomEvent(t,n,!1,e),s}(e,n);s.slice().forEach((e=>{e.call(t,o)}))}}}function U(t,e){B().$$.context.set(t,e)}function V(t){return B().$$.context.get(t)}function K(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}const Q=[],X=[],Z=[],tt=[],et=Promise.resolve();let nt=!1;function st(t){Z.push(t)}function ot(t){tt.push(t)}let it=!1;const rt=new Set;function at(){if(!it){it=!0;do{for(let t=0;t<Q.length;t+=1){const e=Q[t];q(e),ct(e.$$)}for(q(null),Q.length=0;X.length;)X.pop()();for(let t=0;t<Z.length;t+=1){const e=Z[t];rt.has(e)||(rt.add(e),e())}Z.length=0}while(Q.length);for(;tt.length;)tt.pop()();nt=!1,it=!1,rt.clear()}}function ct(t){if(null!==t.fragment){t.update(),p(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(st)}}const lt=new Set;let dt;function ut(){dt={r:0,c:[],p:dt}}function pt(){dt.r||p(dt.c),dt=dt.p}function ft(t,e){t&&t.i&&(lt.delete(t),t.i(e))}function ht(t,e,n,s){if(t&&t.o){if(lt.has(t))return;lt.add(t),dt.c.push((()=>{lt.delete(t),s&&(n&&t.d(1),s())})),t.o(e)}}const mt="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function gt(t,e){t.d(1),e.delete(t.key)}function $t(t,e){ht(t,1,1,(()=>{e.delete(t.key)}))}function kt(t,e,n,s,o,i,r,a,c,l,d,u){let p=t.length,f=i.length,h=p;const m={};for(;h--;)m[t[h].key]=h;const g=[],$=new Map,k=new Map;for(h=f;h--;){const t=u(o,i,h),a=n(t);let c=r.get(a);c?s&&c.p(t,e):(c=l(a,t),c.c()),$.set(a,g[h]=c),a in m&&k.set(a,Math.abs(h-m[a]))}const v=new Set,x=new Set;function y(t){ft(t,1),t.m(a,d),r.set(t.key,t),d=t.first,f--}for(;p&&f;){const e=g[f-1],n=t[p-1],s=e.key,o=n.key;e===n?(d=e.first,p--,f--):$.has(o)?!r.has(s)||v.has(s)?y(e):x.has(o)?p--:k.get(s)>k.get(o)?(x.add(s),y(e)):(v.add(o),p--):(c(n,r),p--)}for(;p--;){const e=t[p];$.has(e.key)||c(e,r)}for(;f;)y(g[f-1]);return g}function vt(t,e,n){const s=t.$$.props[e];void 0!==s&&(t.$$.bound[s]=n,n(t.$$.ctx[s]))}function xt(t){t&&t.c()}function yt(t,e,n,s){const{fragment:o,on_mount:i,on_destroy:r,after_update:a}=t.$$;o&&o.m(e,n),s||st((()=>{const e=i.map(d).filter(f);r?r.push(...e):p(e),t.$$.on_mount=[]})),a.forEach(st)}function wt(t,e){const n=t.$$;null!==n.fragment&&(p(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function bt(t,e){-1===t.$$.dirty[0]&&(Q.push(t),nt||(nt=!0,et.then(at)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function _t(t,e,n,s,o,i,r,a=[-1]){const l=Y;q(t);const d=t.$$={fragment:null,ctx:null,props:i,update:c,not_equal:o,bound:u(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:u(),dirty:a,skip_bound:!1,root:e.target||l.$$.root};r&&r(d.root);let f=!1;if(d.ctx=n?n(t,e.props||{},((e,n,...s)=>{const i=s.length?s[0]:n;return d.ctx&&o(d.ctx[e],d.ctx[e]=i)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](i),f&&bt(t,e)),n})):[],d.update(),f=!0,p(d.before_update),d.fragment=!!s&&s(d.ctx),e.target){if(e.hydrate){const t=function(t){return Array.from(t.childNodes)}(e.target);d.fragment&&d.fragment.l(t),t.forEach(C)}else d.fragment&&d.fragment.c();e.intro&&ft(t.$$.fragment),yt(t,e.target,e.anchor,e.customElement),at()}q(l)}class St{$destroy(){wt(this,1),this.$destroy=c}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const{document:Tt}=mt;function jt(t){let e,n,s,o,i,r;const a=t[8].default,c=$(a,t,t[7],null);return{c(){e=P(),n=M("div"),c&&c.c(),F(n,"class",s=`dropdown ${t[0]}-${t[1]} svelte-1iqv09v`),O(n,"width",t[2])},m(s,a){j(s,e,a),j(s,n,a),c&&c.m(n,null),t[9](n),o=!0,i||(r=N(Tt.body,"mousedown",t[4]),i=!0)},p(t,[e]){c&&c.p&&(!o||128&e)&&x(c,a,t,t[7],o?v(a,t[7],e,null):y(t[7]),null),(!o||3&e&&s!==(s=`dropdown ${t[0]}-${t[1]} svelte-1iqv09v`))&&F(n,"class",s),(!o||4&e)&&O(n,"width",t[2])},i(t){o||(ft(c,t),o=!0)},o(t){ht(c,t),o=!1},d(s){s&&C(e),s&&C(n),c&&c.d(s),t[9](null),i=!1,r()}}}function Ct(t,e,n){let s,{$$slots:o={},$$scope:i}=e,{position:r="bottom"}=e,{align:a="start"}=e,{autoFit:c=!0}=e,{cancel:l=null}=e,{width:d="100%"}=e;return G((()=>{if(c){const t=s.getBoundingClientRect(),e=document.body.getBoundingClientRect();return t.right>=e.right&&n(1,a="end"),t.bottom>=e.bottom&&n(0,r="top"),`${r}-${a}`}})),t.$$set=t=>{"position"in t&&n(0,r=t.position),"align"in t&&n(1,a=t.align),"autoFit"in t&&n(5,c=t.autoFit),"cancel"in t&&n(6,l=t.cancel),"width"in t&&n(2,d=t.width),"$$scope"in t&&n(7,i=t.$$scope)},[r,a,d,s,function(t){s.contains(t.target)||l&&l(t)},c,l,i,o,function(t){X[t?"unshift":"push"]((()=>{s=t,n(3,s)}))}]}class It extends St{constructor(t){super(),_t(this,t,Ct,jt,h,{position:0,align:1,autoFit:5,cancel:6,width:2})}}function Mt(t){let e;return{c(){e=M("span"),F(e,"class","spacer svelte-1sypd9a")},m(t,n){j(t,e,n)},p:c,d(t){t&&C(e)}}}function Dt(t){let e,n,s;return{c(){e=M("i"),F(e,"class","pager wxi-angle-left svelte-1sypd9a")},m(o,i){j(o,e,i),n||(s=N(e,"click",(function(){f(t[0])&&t[0].apply(this,arguments)})),n=!0)},p(e,n){t=e},d(t){t&&C(e),n=!1,s()}}}function Pt(t){let e;return{c(){e=M("span"),F(e,"class","spacer svelte-1sypd9a")},m(t,n){j(t,e,n)},p:c,d(t){t&&C(e)}}}function Et(t){let e,n,s;return{c(){e=M("i"),F(e,"class","pager wxi-angle-right svelte-1sypd9a")},m(o,i){j(o,e,i),n||(s=N(e,"click",(function(){f(t[1])&&t[1].apply(this,arguments)})),n=!0)},p(e,n){t=e},d(t){t&&C(e),n=!1,s()}}}function Nt(t){let e,n,s,o,i,r,a;function l(t,e){return"right"!=t[2]?Dt:Mt}let d=l(t),u=d(t);function p(t,e){return"left"!=t[2]?Et:Pt}let f=p(t),h=f(t);return{c(){e=M("div"),u.c(),n=P(),s=M("span"),o=D(t[3]),i=P(),h.c(),F(s,"class","label svelte-1sypd9a"),F(e,"class","header svelte-1sypd9a")},m(c,l){j(c,e,l),u.m(e,null),T(e,n),T(e,s),T(s,o),T(e,i),h.m(e,null),r||(a=N(s,"click",t[4]),r=!0)},p(t,[s]){d===(d=l(t))&&u?u.p(t,s):(u.d(1),u=d(t),u&&(u.c(),u.m(e,n))),8&s&&L(o,t[3]),f===(f=p(t))&&h?h.p(t,s):(h.d(1),h=f(t),h&&(h.c(),h.m(e,null)))},i:c,o:c,d(t){t&&C(e),u.d(),h.d(),r=!1,a()}}}function At(t,e,n){const s=V("wx-i18n").getRaw().calendar.monthFull;let o,i,r,{date:a}=e,{type:c}=e,{prev:l}=e,{next:d}=e,{part:u}=e;return t.$$set=t=>{"date"in t&&n(6,a=t.date),"type"in t&&n(5,c=t.type),"prev"in t&&n(0,l=t.prev),"next"in t&&n(1,d=t.next),"part"in t&&n(2,u=t.part)},t.$$.update=()=>{if(480&t.$$.dirty)switch(n(7,o=a.getMonth()),n(8,i=a.getFullYear()),c){case"month":n(3,r=`${s[o]} ${i}`);break;case"year":n(3,r=i);break;case"duodecade":{const t=i-i%10;n(3,r=`${t} - ${t+9}`);break}}},[l,d,u,r,function(){"month"===c?n(5,c="year"):"year"===c&&n(5,c="duodecade")},c,a,o,i]}class Ft extends St{constructor(t){super(),_t(this,t,At,Nt,h,{date:6,type:5,prev:0,next:1,part:2})}}function Lt(t,e,n){const s=t.slice();return s[16]=e[n],s}function Rt(t,e,n){const s=t.slice();return s[16]=e[n],s}function Ot(t){let e,n,s=t[16]+"";return{c(){e=M("div"),n=D(s),F(e,"class","weekday svelte-102f3tn")},m(t,s){j(t,e,s),T(e,n)},p:c,d(t){t&&C(e)}}}function zt(t,e){let n,s,o,i,r,a=e[16].day+"";return{key:t,first:null,c(){n=M("div"),s=D(a),o=P(),F(n,"class",i="day "+e[16].css+" svelte-102f3tn"),F(n,"data-id",r=e[16].date),z(n,"out",!e[16].in),this.first=n},m(t,e){j(t,n,e),T(n,s),T(n,o)},p(t,o){e=t,1&o&&a!==(a=e[16].day+"")&&L(s,a),1&o&&i!==(i="day "+e[16].css+" svelte-102f3tn")&&F(n,"class",i),1&o&&r!==(r=e[16].date)&&F(n,"data-id",r),1&o&&z(n,"out",!e[16].in)},d(t){t&&C(n)}}}function Ht(t){let e,n,o,i,r,a=[],l=new Map,d=t[1],u=[];for(let e=0;e<d.length;e+=1)u[e]=Ot(Rt(t,d,e));let p=t[0];const f=t=>t[16].date;for(let e=0;e<p.length;e+=1){let n=Lt(t,p,e),s=f(n);l.set(s,a[e]=zt(s,n))}return{c(){e=M("div");for(let t=0;t<u.length;t+=1)u[t].c();n=P(),o=M("div");for(let t=0;t<a.length;t+=1)a[t].c();F(e,"class","weekdays svelte-102f3tn"),F(o,"class","days svelte-102f3tn")},m(c,l){j(c,e,l);for(let t=0;t<u.length;t+=1)u[t].m(e,null);j(c,n,l),j(c,o,l);for(let t=0;t<a.length;t+=1)a[t].m(o,null);i||(r=S(s.call(null,o,t[2])),i=!0)},p(t,[n]){if(2&n){let s;for(d=t[1],s=0;s<d.length;s+=1){const o=Rt(t,d,s);u[s]?u[s].p(o,n):(u[s]=Ot(o),u[s].c(),u[s].m(e,null))}for(;s<u.length;s+=1)u[s].d(1);u.length=d.length}1&n&&(p=t[0],a=kt(a,n,f,1,t,p,l,o,gt,zt,null,Lt))},i:c,o:c,d(t){t&&C(e),I(u,t),t&&C(n),t&&C(o);for(let t=0;t<a.length;t+=1)a[t].d();i=!1,r()}}}function Yt(t){const e=t.getDay();return 0===e||6===e}function qt(t,e,n){let{value:s}=e,{current:o}=e,{cancel:i}=e,{part:r}=e,{markers:a=null}=e;const c=V("wx-i18n").getRaw().calendar,l=(c.weekStart||7)%7,d=c.dayShort.slice(l).concat(c.dayShort.slice(0,l));let u,p;const f=(t,e,n)=>new Date(t.getFullYear(),t.getMonth()+(e||0),t.getDate()+(n||0));let h="normal"!==r;const m={click:function(t,e){e.stopPropagation(),t?(n(4,o=new Date(t)),"normal"===r?n(3,s=new Date(o)):(s||n(3,s={start:null,end:null}),s.end||!s.start?n(3,s={start:new Date(o),end:null}):(n(3,s.end=new Date(o),s),s.end<s.start&&n(3,[s.start,s.end]=[s.end,s.start],s)))):(n(3,s=null),n(4,o=new Date));"normal"===r&&i()}};return t.$$set=t=>{"value"in t&&n(3,s=t.value),"current"in t&&n(4,o=t.current),"cancel"in t&&n(5,i=t.cancel),"part"in t&&n(6,r=t.part),"markers"in t&&n(7,a=t.markers)},t.$$.update=()=>{if(473&t.$$.dirty){n(8,p="normal"==r?[s?f(s).valueOf():0]:s?[s.start?f(s.start).valueOf():0,s.end?f(s.end).valueOf():0]:[0,0]);const t=function(){const t=f(o,0,1-o.getDate());return t.setDate(t.getDate()-(t.getDay()-(l-7))%7),t}(),e=function(){const t=f(o,1,-o.getDate());return t.setDate(t.getDate()+(6-t.getDay()+l)%7),t}(),i=o.getMonth();n(0,u=[]);for(let n=t;n<=e;n.setDate(n.getDate()+1)){const t={day:n.getDate(),in:n.getMonth()===i,date:n.valueOf()};let e="";if(e+=t.in?"":" inactive",e+=p.indexOf(t.date)>-1?" selected":"",h){const n=t.date==p[0],s=t.date==p[1];n&&!s?e+=" left":s&&!n&&(e+=" right"),t.date>p[0]&&t.date<p[1]&&(e+=" inrange")}if(e+=Yt(n)?" weekend":"",a){const t=a(n);t&&(e+=" "+t)}u.push({...t,css:e})}}},[u,d,m,s,o,i,r,a,p]}class Bt extends St{constructor(t){super(),_t(this,t,qt,Ht,h,{value:3,current:4,cancel:5,part:6,markers:7})}}function Jt(t){let e,n,s,o;const i=t[2].default,r=$(i,t,t[1],null);return{c(){e=M("button"),r&&r.c(),F(e,"class","svelte-1bjiwod")},m(i,a){j(i,e,a),r&&r.m(e,null),n=!0,s||(o=N(e,"click",(function(){f(t[0])&&t[0].apply(this,arguments)})),s=!0)},p(e,[s]){t=e,r&&r.p&&(!n||2&s)&&x(r,i,t,t[1],n?v(i,t[1],s,null):y(t[1]),null)},i(t){n||(ft(r,t),n=!0)},o(t){ht(r,t),n=!1},d(t){t&&C(e),r&&r.d(t),s=!1,o()}}}function Gt(t,e,n){let{$$slots:s={},$$scope:o}=e,{click:i}=e;return t.$$set=t=>{"click"in t&&n(0,i=t.click),"$$scope"in t&&n(1,o=t.$$scope)},[i,o,s]}class Wt extends St{constructor(t){super(),_t(this,t,Gt,Jt,h,{click:0})}}function Ut(t,e,n){const s=t.slice();return s[9]=e[n],s[11]=n,s}function Vt(t){let e,n,s,o,i=t[9]+"";return{c(){e=M("div"),n=D(i),s=P(),F(e,"class","month svelte-1nvkxt9"),F(e,"data-id",o=t[11]),z(e,"current",t[1]===t[11])},m(t,o){j(t,e,o),T(e,n),T(e,s)},p(t,n){2&n&&z(e,"current",t[1]===t[11])},d(t){t&&C(e)}}}function Kt(t){let e,n=t[2].done+"";return{c(){e=D(n)},m(t,n){j(t,e,n)},p:c,d(t){t&&C(e)}}}function Qt(t){let e,n,o,i,r,a,c,l=t[3],d=[];for(let e=0;e<l.length;e+=1)d[e]=Vt(Ut(t,l,e));return i=new Wt({props:{click:t[0],$$slots:{default:[Kt]},$$scope:{ctx:t}}}),{c(){e=M("div");for(let t=0;t<d.length;t+=1)d[t].c();n=P(),o=M("div"),xt(i.$$.fragment),F(e,"class","months svelte-1nvkxt9"),F(o,"class","buttons svelte-1nvkxt9")},m(l,u){j(l,e,u);for(let t=0;t<d.length;t+=1)d[t].m(e,null);j(l,n,u),j(l,o,u),yt(i,o,null),r=!0,a||(c=S(s.call(null,e,t[4])),a=!0)},p(t,[n]){if(10&n){let s;for(l=t[3],s=0;s<l.length;s+=1){const o=Ut(t,l,s);d[s]?d[s].p(o,n):(d[s]=Vt(o),d[s].c(),d[s].m(e,null))}for(;s<d.length;s+=1)d[s].d(1);d.length=l.length}const s={};1&n&&(s.click=t[0]),4096&n&&(s.$$scope={dirty:n,ctx:t}),i.$set(s)},i(t){r||(ft(i.$$.fragment,t),r=!0)},o(t){ht(i.$$.fragment,t),r=!1},d(t){t&&C(e),I(d,t),t&&C(n),t&&C(o),wt(i),a=!1,c()}}}function Xt(t,e,n){let{value:s}=e,{current:o}=e,{cancel:i}=e,{part:r}=e;const a=V("wx-i18n").getRaw().calendar,c=a.monthShort;let l;const d={click:function(t){t&&(o.setMonth(t),n(6,o));"normal"===r&&n(5,s=new Date(o));i()}};return t.$$set=t=>{"value"in t&&n(5,s=t.value),"current"in t&&n(6,o=t.current),"cancel"in t&&n(0,i=t.cancel),"part"in t&&n(7,r=t.part)},t.$$.update=()=>{224&t.$$.dirty&&("normal"!==r&&s?"left"===r&&s.start?n(1,l=s.start.getMonth()):"right"===r&&s.end?n(1,l=s.end.getMonth()):n(1,l=o.getMonth()):n(1,l=o.getMonth()))},[i,l,a,c,d,s,o,r]}class Zt extends St{constructor(t){super(),_t(this,t,Xt,Qt,h,{value:5,current:6,cancel:0,part:7})}}function te(t,e,n){const s=t.slice();return s[9]=e[n],s[11]=n,s}function ee(t){let e,n,s,o,i=t[9]+"";return{c(){e=M("div"),n=D(i),s=P(),F(e,"class","year svelte-62ny1k"),F(e,"data-id",o=t[9]),z(e,"current",t[2]==t[9]),z(e,"prev-decade",0===t[11]),z(e,"next-decade",11===t[11])},m(t,o){j(t,e,o),T(e,n),T(e,s)},p(t,s){2&s&&i!==(i=t[9]+"")&&L(n,i),2&s&&o!==(o=t[9])&&F(e,"data-id",o),6&s&&z(e,"current",t[2]==t[9])},d(t){t&&C(e)}}}function ne(t){let e,n=t[3].done+"";return{c(){e=D(n)},m(t,n){j(t,e,n)},p:c,d(t){t&&C(e)}}}function se(t){let e,n,o,i,r,a,c,l=t[1],d=[];for(let e=0;e<l.length;e+=1)d[e]=ee(te(t,l,e));return i=new Wt({props:{click:t[0],$$slots:{default:[ne]},$$scope:{ctx:t}}}),{c(){e=M("div");for(let t=0;t<d.length;t+=1)d[t].c();n=P(),o=M("div"),xt(i.$$.fragment),F(e,"class","years svelte-62ny1k"),F(o,"class","buttons svelte-62ny1k")},m(l,u){j(l,e,u);for(let t=0;t<d.length;t+=1)d[t].m(e,null);j(l,n,u),j(l,o,u),yt(i,o,null),r=!0,a||(c=S(s.call(null,e,t[4])),a=!0)},p(t,[n]){if(6&n){let s;for(l=t[1],s=0;s<l.length;s+=1){const o=te(t,l,s);d[s]?d[s].p(o,n):(d[s]=ee(o),d[s].c(),d[s].m(e,null))}for(;s<d.length;s+=1)d[s].d(1);d.length=l.length}const s={};1&n&&(s.click=t[0]),4096&n&&(s.$$scope={dirty:n,ctx:t}),i.$set(s)},i(t){r||(ft(i.$$.fragment,t),r=!0)},o(t){ht(i.$$.fragment,t),r=!1},d(t){t&&C(e),I(d,t),t&&C(n),t&&C(o),wt(i),a=!1,c()}}}function oe(t,e,n){const s=V("wx-i18n").getRaw().calendar;let o,i,{value:r}=e,{current:a}=e,{cancel:c}=e,{part:l}=e;const d={click:function(t){t&&(a.setFullYear(t),n(6,a));"normal"===l&&n(5,r=new Date(a));c()}};return t.$$set=t=>{"value"in t&&n(5,r=t.value),"current"in t&&n(6,a=t.current),"cancel"in t&&n(0,c=t.cancel),"part"in t&&n(7,l=t.part)},t.$$.update=()=>{if(230&t.$$.dirty){"normal"!==l&&r?"left"===l&&r.start?n(2,i=r.start.getFullYear()):"right"===l&&r.end?n(2,i=r.end.getFullYear()):n(2,i=a.getFullYear()):n(2,i=a.getFullYear());const t=i-i%10-1,e=t+12;n(1,o=[]);for(let n=t;n<e;++n)o.push(n)}},[c,o,i,s,d,r,a,l]}class ie extends St{constructor(t){super(),_t(this,t,oe,se,h,{value:5,current:6,cancel:0,part:7})}}function re(t){let e,n,s,o,i,r,a;return s=new Wt({props:{click:t[13],$$slots:{default:[ae]},$$scope:{ctx:t}}}),r=new Wt({props:{click:t[14],$$slots:{default:[ce]},$$scope:{ctx:t}}}),{c(){e=M("div"),n=M("div"),xt(s.$$.fragment),o=P(),i=M("div"),xt(r.$$.fragment),F(n,"class","button-item svelte-sor66p"),F(i,"class","button-item svelte-sor66p"),F(e,"class","buttons svelte-sor66p")},m(t,c){j(t,e,c),T(e,n),yt(s,n,null),T(e,o),T(e,i),yt(r,i,null),a=!0},p(t,e){const n={};16777216&e&&(n.$$scope={dirty:e,ctx:t}),s.$set(n);const o={};16777216&e&&(o.$$scope={dirty:e,ctx:t}),r.$set(o)},i(t){a||(ft(s.$$.fragment,t),ft(r.$$.fragment,t),a=!0)},o(t){ht(s.$$.fragment,t),ht(r.$$.fragment,t),a=!1},d(t){t&&C(e),wt(s),wt(r)}}}function ae(t){let e,n=t[6]("clear")+"";return{c(){e=D(n)},m(t,n){j(t,e,n)},p:c,d(t){t&&C(e)}}}function ce(t){let e,n=t[6]("today")+"";return{c(){e=D(n)},m(t,n){j(t,e,n)},p:c,d(t){t&&C(e)}}}function le(t){let e,n,s,o,i,r,a,c,l,d,u,p;function f(e){t[10](e)}let h={date:t[1],part:t[2],prev:t[7][t[5]].prev,next:t[7][t[5]].next};function m(e){t[11](e)}function g(e){t[12](e)}void 0!==t[5]&&(h.type=t[5]),s=new Ft({props:h}),X.push((()=>vt(s,"type",f)));var $=t[7][t[5]].component;function k(t){let e={part:t[2],markers:t[3],cancel:t[7][t[5]].cancel};return void 0!==t[0]&&(e.value=t[0]),void 0!==t[1]&&(e.current=t[1]),{props:e}}$&&(a=new $(k(t)),X.push((()=>vt(a,"value",m))),X.push((()=>vt(a,"current",g))));let v="month"===t[5]&&"normal"===t[2]&&t[4]&&re(t);return{c(){e=M("div"),n=M("div"),xt(s.$$.fragment),i=P(),r=M("div"),a&&xt(a.$$.fragment),d=P(),v&&v.c(),F(r,"class","body"),F(n,"class","wrap svelte-sor66p"),F(e,"class",u="calendar "+("normal"!==t[2]?"part":"")+" svelte-sor66p")},m(t,o){j(t,e,o),T(e,n),yt(s,n,null),T(n,i),T(n,r),a&&yt(a,r,null),T(r,d),v&&v.m(r,null),p=!0},p(t,[n]){const i={};2&n&&(i.date=t[1]),4&n&&(i.part=t[2]),32&n&&(i.prev=t[7][t[5]].prev),32&n&&(i.next=t[7][t[5]].next),!o&&32&n&&(o=!0,i.type=t[5],ot((()=>o=!1))),s.$set(i);const f={};if(4&n&&(f.part=t[2]),8&n&&(f.markers=t[3]),32&n&&(f.cancel=t[7][t[5]].cancel),!c&&1&n&&(c=!0,f.value=t[0],ot((()=>c=!1))),!l&&2&n&&(l=!0,f.current=t[1],ot((()=>l=!1))),$!==($=t[7][t[5]].component)){if(a){ut();const t=a;ht(t.$$.fragment,1,0,(()=>{wt(t,1)})),pt()}$?(a=new $(k(t)),X.push((()=>vt(a,"value",m))),X.push((()=>vt(a,"current",g))),xt(a.$$.fragment),ft(a.$$.fragment,1),yt(a,r,d)):a=null}else $&&a.$set(f);"month"===t[5]&&"normal"===t[2]&&t[4]?v?(v.p(t,n),52&n&&ft(v,1)):(v=re(t),v.c(),ft(v,1),v.m(r,null)):v&&(ut(),ht(v,1,1,(()=>{v=null})),pt()),(!p||4&n&&u!==(u="calendar "+("normal"!==t[2]?"part":"")+" svelte-sor66p"))&&F(e,"class",u)},i(t){p||(ft(s.$$.fragment,t),a&&ft(a.$$.fragment,t),ft(v),p=!0)},o(t){ht(s.$$.fragment,t),a&&ht(a.$$.fragment,t),ht(v),p=!1},d(t){t&&C(e),wt(s),a&&wt(a),v&&v.d()}}}function de(t,e,n){const s=V("wx-i18n").getGroup("calendar");let{value:o}=e,{current:i}=e,{cancel:r=null}=e,{part:a="normal"}=e,{markers:c=null}=e,{buttons:l=!0}=e,d="month";const u={month:{component:Bt,next:function(){i.setMonth(i.getMonth()+1),n(1,i),n(0,o)},prev:function(){let t=new Date(i);t.setMonth(i.getMonth()-1);for(;i.getMonth()===t.getMonth();)t.setDate(t.getDate()-1);n(1,i=t)},cancel:p},year:{component:Zt,next:function(){i.setFullYear(i.getFullYear()+1),n(1,i),n(0,o)},prev:function(){i.setFullYear(i.getFullYear()-1),n(1,i),n(0,o)},cancel:function(){n(5,d="month")}},duodecade:{component:ie,next:function(){i.setFullYear(i.getFullYear()+10),n(1,i),n(0,o)},prev:function(){i.setFullYear(i.getFullYear()-10),n(1,i),n(0,o)},cancel:function(){n(5,d="year")}}};function p(){o&&"normal"===a&&n(1,i=new Date(o)),n(5,d="month"),r&&r()}function f(t,e){t.stopPropagation(),e?(n(1,i=new Date(e)),n(0,o=new Date(i))):(n(0,o=null),n(1,i=new Date)),"normal"===a&&p()}return t.$$set=t=>{"value"in t&&n(0,o=t.value),"current"in t&&n(1,i=t.current),"cancel"in t&&n(9,r=t.cancel),"part"in t&&n(2,a=t.part),"markers"in t&&n(3,c=t.markers),"buttons"in t&&n(4,l=t.buttons)},t.$$.update=()=>{3&t.$$.dirty&&n(1,i=i||o||new Date)},[o,i,a,c,l,d,s,u,f,r,function(t){d=t,n(5,d)},function(t){o=t,n(0,o)},function(t){i=t,n(1,i),n(0,o)},t=>f(t),t=>f(t,new Date)]}class ue extends St{constructor(t){super(),_t(this,t,de,le,h,{value:0,current:1,cancel:9,part:2,markers:3,buttons:4})}}function pe(t){let e,n,s;const o=t[4].default,i=$(o,t,t[3],null);return{c(){e=M("div"),i&&i.c(),F(e,"class",n="wx-portal wx-"+t[0]+"-theme")},m(n,o){j(n,e,o),i&&i.m(e,null),t[5](e),s=!0},p(t,[r]){i&&i.p&&(!s||8&r)&&x(i,o,t,t[3],s?v(o,t[3],r,null):y(t[3]),null),(!s||1&r&&n!==(n="wx-portal wx-"+t[0]+"-theme"))&&F(e,"class",n)},i(t){s||(ft(i,t),s=!0)},o(t){ht(i,t),s=!1},d(n){n&&C(e),i&&i.d(n),t[5](null)}}}function fe(t,e,n){let s,{$$slots:o={},$$scope:i}=e,{theme:r=""}=e,{target:a=document.body}=e;return""===r&&(r=V("wx-theme")),J((()=>{a.appendChild(s)})),t.$$set=t=>{"theme"in t&&n(0,r=t.theme),"target"in t&&n(2,a=t.target),"$$scope"in t&&n(3,i=t.$$scope)},[r,s,a,i,o,function(t){X[t?"unshift":"push"]((()=>{s=t,n(1,s)}))}]}class he extends St{constructor(t){super(),_t(this,t,fe,pe,h,{theme:0,target:2})}}function me(t){let e,n;return{c(){e=new H,n=E(),e.a=n},m(t,s){e.m("<style>\n@font-face {\nfont-family: 'Roboto';\nfont-style: normal;\nfont-weight: 400;\nsrc: local(''),\n    url('https://cdn.webix.com/fonts/roboto/regular.woff2') format('woff2'),\n    url('https://cdn.webix.com/fonts/roboto/regular.woff') format('woff');\n}\n@font-face {\nfont-family: 'Roboto';\nfont-style: normal;\nfont-weight: 500;\nsrc: local(''),\n    url('https://cdn.webix.com/fonts/roboto/500.woff2') format('woff2'),\n    url('https://cdn.webix.com/fonts/roboto/500.woff') format('woff');\n}</style>",t,s),j(t,n,s)},p:c,i:c,o:c,d(t){t&&C(n),t&&e.d()}}}class ge extends St{constructor(t){super(),_t(this,t,null,me,h,{})}}function $e(t){let e,n,s,o,i,r;return s=new ge({}),{c(){e=M("link"),n=P(),xt(s.$$.fragment),o=P(),i=M("link"),F(e,"rel","preconnect"),F(e,"href","https://cdn.webix.com"),F(e,"crossorigin",""),F(i,"rel","stylesheet"),F(i,"href","https://webix.io/dev/fonts/wxi/wx-icons.css")},m(t,a){j(t,e,a),j(t,n,a),yt(s,t,a),j(t,o,a),j(t,i,a),r=!0},i(t){r||(ft(s.$$.fragment,t),r=!0)},o(t){ht(s.$$.fragment,t),r=!1},d(t){t&&C(e),t&&C(n),wt(s,t),t&&C(o),t&&C(i)}}}function ke(t){let e,n,s,o=t[1]&&t[1].default&&function(t){let e,n;const s=t[3].default,o=$(s,t,t[2],null);return{c(){e=M("div"),o&&o.c(),F(e,"class","wx-material-theme"),O(e,"height","100%")},m(t,s){j(t,e,s),o&&o.m(e,null),n=!0},p(t,e){o&&o.p&&(!n||4&e)&&x(o,s,t,t[2],n?v(s,t[2],e,null):y(t[2]),null)},i(t){n||(ft(o,t),n=!0)},o(t){ht(o,t),n=!1},d(t){t&&C(e),o&&o.d(t)}}}(t),i=t[0]&&$e();return{c(){o&&o.c(),e=P(),i&&i.c(),n=E()},m(t,r){o&&o.m(t,r),j(t,e,r),i&&i.m(document.head,null),T(document.head,n),s=!0},p(t,[e]){t[1]&&t[1].default&&o.p(t,e),t[0]?i?1&e&&ft(i,1):(i=$e(),i.c(),ft(i,1),i.m(n.parentNode,n)):i&&(ut(),ht(i,1,1,(()=>{i=null})),pt())},i(t){s||(ft(o),ft(i),s=!0)},o(t){ht(o),ht(i),s=!1},d(t){o&&o.d(t),t&&C(e),i&&i.d(t),C(n)}}}function ve(t,e,n){let{$$slots:s={},$$scope:o}=e,{fonts:i=!0}=e;const r=e.$$slots;return U("wx-theme","material"),t.$$set=t=>{n(4,e=l(l({},e),w(t))),"fonts"in t&&n(0,i=t.fonts),"$$scope"in t&&n(2,o=t.$$scope)},e=w(e),[i,r,o,s]}class xe extends St{constructor(t){super(),_t(this,t,ve,ke,h,{fonts:0})}}const ye={core:{ok:"OK",cancel:"Cancel"},calendar:{monthFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],hours:"Hours",minutes:"Minutes",done:"Done",clear:"Clear",today:"Today",am:["am","AM"],pm:["pm","PM"],weekStart:7,timeFormat:24}};function we(t){let e;const n=t[3].default,s=$(n,t,t[2],null);return{c(){s&&s.c()},m(t,n){s&&s.m(t,n),e=!0},p(t,[o]){s&&s.p&&(!e||4&o)&&x(s,n,t,t[2],e?v(n,t[2],o,null):y(t[2]),null)},i(t){e||(ft(s,t),e=!0)},o(t){ht(s,t),e=!1},d(t){s&&s.d(t)}}}function be(t,e,n){let{$$slots:s={},$$scope:o}=e,{words:i=null}=e,{optional:r=!1}=e,c=V("wx-i18n");return c||(c=a(ye)),c=c.extend(i,r),U("wx-i18n",c),t.$$set=t=>{"words"in t&&n(0,i=t.words),"optional"in t&&n(1,r=t.optional),"$$scope"in t&&n(2,o=t.$$scope)},[i,r,o,s]}class _e extends St{constructor(t){super(),_t(this,t,be,we,h,{words:0,optional:1})}}function Se(t){let e,n;const s=t[1].default,o=$(s,t,t[2],null);return{c(){e=M("div"),o&&o.c(),F(e,"class","wx-material-theme"),O(e,"height","100%"),O(e,"width","100%")},m(t,s){j(t,e,s),o&&o.m(e,null),n=!0},p(t,e){o&&o.p&&(!n||4&e)&&x(o,s,t,t[2],n?v(s,t[2],e,null):y(t[2]),null)},i(t){n||(ft(o,t),n=!0)},o(t){ht(o,t),n=!1},d(t){t&&C(e),o&&o.d(t)}}}function Te(t){let e,n,s=t[0]&&t[0].default&&function(t){let e,n;return e=new xe({props:{$$slots:{default:[Se]},$$scope:{ctx:t}}}),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};4&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}(t);return{c(){s&&s.c(),e=E()},m(t,o){s&&s.m(t,o),j(t,e,o),n=!0},p(t,[e]){t[0]&&t[0].default&&s.p(t,e)},i(t){n||(ft(s),n=!0)},o(t){ht(s),n=!1},d(t){s&&s.d(t),t&&C(e)}}}function je(t,e,n){let{$$slots:s={},$$scope:o}=e;const i=e.$$slots;return t.$$set=t=>{n(3,e=l(l({},e),w(t))),"$$scope"in t&&n(2,o=t.$$scope)},e=w(e),[i,s,o]}class Ce extends St{constructor(t){super(),_t(this,t,je,Te,h,{})}}const Ie={core:{ok:"OK",cancel:"Cancel"},calendar:{monthFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],hours:"Hours",minutes:"Minutes",done:"Done",clear:"Clear",today:"Today",am:["am","AM"],pm:["pm","PM"],weekStart:7,timeFormat:24}};var Me={todo:{"No project":"No project","Search project":"Search project","Add project":"Add project","Rename project":"Rename project","Delete project":"Delete project","Completed tasks":"Completed tasks",Show:"Show",Hide:"Hide","Sort by":"Sort by","Text (a-z)":"Text (a-z)","Text (z-a)":"Text (z-a)","Due date (new to old)":"Due date (new to old)","Due date (old to new)":"Due date (old to new)","Completion date (new to old)":"Completion date (new to old)","Completion date (old to new)":"Completion date (old to new)","Created (new to old)":"Created (new to old)","Created (old to new)":"Created (old to new)","Edited (new to old)":"Edited (new to old)","Edited (old to new)":"Edited (old to new)","Priority (high to low)":"Priority (high to low)","Priority (low to high)":"Priority (low to high)","Add task below":"Add task below","Add subtask":"Add subtask","Set due date":"Set due date","Set priority":"Set priority","Reset priority":"Reset priority",Indent:"Indent",Unindent:"Unindent","Assign to":"Assign to","Move to":"Move to",Duplicate:"Duplicate",Copy:"Copy",Paste:"Paste",Delete:"Delete",Enter:"Enter",Tab:"Tab","Shift+Tab":"Shift+Tab","Ctrl+D":"Ctrl+D","Ctrl+C":"Ctrl+C","Ctrl+V":"Ctrl+V","CMD+D":"CMD+D","CMD+C":"CMD+C","CMD+V":"CMD+V","Type what you want":"Type what you want",Search:"Search","Add task":"Add task","New project":"New project",High:"High",Medium:"Medium",Low:"Low"}};let De=(new Date).valueOf();const Pe=()=>De++;class Ee{constructor(t,e,n){this._setter=t,this._routes=e,this._parsers=n,this._prev={},this._triggers=new Map,this._sources=new Map,this._routes.forEach((t=>{t.in.forEach((e=>{const n=this._triggers.get(e)||[];n.push(t),this._triggers.set(e,n)})),t.out.forEach((e=>{const n=this._sources.get(e)||{};t.in.forEach((t=>n[t]=!0)),this._sources.set(e,n)}))})),this._routes.forEach((t=>{t.length=Math.max(...t.in.map((t=>Ne(t,this._sources,1))))}))}init(t){const e={};for(const n in t)if(this._prev[n]!==t[n]){const s=this._parsers[n];e[n]=s?s(t[n]):t[n]}this._prev=this._prev?{...this._prev,...t}:{...t},this.setState(e)}setState(t,e){this._setter(t);const n=!e;e=e||[];for(const n in t){const t=this._triggers.get(n);t&&t.forEach((t=>{-1==e.indexOf(t)&&e.push(t)}))}n&&this._execNext(e)}_execNext(t){for(;t.length;){t.sort(((t,e)=>t.length<e.length?1:-1));const e=t[t.length-1];t.splice(t.length-1),e.exec(t)}}}function Ne(t,e,n){const s=e.get(t);if(!s)return n;const o=Object.keys(s).map((t=>Ne(t,e,n+1)));return Math.max(...o)}class Ae{constructor(){this._nextHandler=()=>null,this._handlers={},this.exec=this.exec.bind(this)}on(t,e){const n=this._handlers[t];this._handlers[t]=n?function(t){Fe(n,t)(e(t))}:n=>{Fe(this._nextHandler,n,t)(e(n))}}exec(t,e){const n=this._handlers[t];n?n(e):this._nextHandler(t,e)}setNext(t){this._nextHandler=t}}function Fe(t,e,n){return s=>{!1!==s&&(s&&s.then?s.then(Fe(t,e,n)):n?t(n,e):t(e))}}class Le{constructor(t){this._nextHandler=()=>null,this._dispatch=t,this.exec=this.exec.bind(this)}exec(t,e){this._dispatch(t,e),this._nextHandler&&this._nextHandler(t,e)}setNext(t){this._nextHandler=t}}let Re=(new Date).valueOf();function Oe(){return Re+=1,"temp://"+Re}function ze(t,e){return t==e}function He(t){return null!=t}function Ye(t){return null===t}function qe(t,e){const n=t.length;for(let s=0;s<n;s++)if(e(t[s]))return s;return-1}function Be(t){return/\s/g.test(t)}function Je(){return navigator.userAgent.indexOf("Mac")>-1}function Ge(t){if(!t)return t;const e=Array.isArray(t)?[]:{};for(const n in t){const s=t[n];s instanceof Date?e[n]=new Date(s):e[n]="object"==typeof s?Ge(s):s}return e}function We(t){return t.flatMap((({children:t,...e})=>[e,...We(t||[])]))}const Ue=["#607D8B","#00C7B5","#03A9F4","#9575CD","#F06292","#FF9800"],Ve=["#ff5252","#ffc975","#0ab169","#607D8B","#00C7B5","#03A9F4","#9575CD","#F06292","#FF9800"],Ke={counter:{type:"number"},date:{format:"%d %M %Y",validate:!0},completed:{behavior:"auto",taskHide:!1},priority:{label:!0,cover:!0}},Qe={expand:!0},Xe=[{id:1,label:"High",color:"#ff5252"/*,hotkey:"Alt+1"*/},{id:2,label:"Medium",color:"#ffc975"/*,hotkey:"Alt+2"*/},{id:3,label:"Low",color:"#0ab169"/*,hotkey:"Alt+3"*/}],Ze=t=>new RegExp(String.raw`(?:^|)${t}(?:\s|$)`,"gm"),tn=t=>new RegExp(String.raw`\B[${t}]\w\S+`,"gm");function en(t,e,n){if(n){const n=Ze(e);return!!t.match(n)?.length}return t.toLowerCase().includes(e.toLowerCase())}function nn(t=[],e){return t.map((t=>({...t,children:nn(t.children,e)}))).filter((t=>function(t,{match:e,by:n,strict:s}){return en(n?t[n]||"":t.text||"",e,s)}(t,e)||t?.children?.length))}function sn(t){return We(function(t){const e={},n=[],s={};for(let n=0;n<t.length;n++)s[t[n].id]=n,e[t[n].id]=[],t[n].children=[];for(let o=0;o<t.length;o++){const i=t[o];i.parent&&e[i.parent]?(t[s[i.parent]].children.push(i),e[i.parent].push(i)):He(i.parent)||n.push(i)}return n}(t))}function on(t,e,n){if(t?.children?.length)for(let s=0;s<t.children.length;s++)on(t.children[s],e,n);t.counter={type:n?.counter?.type||"number",total:e[t.id].length,done:e[t.id].filter((t=>!0===t.checked)).length}}function rn(t,e){const n=[];for(let s=0;s<e.assigned.length;s++){const o=t[e.assigned[s]];o.type="user",o&&n.push(o)}return n}function an(t){const{menu:e,stateEditableItem:n,stateDueDate:s,stateCombo:o}=t.getState();e&&t.in.exec("close-menu",{...e}),n&&t.in.exec("close-inline-editor",{id:n.id,save:!0}),s?.open&&t.in.exec("set-state-due-date",{...s,open:!1}),o?.open&&t.in.exec("set-state-due-date",{...s,open:!1})}function cn(t,{id:e,project:n,parent:s,targetId:o,task:i={},reverse:r}){if(t.existsTask(e))return;const a=t.getState(),{activeProject:c,tasksMap:l}=a;i.id=e??i.id??Oe().toString(),void 0!==n?i.project=n:void 0===i.project&&He(c)&&(i.project=c),void 0!==s&&(i.parent=s),i.creation_date=new Date;let{tasks:d}=a;l[e]=i,d=[...d,i];const{treeTasks:u,childrenMap:p,filteredChildrenMap:f,usersMap:h,tags:m}=t.getInnerState(d,c);t.setState({tasks:d,treeTasks:u,childrenMap:p,filteredChildrenMap:f,usersMap:h,tags:m,tasksMap:l}),(He(o)||r)&&t.moveTask({id:i.id,parent:i.parent,project:i.project,targetId:o,reverse:r,silent:!0})}function ln(t,{id:e,task:n,skipStateCalc:s=!1}){t.updateTask({id:e,task:n,skipStateCalc:s})}function dn(t,{id:e,parent:n,targetId:s,reverse:o,project:i}){an(t),t.moveTask({id:e,parent:n,targetId:s,reverse:o,project:i})}function un(t,{id:e,targetId:n,parent:s,reverse:o,project:i,join:r=!1}){if(!t.existsTask(e))return;let a=[];if(r){const n=t.getState().copiedTasksId,s=t.getParentIds(e);if(n.some((t=>ze(t,e)||s.some((e=>ze(t,e))))))return;const o=t.getChildrenIds({id:e});for(let t=0;t<n.length;t++)o.some((e=>ze(e,n[t])))&&n.splice(t,1);a=[...n]}a.push(e),t.setState({copiedTasksId:a}),(t.existsTask(n)||t.existsTask(s)||Ye(s))&&t.pasteTask({targetId:n,parent:s,project:i,reverse:o})}function pn(t,{targetId:e,parent:n,project:s,reverse:o}){t.pasteTask({targetId:e,parent:n,project:s,reverse:o})}function fn(t,{id:e}){if(!t.existsTask(e))return;const n=t.getState();let{selected:s,tasks:o}=n;const i=n.tasksMap,r=[e,...t.getChildrenIds({id:e,tree:!0})];for(const t of r)s=s.filter((e=>!ze(e,t))),o=o.filter((e=>!ze(e.id,t))),delete i[t];const{treeTasks:a,childrenMap:c,filteredChildrenMap:l,usersMap:d,tags:u}=t.getInnerState(o,n.activeProject);t.setState({tasks:o,treeTasks:a,childrenMap:c,filteredChildrenMap:l,usersMap:d,tags:u,selected:s,tasksMap:i})}function hn(t,{id:e}){const n=t.getTask(e);n?.collapsed&&t.in.exec("update-task",{id:e,task:{...n,collapsed:!1},skipProvider:!0})}function mn(t,{id:e}){const n=t.getTask(e);n?.collapsed||t.in.exec("update-task",{id:e,task:{...n,collapsed:!0},skipProvider:!0})}function gn(t,{id:e,manual:n=!1,skipStateCalc:s=!1}){const o=t.getTask(e);if(o?.checked)return;const i=[],r=t.getState().taskShape?.completed?.behavior||"auto";if(!n&&"manual"!==r&&!s){t.hasChildren(e)&&t.getChildren({id:e,tree:!0}).forEach((e=>{e.checked||(t.in.exec("check-task",{id:e.id,skipStateCalc:!0}),i.push(t.getTask(e.id)))}));t.getParentIds(e).forEach((n=>{const s=t.getChildren({id:n}).every((n=>!!ze(n.id,e)||t.getTask(n.id).checked));if(s){t.getTask(n).checked||(t.in.exec("check-task",{id:n,skipStateCalc:!0}),i.push(t.getTask(n)))}}))}o.checked=!0,o.completion_date=new Date,t.in.exec("update-task",{id:e,task:o,skipStateCalc:s,skipProvider:s&&!n,batch:i})}function $n(t,{id:e,manual:n=!1,skipStateCalc:s=!1}){const o=t.getTask(e);if(!o?.checked)return;const i=[],r=t.getState().taskShape?.completed?.behavior||"auto";n||"manual"===r||s||(He(o.parent)&&t.getParentIds(e).forEach((e=>{t.getTask(e).checked&&(t.in.exec("uncheck-task",{id:e,skipStateCalc:!0}),i.push(t.getTask(e)))})),t.hasChildren(e)&&t.getChildren({id:e,tree:!0}).forEach((e=>{e.checked&&(t.in.exec("uncheck-task",{id:e.id,skipStateCalc:!0}),i.push(t.getTask(e.id)))}))),o.checked=!1,delete o.completion_date,t.in.exec("update-task",{id:e,task:o,skipStateCalc:s,skipProvider:s&&!n,batch:i})}function kn(t,{id:e,batchID:n}){const s=t.getTask(e),o=t.getTask(s?.parent),i=t.getState(),r=He(i.filter?.match),a=i?.taskShape?.completed?.taskHide,c=t.getChildren({id:o?.id,tree:!1,filtered:r,hideCompleted:a}),l=t.getTreeIndex(e,r,a);if(l>0){const s=t.getTask(c[l-1]?.id);t.in.exec("move-task",{id:e,parent:s?.id,targetId:s?.id,operation:"indent",batchID:n}),s.collapsed&&t.in.exec("expand-task",{id:s?.id})}}function vn(t,{id:e,batchID:n}){const s=t.getTask(e),o=t.getTask(s?.parent);He(o?.id)&&t.in.exec("move-task",{id:e,parent:o.parent??null,targetId:o.id,operation:"unindent",batchID:n})}function xn(t){const{taskShape:e}=t.getState();e.completed.taskHide=!1,t.setState({taskShape:e})}function yn(t){const{taskShape:e}=t.getState();e.completed.taskHide=!0,t.setState({taskShape:e})}function wn(t,{id:e,join:n=!1}){let{selected:s}=t.getState();if(!(!t.existsTask(e)||n&&s.some((t=>ze(t,e))))){if(n)s.push(e);else{for(const n of s)ze(n,e)||t.in.exec("unselect-task",{id:n});s=[e]}t.updateTask({id:e,task:{selected:!0}}),t.setState({selected:s})}}function bn(t,{id:e}){let{selected:n}=t.getState();if(n.length&&(!He(e)||n.some((t=>ze(t,e))))){if(He(e))t.updateTask({id:e,task:{selected:!1}});else{for(const e of n)t.in.exec("unselect-task",{id:e});n=[]}n=n.filter((t=>!ze(t,e))),an(t),t.setState({selected:n})}}function _n(t,{id:e,project:n}){if(t.existsProject(e))return;n={id:e??Pe().toString(),label:"New project",...n};const s=[...t.getState().projects,n];t.setState({projects:s})}function Sn(t,{id:e,project:n}){if(!t.existsProject(e))return;const s=t.getState().projects.map((t=>ze(e,t.id)?{...t,...n,id:t.id}:t));t.setState({projects:s})}function Tn(t,{id:e}){if(!t.existsProject(e)&&!Ye(e)||void 0===e)return;an(t);const{treeTasks:n,childrenMap:s,filteredChildrenMap:o}=t.getInnerState(t.getState().tasks,e);t.setState({activeProject:e,treeTasks:n,childrenMap:s,filteredChildrenMap:o})}function jn(t,{id:e}){if(!t.existsProject(e))return;const n=t.getState(),s=n.projects.filter((t=>!ze(t.id,e)));n.tasks.forEach((n=>(ze(n.project,e)&&t.in.exec("update-task",{id:n.id,task:{...n,project:null},skipProvider:!0,skipStateCalc:!0}),n)));const o=n.tasks,{treeTasks:i,childrenMap:r,filteredChildrenMap:a}=t.getInnerState(o,n.activeProject);t.setState({projects:s,treeTasks:i,tasks:o,childrenMap:r,filteredChildrenMap:a}),ze(n.activeProject,e)&&(s.length?t.in.exec("set-project",{id:s[0].id}):t.in.exec("set-project",{id:null}))}let Cn={monthFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]};const In={"%d":t=>{const e=t.getDate();return e<10?"0"+e:e},"%j":t=>t.getDate(),"%l":t=>Cn.dayFull[t.getDay()],"%D":t=>Cn.dayShort[t.getDay()],"%m":t=>{const e=t.getMonth()+1;return e<10?"0"+e:e},"%n":t=>t.getMonth()+1,"%M":t=>Cn.monthShort[t.getMonth()],"%F":t=>Cn.monthFull[t.getMonth()],"%y":t=>t.getFullYear().toString().slice(2),"%Y":t=>t.getFullYear()},Mn={"%d":(t,e)=>{/(^([0-9][0-9])$)/i.test(e)?t.setDate(Number(e)):t.setDate(Number(1))},"%j":(t,e)=>{/(^([0-9]?[0-9])$)/i.test(e)?t.setDate(Number(e)):t.setDate(Number(1))},"%m":(t,e)=>{const n=/(^([0-9][0-9])$)/i.test(e);n?t.setMonth(Number(e)-1):t.setMonth(Number(0)),n&&t.getMonth()!==Number(e)-1&&t.setMonth(Number(e)-1)},"%n":(t,e)=>{const n=/(^([0-9]?[0-9])$)/i.test(e);n?t.setMonth(Number(e)-1):t.setMonth(Number(0)),n&&t.getMonth()!==Number(e)-1&&t.setMonth(Number(e)-1)},"%M":(t,e)=>{const n=qe(Cn.monthShort,(t=>t===e));-1===n?t.setMonth(0):t.setMonth(n),-1!==n&&t.getMonth()!==n&&t.setMonth(n)},"%F":(t,e)=>{const n=qe(Cn.monthFull,(t=>t===e));-1===n?t.setMonth(0):t.setMonth(n),-1!==n&&t.getMonth()!==n&&t.setMonth(n)},"%y":(t,e)=>{/(^([0-9][0-9])$)/i.test(e)?t.setFullYear(Number("20"+e)):t.setFullYear(Number("2000"))},"%Y":(t,e)=>{/(^([0-9][0-9][0-9][0-9])$)/i.test(e)?t.setFullYear(Number(e)):t.setFullYear(Number("2000"))}};var Dn;function Pn(t){const e=[];let n="";for(let s=0;s<t.length;s++)"%"===t[s]?(n.length>0&&(e.push({type:Dn.separator,value:n}),n=""),e.push({type:Dn.datePart,value:t[s]+t[s+1]}),s++):n+=t[s];return n.length>0&&e.push({type:Dn.separator,value:n}),e}function En(t,e,n){return n&&(Cn=n),Pn(e).reduce(((e,n)=>n.type===Dn.separator?e+n.value:In[n.value]?e+In[n.value](t):e),"")}function Nn(t,e,n=!1,s){if("string"!=typeof t)return;s&&(Cn=s);const o=Pn(e),i=[];let r,a=0,c=null;for(const e of o)if(e.type===Dn.separator){const s=t.indexOf(e.value,a);if(-1===s){if(n)return!1;if(An(t))return new Date(t);throw new Error("Incorrect Date or date format")}c&&(i.push({formatter:c,value:t.slice(a,s)}),c=null),a=s+e.value.length}else e.type===Dn.datePart&&(c=e.value);"%A"===c||"%a"===c?i.unshift({formatter:c,value:t.slice(a)}):c&&i.push({formatter:c,value:t.slice(a)}),i.reverse();for(const t of i)"%A"!==t.formatter&&"%a"!==t.formatter||(r=t.value);const l=new Date(0);for(const t of i)Mn[t.formatter]&&Mn[t.formatter](l,t.value,r);return l}function An(t){if("string"==typeof t){return new RegExp("^(-?(?:[1-9][0-9]*)?[0-9]{4})-(1[0-2]|0[1-9])-(3[01]|0[1-9]|[12][0-9])T(2[0-3]|[01][0-9]):([0-5][0-9]):([0-5][0-9])(.[0-9]+)?(Z)?$").test(t)}return t instanceof Date}function Fn({store:t,type:e,id:n,source:s}){switch(e){case"task":return function(t,e=[]){const{filter:n,projects:s,users:o,taskShape:i,priorities:r}=t.getState(),a=e.at(0),c=i?.date?.format,l=[];let d=t.getTask(a)?.due_date;"string"==typeof d&&(d=Nn(d,c));He(n)||1!==e.length||l.push({type:"item",icon:"plus",label:"Add task below",/*hotkey:"Enter",*/id:"addBellow"},{type:"item",icon:"subtask",label:"Add subtask",id:"addSubtask"},{type:"separator"});l.push(/*{type:"item",icon:"indent",label:"Indent",hotkey:"Tab",id:"indent"},{type:"item",icon:"unindent",label:"Unindent",hotkey:"Shift+Tab",id:"unindent"},{type:"item",icon:"calendar",label:"Set due date",id:"setDate",data:[{type:"datepicker",id:"dueDate",value:1===e.length&&d?d:null,store:t}]}*/),Array.isArray(r)&&r.length&&l.push({type:"item",icon:"alert",label:"Set priority",data:On(t,a,r),id:"setPriority"});1===e.length&&o?.length&&l.push({type:"item",icon:"assign",label:"Assign to",data:Ln(t,a,"assign"),id:"assign"});s?.length&&l.push({type:"item",icon:"content-paste",label:"Move to",data:Rn(t,"moveProject"),id:"moveProject"});return[...l,/*{type:"item",icon:"duplicate",label:"Duplicate",hotkey:Je()?"CMD+D":"Ctrl+D",id:"duplicate"},{type:"item",icon:"content-copy",label:"Copy",hotkey:Je()?"CMD+C":"Ctrl+C",id:"copy"},{type:"item",icon:"paste",label:"Paste",hotkey:Je()?"CMD+V":"Ctrl+V",id:"paste"},{type:"separator"},{type:"item",icon:"delete",label:"Delete",hotkey:"Delete",id:"delete"}*/]}(t,s);case"toolbar":return function(t,e){const{taskShape:n,readonly:s}=t.getState(),o=n?.completed?.taskHide||!1,i=[{id:"sort",type:"item",label:"Sort by",icon:"sort",data:[{id:"sort:text-asc",type:"item",label:"Text (a-z)",icon:"asc"},{id:"sort:text-desc",type:"item",label:"Text (z-a)",icon:"desc"},{type:"separator"},{id:"sort:priority-asc",type:"item",label:"Priority (high to low)",icon:"asc"},{id:"sort:priority-desc",type:"item",label:"Priority (low to high)",icon:"desc"},{type:"separator"},{id:"sort:due-date-desc",type:"item",label:"Due date (new to old)",icon:"asc"},{id:"sort:due-date-asc",type:"item",label:"Due date (old to new)",icon:"desc"},{type:"separator"},{id:"sort:completion-date-desc",type:"item",label:"Completion date (new to old)",icon:"asc"},{id:"sort:completion-date-asc",type:"item",label:"Completion date (old to new)",icon:"desc"},{type:"separator"},{id:"sort:created-date-desc",type:"item",label:"Created (new to old)",icon:"asc"},{id:"sort:created-date-asc",type:"item",label:"Created (old to new)",icon:"desc"},{type:"separator"},{id:"sort:edited-date-desc",type:"item",label:"Edited (new to old)",icon:"asc"},{id:"sort:edited-date-asc",type:"item",label:"Edited (old to new)",icon:"desc"}]},{id:"completed",icon:"check",label:"Completed tasks",type:"item",data:[{id:"completed:show",label:"Show",type:"item",icon:o?"empty":"check"},{id:"completed:hide",label:"Hide",type:"item",icon:o?"check":"empty"}]}];s||(i.push({type:"separator"},{id:"add",icon:"plus",label:"Add project",type:"item"}),He(e)&&i.push({id:"rename",icon:"edit",label:"Rename project",type:"item"},{id:"delete",icon:"delete",label:"Delete project",type:"item"}));return i}(t,n)}}function Ln(t,e,n){const s=Ge(t.getState().users),o=t.getTask(e),i=[];if(s.length)for(let t=0;t<s.length;t++){const e=s[t],r=o?.assigned?.some((t=>ze(t,e.id)));i.push({...e,id:n+":"+e.id,color:e.color||Ue[t%Ue.length],icon:r?"check":"empty",type:"user",clicable:!0,checked:r})}return i}function Rn(t,e){const n=t.getState().activeProject;let s=Ge(t.getState().projects);s.every((t=>He(t.id)))&&(s=[{id:null,label:"No project"},...s]);const o=[];if(s.length)for(let t=0;t<s.length;t++){const i=s[t],r=ze(i.id,n);o.push({...i,id:e+":"+i.id,type:"item",icon:r?"check":"empty",checked:r})}return o}function On(t,e,n){const s=t.getTask(e),o=[];for(let t=0;t<n.length;t++){const e=n[t];o.push({...e,id:"priority:"+e.id,type:"priority",hotkey:e.hotkey,color:e.color||Ve[t%Ve.length],icon:ze(s?.priority,e.id)?"check":"empty"})}return[...o,{type:"separator"},{type:"item",icon:"refresh",label:"Reset priority",/*hotkey:"Alt+0",*/id:"priority:reset"}]}function zn(t,{id:e,type:n,source:s}){He(n)&&t.setState({menu:{id:e,type:n,source:s,options:Fn({store:t,type:n,id:e,source:s})}})}function Hn(t){t.setState({menu:null})}function Yn({store:t,id:e}){const n=He(t.getState()?.filter),s=t.getState()?.taskShape?.completed?.taskHide,o=t.getTask(e),i=t.getChildrenIds({id:o?.parent,tree:!0,filtered:n,hideCompleted:s});let r=null;return r=(!He(o?.parent)||1!==i.length&&i.at(-1)!==o.id)&&t.getNearId({id:o.id,flat:!0,filtered:n,hideCompleted:s})||t.getNearId({id:o.id,dir:"prev",flat:!0,filtered:n,hideCompleted:s}),r}function qn(t,e,n,s,o){ze(e,t.getTask(n)?.project)||void 0===e||(t.in.exec("select-task",{id:Yn({store:t,id:n})}),t.in.exec("move-task",{id:n,project:e,parent:null,operation:"project",skipProvider:o,batch:s}))}function Bn({store:t,task:e,reverse:n=!1}){const s=Oe().toString();t.in.exec("add-task",{id:s,targetId:e?.id,parent:e?.parent,project:t.getState()?.activeProject,reverse:n}),t.in.exec("select-task",{id:s}),t.in.exec("open-inline-editor",{id:s,type:"task"})}function Jn({store:t}){const e=t.getState().selected;if(!e.length)return;let n=Yn({store:t,id:e.at(-1)});t.getTask(n)?.selected&&(n=Yn({store:t,id:e.at(0)})),t.eachSelected((e=>{t.existsTask(e)&&t.in.exec("delete-task",{id:e})}),!0),t.in.exec("select-task",{id:n})}function Gn({store:t,id:e}){const n=t.getState().copiedTasksId;e=e||n.at(-1),t.in.exec("paste-task",{targetId:e,parent:t.getTask(e)?.parent??null})}function Wn({store:t}){const{selected:e}=t.getState();t.eachSelected(((n,s)=>{t.in.exec("copy-task",{id:n,join:!!s}),e.length-1===s&&Gn({store:t})}),!0)}function Un({store:t}){t.eachSelected(((e,n)=>{t.in.exec("copy-task",{id:e,join:!!n})}),!0)}function Vn({store:t}){const e=Oe();t.eachSelected((n=>{t.getTask(t.getTask(n).parent)?.selected||t.in.exec("indent-task",{id:n,batchID:e})}),!0)}function Kn({store:t}){const e=Oe();t.eachSelected((n=>{t.getTask(t.getTask(n).parent)?.selected||t.in.exec("unindent-task",{id:n,batchID:e})}),!0)}function Qn({store:t,priority:e}){t.getState().selected.length&&(e="null"===e||"0"==e?null:+e,t.eachSelected((n=>{const s=t.getTask(n);t.in.exec("update-task",{id:n,task:{...s,priority:e}})})))}function Xn(t,e,n){const{menu:s}=t.getState(),o=n?.split(":"),i=o?.at(0);if(i){const n=t.getTask(e);let r=o.at(1);switch(i){case"addBellow":Bn({store:t,task:n});break;case"addSubtask":Bn({store:t,task:{...n,parent:e,targetId:e}}),n?.collapsed&&t.hasChildren(e)&&t.in.exec("expand-task",{id:e});break;case"duplicate":Wn({store:t});break;case"delete":Jn({store:t});break;case"indent":Vn({store:t});break;case"unindent":Kn({store:t});break;case"copy":Un({store:t});break;case"paste":Gn({store:t,id:e});break;case"priority":Qn({store:t,priority:r});break;case"assign":n?.assigned?.some((t=>ze(t,r)))?t.in.exec("unassign-user",{id:e,userId:r}):t.in.exec("assign-user",{id:e,userId:r}),t.setState({menu:{...t.getState().menu,options:Fn({store:t,type:"task",source:s.source})}});break;case"moveProject":"null"===r&&(r=null),function({store:t,id:e}){const n=t.getSelection({sorted:!0}),s=n.filter((e=>{const s=t.getTask(e);return!n.some((e=>ze(t.getTask(e).id,s.parent)))}));for(let o=0;o<n.length;o++){const i=n[o];qn(t,e,i,s,!!o)}}({store:t,id:r})}}"assign"!==i&&t.in.exec("close-menu",{...s})}function Zn(t){const e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};return t.replace(/[&<>"]/g,(t=>e[t]))}function ts(t,e){if(!t)return"";let n=Zn(t);return e?.highlight?n=function(t,e){const n=e?.strict?Ze(e.match):new RegExp(e.match,"gi"),s=e?.strict?"wx-todo_filter--strict":"wx-todo_filter";return t.replace(n,(t=>`<mark class="${s}">${t}</mark>`))}(n,e):(n=function(t){return t.replace(tn("#"),(t=>`<span class="wx-todo_tag" data-tag="${t}">${t}</span>`))}(n),n=function(t){const e=new RegExp(/!\((.+?)\)/gm);return t.replace(e,(t=>{const e=t.substring(2,t.length-1);return`<span class="wx-todo_date" data-date="${e}">${e}</span>`}))}(n)),n}function es(t,e,n){const s=e.filter((e=>e.label.includes(n(t))));if(!s.length)return n(t);const o=new RegExp(/\d+(?=\))/gm);let i=0;for(const{label:t}of s){const e=t.match(o);e&&+e[0]>i&&(i=+e[0])}return`${n(t)} (${i+1})`}function ns(t,{action:e,id:n,locate:s}){const{projects:o,menu:i}=t.getState();if(e){const i=e.split(":"),r=i.at(0),a=i.at(1);switch(r){case"sort":!function(t,e){switch(e){case"text-asc":t.in.exec("set-sort",{by:"text",dir:"asc",tree:!0});break;case"text-desc":t.in.exec("set-sort",{by:"text",dir:"desc",tree:!0});break;case"due-date-asc":t.in.exec("set-sort",{by:"due_date",dir:"asc",tree:!0});break;case"due-date-desc":t.in.exec("set-sort",{by:"due_date",dir:"desc",tree:!0});break;case"completion-date-asc":t.in.exec("set-sort",{by:"completion_date",dir:"asc",tree:!0});break;case"completion-date-desc":t.in.exec("set-sort",{by:"completion_date",dir:"desc",tree:!0});break;case"created-date-asc":t.in.exec("set-sort",{by:"creation_date",dir:"asc",tree:!0});break;case"created-date-desc":t.in.exec("set-sort",{by:"creation_date",dir:"desc",tree:!0});break;case"edited-date-asc":t.in.exec("set-sort",{by:"edited_date",dir:"asc",tree:!0});break;case"edited-date-desc":t.in.exec("set-sort",{by:"edited_date",dir:"desc",tree:!0});break;case"priority-asc":t.in.exec("set-sort",{by:"priority",dir:"asc",tree:!0});break;case"priority-desc":t.in.exec("set-sort",{by:"priority",dir:"desc",tree:!0})}}(t,a);break;case"completed":!function(t,e){switch(e){case"show":t.in.exec("show-completed-tasks",{});break;case"hide":t.in.exec("hide-completed-tasks",{})}}(t,a);break;case"add":!function(t,e){const n=e?.id||Oe().toString();t.in.exec("add-project",{id:n,project:{label:e?.label||"New project"}}),t.in.exec("set-project",{id:n}),t.in.exec("open-inline-editor",{id:n,type:"project"})}(t,{id:"temp://"+Pe(),label:es("New project",o,s)});break;case"rename":t.in.exec("open-inline-editor",{id:n,type:"project"});break;case"delete":t.in.exec("delete-project",{id:n})}}t.in.exec("close-menu",{...i})}function ss(t,{id:e,action:n,type:s,params:o}){switch(s){case"task":return void Xn(t,e,n);case"toolbar":return void ns(t,{id:e,action:n,locate:o.locate})}}function os(t,{id:e,userId:n}){if(!t.getState().usersMap[n?.toString()])return;const s=t.getTask(e);s?.assigned?.some((t=>ze(t,n)))||t.in.exec("update-task",{id:e,task:{...s,assigned:s?.assigned?.length?[...s.assigned,n]:[n]}})}function is(t,{id:e,userId:n}){const s=t.getTask(e);s?.assigned?.some((t=>ze(t,n)))&&t.in.exec("update-task",{id:e,task:{...s,assigned:s?.assigned?.filter((t=>t!=n))}})}function rs(t,{id:e,type:n="task",targetDate:s}){const{stateDueDate:o}=t.getState();if(o?.open||!He(e)||!t.existsTask(e)&&"task"===n||!t.existsProject(e)&&"project"===n)return;let i=null;"task"===n?i=t.getTask(e)?.text:"project"===n&&(i=t.getProject(e)?.label),t.setState({stateEditableItem:{id:e,type:n,initValue:i,currentValue:i,targetDate:s}})}function as(t,{save:e=!0}){const{stateEditableItem:n}=t.getState();if(!He(n?.id))return;const s=n.id,o=n.currentValue;if(e){if("task"===n.type){const e=t.getTask(s);o!==e.text&&(e.text=o,e.edited_date=new Date,t.in.exec("update-task",{id:s,task:e}))}if("project"===n.type){const e=t.getProject(s);o!==e.label&&(e.label=o,t.in.exec("update-project",{id:s,project:e}))}}t.setState({stateEditableItem:null})}function cs(t,{currentValue:e,dropdown:n,targetDate:s}){const{stateEditableItem:o}=t.getState();t.setState({stateEditableItem:{...o,currentValue:e,dropdown:n,targetDate:s}})}function ls(t,e="data-id"){let n=t;if(t?.changedTouches){const{clientX:e,clientY:s}=t.changedTouches[0];n=document.elementFromPoint(e,s)}else!t.tagName&&t.target&&(n=t.target);for(;n;){if(n.getAttribute){if(n.getAttribute(e))return n}n=n.parentNode}return null}function ds(t,e="data-id"){const n=ls(t,e);return n?function(t,e="data-id"){const n=t.getAttribute(e),s=parseInt(n);return isNaN(s)||s.toString()!=n?n:s}(n,e):null}function us(t,e){if(t){if(t?.childNodes[0]){const n=document.createRange(),s=window.getSelection();let o=t?.childNodes[t?.childNodes.length-1];const i=o?.textContent?.length;let r=i;if("number"==typeof e){const n=t.childNodes;for(let t=0;t<n.length;t++){const s=n[t],i=s.textContent.length;if(i>=e){r=e,o=s;break}e-=i}}n.setStart(o,r),n.collapse(!0),s.removeAllRanges(),s.addRange(n)}setTimeout((()=>t.focus()))}}function ps({store:t,id:e}){const n=t.getTask(e);if(!n||n.checked)return;const{taskShape:s}=t.getState();if(s?.completed?.taskHide){let n=null;const s=t.getParentIds(e),o=s[s.length-1],i=t.getChildren({filtered:!0,hideCompleted:!0}),r=i.findIndex((t=>ze(t.id,o)));if(n=Yn({store:t,id:e}),t.in.exec("check-task",{id:e}),t.getTask(o)?.checked){const t=i[r+1]?.id,e=i[r-1]?.id;n=He(t)?t:e}else t.getTask(n)?.checked&&(n=Yn({store:t,id:n}));He(n)&&t.in.exec("select-task",{id:n})}else t.in.exec("check-task",{id:e})}function fs({store:t}){t.eachSelected((e=>{!t.getTask(t.getTask(e).parent)?.selected&&function(t,e){const{treeTasks:n,filter:s,taskShape:o}=t.getState(),i=o?.completed?.taskHide,r=He(s?.match),a=t.getNearId({id:e,dir:"next",flat:!0,filtered:r,hideCompleted:i}),c=t.getTask(a),l=t.getTask(e);if(ze(n.at(-1).id,e)||!ze(c?.parent,l?.parent))return;t.in.exec("move-task",{id:e,parent:l?.parent,targetId:a})}(t,e)}),!0,!0)}function hs({store:t}){t.eachSelected((e=>{!t.getTask(t.getTask(e).parent)?.selected&&function(t,e){const{treeTasks:n,filter:s,taskShape:o}=t.getState(),i=o?.completed?.taskHide,r=He(s?.match),a=t.getNearId({id:e,dir:"prev",flat:!0,filtered:r,hideCompleted:i}),c=t.getTask(a),l=t.getTask(e);if(ze(n[0].id,e)||!ze(c?.parent,l?.parent))return;t.in.exec("move-task",{id:e,targetId:a,parent:l?.parent,reverse:!0})}(t,e)}),!0)}function ms(t,{code:e,event:n}){const{selected:s,stateEditableItem:o,filter:i,stateSearch:r,menu:a,stateDueDate:c,stateCombo:l}=t.getState(),d=He(o?.id);if(!He(s.at(-1))||r?.focus||l?.open||function(t,e,n){const{selected:s,stateEditableItem:o,readonly:i,filter:r}=t.getState(),a=He(o?.id),c=s.at(-1),l=t.getTask(c);if(o?.dropdown)return;if(!i)switch(e){case"shift+arrowup":$s(t,"prev");break;case"shift+arrowdown":$s(t,"next");break;case"shift+tab":n.preventDefault(),Kn({store:t});break;case"tab":n.preventDefault(),Vn({store:t});break;case"delete":case"backspace":a||Jn({store:t});break;case"enter":n.preventDefault(),a?!o?.currentValue&&He(l.parent)?(t.in.exec("unindent-task",{id:o.id}),t.in.exec("open-inline-editor",{id:o.id,type:"task"})):t.in.exec("close-inline-editor",{id:o.id}):He(r?.match)||Bn({store:t,task:l});break;case"ctrl+enter":!a&&t.in.exec("open-inline-editor",{id:c,type:"task"});break;case"ctrl+d":n.preventDefault(),Wn({store:t});break;case"ctrl+c":!window.getSelection().toString()?.length&&Un({store:t});break;case"ctrl+v":!a&&Gn({store:t,id:c});break;case"ctrl+arrowup":hs({store:t});break;case"ctrl+arrowdown":fs({store:t});break;case"alt+0":Qn({store:t,priority:null});break;case"alt+1":Qn({store:t,priority:1});break;case"alt+2":Qn({store:t,priority:2});break;case"alt+3":Qn({store:t,priority:3})}switch(e){case"arrowup":gs(t,"up");break;case"arrowdown":gs(t,"down");break;case"arrowleft":gs(t,"left");break;case"arrowright":gs(t,"right");break;case"space":a||(n.preventDefault(),l?.checked?function({store:t}){t.eachSelected((e=>{t.getTask(e)?.checked&&t.in.exec("uncheck-task",{id:e})}),!0)}({store:t}):function({store:t}){t.eachSelected((e=>{ps({store:t,id:e})}),!0)}({store:t}))}}(t,e,n),"escape"===e)a?t.in.exec("close-menu",{...a}):d?t.in.exec("close-inline-editor",{...o,save:!1}):c?.open||l?.open?(t.in.exec("set-state-due-date",{...c,open:!1}),t.in.exec("set-state-combo",{open:!1})):(i&&t.in.exec("set-filter",{match:null}),r?.open&&t.in.exec("set-state-search",{...r,value:null,open:!1,dropdown:{open:!1}}))}function gs(t,e){const{selected:n,treeTasks:s,stateEditableItem:o,filter:i,taskShape:r}=t.getState(),a=n.at(-1);if(He(o?.id))return;if(!He(a))return void t.in.exec("select-task",{id:s.at(0)?.id});const c=r?.completed?.taskHide,l=t.getTask(a),d=He(i);let u;switch(e){case"up":u=t.getNearId({id:a,dir:"prev",filtered:d,hideCompleted:c});break;case"down":u=t.getNearId({id:a,filtered:d,hideCompleted:c});break;case"left":t.hasChildren(l.id,d,c)&&!l.collapsed?t.in.exec("collapse-task",{id:l.id}):u=l?.parent;break;case"right":t.hasChildren(l.id,d,c)&&l.collapsed&&t.in.exec("expand-task",{id:l.id})}He(u)&&t.in.exec("select-task",{id:u})}function $s(t,e="next"){const{selected:n,filter:s,taskShape:o}=t.getState(),i=o?.completed?.taskHide,r=He(s),a=n.at(-1),c=t.getNearId({id:a,dir:e,filtered:r,hideCompleted:i});if(He(c))if(n.length>1&&t.getTask(c)?.selected)t.in.exec("unselect-task",{id:a});else if(t.in.exec("select-task",{id:c,join:!0}),"next"===e){const e=t.getChildrenIds({id:c});for(const n of e)t.getTask(n)?.selected||t.in.exec("select-task",{id:n,join:!0})}}function ks(t,e){const n="string"==typeof e?.match?e.match.trim():null;let s={match:n,by:"string"==typeof e?.by?e.by.trim():null,...e};e&&n?.length||(s=null),t.setState({filter:s})}function vs(t,e){if(!e)return;const n={by:e.by||"text",dir:e.dir||"asc",...e},{tasks:s,activeProject:o}=t.getState(),{treeTasks:i}=t.getInnerState(s,o,n);t.setState({treeTasks:i})}function xs(t,{value:e,open:n,dropdown:s,focus:o}){const i=t.getState().stateSearch;t.setState({stateSearch:{value:e,open:He(n)?n:i?.open,dropdown:He(s)?s:i?.dropdown,focus:He(o)?o:i?.focus}})}function ys(t,e){t.setState({stateDueDate:e})}function ws(t,e){t.setState({stateCombo:e})}function bs(t,{start:e,mode:n}){if(!t.existsTask(e))return;const s=[];t.getTask(e).selected||t.in.exec("select-task",{id:e}),t.eachSelected((e=>{s.push(e);const n=t.getChildrenIds({id:e});for(const e of n){t.getTask(e)?.selected||s.push(e)}}),!0);for(let e=0;e<s.length;e++)t.updateTask({id:s[e],task:{draggable:!0},skipStateCalc:e!==s.length-1});t.setState({draggableIds:s,dragInfo:{mode:n}})}function _s(t,{target:e,dropPosition:n,mode:s}){if(t.existsTask(e)){const o=t.getTask(e),i="move"===s?"move-task":"copy-task";if(!o.draggable&&"move"===s||"copy"===s){const s="bottom"===n,r=t.getSelection({sorted:!0}),a=r.filter((e=>{const n=t.getTask(e);return!r.some((e=>ze(t.getTask(e).id,n.parent)))}));t.eachSelected(((s,r)=>{!t.getTask(t.getTask(s).parent)?.selected&&t.in.exec(i,{id:s,parent:"in"===n?e:o.parent,targetId:e,reverse:"top"===n,skipProvider:!!r,batch:!r&&a.length>1?a:null})}),!0,s)}}const{draggableIds:o}=t.getState();for(let e=0;e<o.length;e++)t.updateTask({id:o[e],task:{draggable:!1},skipStateCalc:e!==o.length-1});t.setState({draggableIds:[],dragInfo:null})}function Ss(t,{start:e,target:n,dropPosition:s}){const o=t.getState().drag?.expand;o&&t.getTask(n)?.collapsed&&t.in.exec("expand-task",{id:n});const i=t.getState().dragInfo;t.setState({dragInfo:{...i,start:e,target:n,dropPosition:s}})}function Ts(t,e){return`${"function"==typeof e?e(t):t[e]}`}function js(t,e){if(e.tree)for(const n of t)n.children?.length&&js(n.children,e);t.sort(function({dir:t,by:e}){return(n,s)=>{const o=Ts(n,e),i=Ts(s,e);return"undefined"===o||"null"===o?1:"undefined"===i||"null"==i?-1:"desc"===t?i.localeCompare(o,void 0,{numeric:!0}):o.localeCompare(i,void 0,{numeric:!0})}}(e))}!function(t){t[t.separator=0]="separator",t[t.datePart=1]="datePart"}(Dn||(Dn={}));class Cs extends class{constructor(t){this._writable=t,this._values={},this._state={}}setState(t){const e=this._state;for(const n in t)e[n]?e[n].set(t[n]):this._state[n]=this._wrapWritable(n,t[n])}getState(){return this._values}getReactive(){return this._state}_wrapWritable(t,e){const n=this._writable(e);return n.subscribe((e=>{this._values[t]=e})),n}}{constructor(t){super(t),setTimeout((()=>{})),this.in=new Ae,this.out=new Ae,this.in.setNext(this.out.exec),this._router=new Ee(super.setState.bind(this),[],{});const e={"add-task":cn,"update-task":ln,"move-task":dn,"copy-task":un,"paste-task":pn,"delete-task":fn,"expand-task":hn,"collapse-task":mn,"check-task":gn,"uncheck-task":$n,"indent-task":kn,"unindent-task":vn,"add-project":_n,"update-project":Sn,"set-project":Tn,"delete-project":jn,"show-completed-tasks":xn,"hide-completed-tasks":yn,"select-task":wn,"unselect-task":bn,"open-menu":zn,"close-menu":Hn,"click-menu-item":ss,"assign-user":os,"unassign-user":is,"open-inline-editor":rs,"close-inline-editor":as,"edit-item":cs,"keypress-on-todo":ms,"set-filter":ks,"set-sort":vs,"set-state-search":xs,"set-state-due-date":ys,"set-state-combo":ws,"start-drag":bs,"end-drag":_s,drag:Ss};this.in.on("set-filter",(()=>{const{tasks:t,activeProject:e,filter:n}=this.getState(),{treeTasks:s,childrenMap:o,filteredChildrenMap:i,tags:r}=this.getInnerState(t,e);n?.match&&an(this),this.setState({treeTasks:s,childrenMap:o,filteredChildrenMap:i,tags:r})})),this._setHandlers(e)}init(t){this._router.init({id:null,selected:[],projects:[],tasks:[],users:[],tags:[],readonly:!1,taskShape:Ke,drag:Qe,priorities:Xe,treeTasks:[],copiedTasksId:[],defaultTags:[],tasksMap:null,usersMap:null,childrenMap:null,priorityMap:null,filteredChildrenMap:null,stateEditableItem:null,stateSearch:null,stateDueDate:null,stateCombo:null,draggableIds:[],dragInfo:null,filter:null,menu:null,...t});const{tasks:e,users:n,projects:s,tags:o,priorities:i}=this.getState();this.parse({tasks:e,users:n,projects:s,activeProject:t?.activeProject,tags:o}),function(t,e){const n={};for(let t=0;t<e.length;t++){const s=e[t];n[s.id]={...s,color:s.color||Ve[t%Ve.length]}}t.setState({priorityMap:n})}(this,i)}setState(t,e){this._router.setState(t,e)}getSelection({sorted:t=!1}={}){let e=this.getState().selected;if(t){const t=this.getState().tasks,n={};for(const s of e)n[t.findIndex((t=>ze(t.id,s)))]=s;e=Object.values(n)}return e}eachSelected(t,e=!1,n=!1){const s=this.getSelection({sorted:e});if(n){let e=0;for(let n=s.length-1;n>=0;n--)t(s[n],e++)}else for(let e=0;e<s.length;e++)t(s[e],e)}serialize(){const{tasks:t,projects:e,users:n,tags:s,activeProject:o}=this.getState();for(const e of t)delete e.selected,delete e.draggable;return{tasks:[...t],projects:[...e],users:[...n],tags:[...s],activeProject:o}}parse(t){if(!function(t){return null!==t&&"object"==typeof t&&!(t instanceof Date)}(t))return;const e=this.getState();if(t?.tasks&&(t.tasks=function(t,e){const n=new Date;return sn(t).map((t=>{const s=t.id??Pe().toString();return delete t.selected,delete t.draggable,t.checked&&!t.completion_date&&(t.completion_date=n),t.creation_date||(t.creation_date=n),e.some((t=>ze(t,s)))&&(t.selected=!0),{...t,id:s}}))}(t.tasks,e.selected)),t?.tags){const e=(t.tags||[]).map((t=>t.startsWith("#")?t:`#${t}`));this.setState({defaultTags:[...new Set(e)]})}const n=t?.tasks||e?.tasks||[],s=t?.projects||e?.projects||[],o=t?.users||e?.users||[];let i=e?.activeProject;void 0!==t?.activeProject&&s.find((e=>ze(e?.id,t?.activeProject)))||Ye(t?.activeProject)?i=t.activeProject:s.find((t=>ze(t?.id,e?.activeProject)))||(i=s[0]?.id||null);const{treeTasks:r,childrenMap:a,filteredChildrenMap:c,usersMap:l,tags:d}=this.getInnerState(n,i);this.setState({treeTasks:r,childrenMap:a,filteredChildrenMap:c,usersMap:l,tags:d,tasks:n,projects:s,users:o,activeProject:i}),this._setTasksMap(n)}existsTask(t){return t in this.getState().tasksMap}existsProject(t){return He(this.getState().projects.find((e=>ze(e.id,t)))?.id)}updateTask({id:t,task:e,skipStateCalc:n=!1}){if(!this.existsTask(t))return;const s=this.getState(),o=s.tasksMap,i=s.tasks.map((n=>{if(ze(t,n.id)){const t={...n,...e,id:n.id};return o[n.id]=t,t}return n}));if(n)return void this.setState({tasks:i,tasksMap:o});const{treeTasks:r,childrenMap:a,filteredChildrenMap:c,usersMap:l,tags:d}=this.getInnerState(i,s.activeProject);this.setState({tasks:i,treeTasks:r,childrenMap:a,filteredChildrenMap:c,usersMap:l,tags:d,tasksMap:o})}moveTask({id:t,project:e,parent:n,targetId:s,reverse:o,silent:i=!1}){if(!this.existsTask(t)||ze(t,n)||ze(t,s))return;const r=this.getState(),a=this.getTask(t),c=this.existsTask(n),l=this.existsTask(s);a.parent=n??null,Ye(e)||this.existsProject(e)?a.project=e:a.project=l?this.getTask(s).project:c?this.getTask(n).project:r?.activeProject,i?this.updateTask({id:t,task:a}):this.in.exec("update-task",{id:t,task:a,skipProvider:!0,skipStateCalc:!0});const d=this.getChildrenIds({id:t,tree:!0}),u=d.length;if(void 0!==e&&this.hasChildren(t))for(let t=0;t<u;t++){const e=this.getTask(d[t]);"project"in e&&(i?this.updateTask({id:e.id,task:{...this.getTask(e.id),project:a.project}}):this.in.exec("update-task",{id:e.id,task:{...this.getTask(e.id),project:a.project},skipProvider:!0,skipStateCalc:!0}))}const p=r.tasks,f=p.findIndex((e=>ze(e.id,t))),h=p.splice(f,u+1);let m=o?0:r.tasks.length+1;if(c&&!He(s)){const e=this.getChildrenIds({id:n,tree:!0}),s=e.length&&!o?e.at(-1):n;m=ze(t,s)?f:p.findIndex((t=>ze(t.id,s)))+1}if(l){const e=this.getChildrenIds({id:s,tree:!0});if(o)ze(n,s)&&e.length&&!ze(t,e[0])&&(s=e[0]),m=p.findIndex((t=>ze(t.id,s)));else{for(let n=e.length-1;n>=0;n--){const o=e[n];if(!ze(o,t)&&!d.some((t=>ze(t,o)))){s=o;break}}m=p.findIndex((t=>ze(t.id,s)))+1}}p.splice(m,0,...h);const{treeTasks:g,childrenMap:$,filteredChildrenMap:k,usersMap:v}=this.getInnerState(p,r.activeProject);this.setState({tasks:p,treeTasks:g,childrenMap:$,filteredChildrenMap:k,usersMap:v}),this._setTasksMap(p)}pasteTask({targetId:t,parent:e,project:n,reverse:s}){const{copiedTasksId:o}=this.getState(),i=(t,e)=>{const n=Ge(this.getTask(t)),s=this.getChildren({id:t});if(n.id=Oe().toString(),n.parent=e,"selected"in n&&delete n.selected,"draggable"in n&&delete n.draggable,r.push(n),s.length)for(let t=0;t<s.length;t++)i(s[t].id,n.id)},r=[];for(const t of o)i(t,e);for(let o=0;o<r.length;o++){const i=r[o];0===o?this.in.exec("add-task",{task:i,id:i.id,parent:e,targetId:t,reverse:s,project:n,skipProvider:!0}):this.in.exec("add-task",{task:i,id:i.id,parent:i.parent,targetId:r[o-1]?.id,project:n,skipProvider:!0})}r.length&&this.in.exec("clone-task",{parent:e,targetId:t,project:n,reverse:s,batch:r})}getTask(t){return this.getState().tasksMap[t]}getProject(t){return this.getState().projects.find((e=>ze(e.id,t)))}getChildren({id:t,tree:e=!1,filtered:n=!1,hideCompleted:s=!1}){if(!this.existsTask(t)&&He(t))return;let o=[];if(He(t)){const s=this.getState()[n?"filteredChildrenMap":"childrenMap"][t];if(o=[...o,...s],e)for(let t=0;t<s.length;t++){const e=s[t];e?.children?.length&&(o=[...o,...this.getChildren({id:e.id,tree:!0,filtered:n})])}}else o=this.getState().treeTasks;return s?o.filter((t=>!t.checked)):o}getChildrenIds({id:t,tree:e=!0,filtered:n=!1,hideCompleted:s=!1}){if(!this.existsTask(t)&&He(t))return;let o=[];const i=this.getChildren({id:t,tree:!1,filtered:n,hideCompleted:s});for(let t=0;t<i.length;t++){const r=i[t];o.push(r.id),r?.children?.length&&e&&(o=[...o,...this.getChildrenIds({id:r.id,tree:e,filtered:n,hideCompleted:s})])}return o}getParentIds(t){if(!this.existsTask(t))return;const e=[],n=this.getTask(t)?.parent;return this.existsTask(n)&&e.push(n,...this.getParentIds(n)),e}getTailId(t,e=!1,n=!1){const s=this.getChildrenIds({id:t,filtered:e,hideCompleted:n});return s.length?s.at(-1):t}hasChildren(t,e,n=!1){const s=this.getState()[e?"filteredChildrenMap":"childrenMap"];return!!(n?s[t]?.filter((t=>!t.checked)):s[t])?.length}getTreeIndex(t,e=!1,n=!1){const s=this.getTask(t);return this.getChildren({id:s?.parent,filtered:e,hideCompleted:n}).findIndex((e=>ze(e.id,t)))}getNearId({id:t,dir:e="next",flat:n=!1,filtered:s=!1,hideCompleted:o=!1}){if(this.existsTask(t))return"next"===e?this._getNextId(t,n,!1,s,o):this._getPrevId(t,n,s,o)}getInnerState(t,e,n){const{users:s,filter:o,taskShape:i,defaultTags:r}=this.getState(),a=Ge(t),c=new Set(r),l=function(t){const e={};t=Ge(t);for(let n=0;n<t?.length;n++){const s=t[n];s.color=s.color||Ue[n%Ue.length],e[s.id]=s}return e}(s),d={},u={};let p={},f=[];for(let t=0;t<a.length;t++){const e=a[t];if(e.assigned?.length&&s?.length&&(e.availableUsers=rn(l,e)),d[a[t].id]=t,a[t].children=[],u[e.id]=[],e.text){const t=e.text.matchAll(tn("#"));for(const e of t)c.add(e[0])}}for(let t=0;t<a.length;t++){const e=a[t];e.parent&&u[e.parent]?(a[d[e.parent]].children.push(e),u[e.parent].push(e)):He(e.parent)||f.push(e)}if(f=f.filter((t=>ze(t.project,e))),n){const e=f.at(0).id;js(f,n);const s=We(f),o=t.findIndex((t=>ze(t.id,e)));t.splice(o,s.length,...s),this.setState({tasks:t})}He(o)&&(f=nn(f,o),p=function(t){const e={},n=t=>{for(let s=0;s<t.length;s++){const o=t[s];e[o.id]||(e[o.id]=[...o?.children]),o?.children?.length&&n(o.children)}};return n(t),e}(f));for(let t=0;t<f.length;t++)on(f[t],u,i);return{treeTasks:f,childrenMap:u,usersMap:l,filteredChildrenMap:p,tags:[...c]}}_setTasksMap(t){const e={};for(const n of t)e[n.id]=n;this.setState({tasksMap:e})}_setHandlers(t){Object.keys(t).forEach((e=>{this.in.on(e,(n=>t[e](this,n)))}))}_getNextId(t,e=!1,n=!1,s=!1,o=!1){const i=this.getTask(t),r=this.hasChildren(t,s,o);if(e||!r||i.collapsed||n){const n=this.getTask(i?.parent)?.id,r=this.getChildren({id:n,filtered:s,hideCompleted:o}),a=qe(r,(e=>ze(e.id,t)));return a+1<r.length?r[a+1]?.id:He(n)?this._getNextId(n,e,!0,s,o):null}return this.getChildren({id:t,filtered:s,hideCompleted:o})[0]?.id}_getPrevId(t,e=!1,n=!1,s=!1){const o=this.getTreeIndex(t,n,s),i=this.getTask(t)?.parent;if(o>0){let t=this.getChildren({id:i,filtered:n,hideCompleted:s})[o-1];if(!this.hasChildren(t.id,n,s)||t.collapsed)return t.id;for(;!e&&this.hasChildren(t.id,n,s)&&!t.collapsed;){const e=this.getChildren({id:t.id,filtered:n,hideCompleted:s});t=e[e.length-1]}return t.id}return He(i)?i:null}}function Is(t,e){return t.filter((t=>t.includes(e))).map((t=>({label:t,id:t})))}const Ms=(t=[],e)=>t.map((t=>(t?.label&&(t.label=e(t.label)),t?.data&&Ms(t.data,e),t))),Ds=t=>{const e={},n=["monthShort","monthFull","dayShort","dayFull"];for(const s of n)e[s]=t(s);return e};function Ps(t,e){let n;const s=e.api,o=e.readonly,i=t=>{n=t.target},r=t=>{const e=ds(n,"data-list-id"),i=n===t.target,{stateEditableItem:r}=s.getState();if(!ze(r?.id,e)&&i){const i=ds(n,"data-menu-id"),r=2===t.button,a=s.getSelection();let c=t.ctrlKey||t.metaKey,l=t.shiftKey;if(o&&(c=l=!1),r&&a.some((t=>ze(t,e)))||i&&a.some((t=>ze(t,i))))return;!function({id:t,api:e,ctrlMode:n,shiftMode:s}){const{selected:o,treeTasks:i,taskShape:r}=e.getState();if(!He(t))return void e.eachSelected((t=>{e.exec("unselect-task",{id:t})}));const a=e.getTask({id:t});if(n&&a?.selected){e.exec("unselect-task",{id:t});const n=e.getParentIds({id:t});for(const t of n){e.getTask({id:t})?.selected&&e.exec("unselect-task",{id:t})}return}if(a?.selected)return void(n||s||e.eachSelected((n=>{ze(n,t)||e.exec("unselect-task",{id:n})})));e.exec("select-task",{id:t,join:n||s}),(n||s)&&Es(e,t);if(!n&&s&&o.length>1){const n=r?.completed?.taskHide,s=n?We(i).filter((t=>!t.checked)):We(i),a=o[0],c=s.findIndex((t=>ze(t.id,a))),l=s.findIndex((e=>ze(e.id,t)));if(c<0||l<0)return;if(c<l)for(let t=c+1;t<l;t++){const n=s[t];n?.selected||(e.exec("select-task",{id:n.id,join:!0}),Es(e,n.id))}else if(c>l)for(let t=c-1;t>l;t--){const n=s[t];n?.selected||(e.exec("select-task",{id:n.id,join:!0}),Es(e,n.id))}}}({id:e,api:s,ctrlMode:c,shiftMode:l}),t.stopPropagation(),document.getSelection().removeAllRanges()}};return t.addEventListener("mousedown",i),t.addEventListener("mouseup",r),{destroy(){t.removeEventListener("mousedown",i),t.removeEventListener("mouseup",r)}}}function Es(t,e){const n=t.getChildrenIds({id:e});for(const e of n){!t.getTask({id:e})?.selected&&t.exec("select-task",{id:e,join:!0})}}function Ns(t,e){if(e?.readonly)return;const n=e.api;let s,o,i,r=null,a=null,c=null,l=null,d=null,u=null,p=[],f=null,h=null,m=null,g={},$=null,k=!1,v=!1;const x={duration:500,timer:null,callback:null},y=t=>{if(o&&clearTimeout(o),a){const e=50,n=a.getBoundingClientRect(),s={x:a.scrollLeft,y:a.scrollTop},{x:i,y:r}=As(t);i>n.width+n.left-e&&a.scrollTo(s.x+e,s.y),i<n.left+e&&a.scrollTo(s.x-e,s.y),r>n.height+n.top-e&&a.scrollTo(s.x,s.y+e),r<n.top+e&&a.scrollTo(s.x,s.y-e),o=setTimeout((()=>{y(t)}),100)}},w=t=>{s=M(t),S(s),(t=>{const{x:e,y:s}=As(t),o=document.elementFromPoint(e,s);o&&o.dataset.separator||(d=o?ls(o,"data-drag-list-id"):null,h=d?ds(d,"data-drag-list-id"):null,"move"===$&&n.getTask({id:h})?.draggable&&(h=null))})(t),m=He(h)?function(t,e){if(!e)return null;const{top:n,height:s}=e.getBoundingClientRect(),o=(As(t).y-n)/s;return o<=.25?"top":o>=.75?"bottom":"in"}(t,d):null,h?b(m):_(),n.exec("drag",{start:f,source:p,target:h,dropPosition:m})},b=t=>{r.contains(u)||(u=document.createElement("div"),u.classList.add("wx-todo_dropped-line"),r.appendChild(u));const e=d.getBoundingClientRect(),s=e.left+window.pageXOffset,o=e.top+window.pageYOffset;if("in"===t)return u.style.opacity="0.5",u.style.width=e.width+"px",u.style.height=e.height+"px",u.style.left=s+"px",void(u.style.top=o+"px");const i=getComputedStyle(d),a=n.hasChildren({id:h,filtered:k,hideCompleted:v}),c=a?16:40,l=parseInt(d.dataset.listLevel),p=1===l?"top"===t?-6.5:6.5:0,f="top"===t?0:parseFloat(i.height),m=parseFloat(i.paddingLeft)-(1===l?c:0),g=e.width-m;u.style.opacity="1",u.style.width=g+"px",u.style.height="4px";let $=0;if("bottom"===t&&a){const t=d.parentElement.getBoundingClientRect();$=1===l?t.height-f-p-4-4:t.height-f}u.style.top=o+f+p+$-2+"px",u.style.left=s+m+"px"},_=()=>{r.contains(u)&&r.removeChild(u)},S=({x:t,y:e})=>{l.style.left=t+"px",l.style.top=e+"px"},T=t=>{const e=n.hasChildren({id:h,filtered:k,hideCompleted:v})?16:40;p.length>1&&r.style.setProperty("--wx-todo-dragged-tasks-count",JSON.stringify(p.length<99?`${p.length}`:"+99")),s=M(t),r.appendChild(l),l.classList.add("wx-todo__dragged-task"),l.style.paddingLeft=e+"px",l.style.left=s.x+"px",l.style.top=s.y+"px"},j=t=>{const{stateEditableItem:s,menu:o,stateDueDate:d}=n.getState(),u=t.ctrlKey||t.metaKey,p=t.shiftKey,h=He(s);if(!(u||p||h||d?.open||o||t.touches&&t.touches.length>1||"button"in t&&0!==t.button)){if(r=document.querySelector(".wx-portal"),a=document.querySelector(`[data-todo-wrapper-id="${e.id}"]`),c=ls(t.target,"data-drag-list-id"),f=ds(t.target,"data-drag-list-id"),i="touches"in t?{up:"touchend",move:"touchmove"}:{up:"pointerup",move:"mousemove"},c&&a){k=!!n.getState().filter?.match,v=n.getState().taskShape?.completed?.taskHide;const e=c.getBoundingClientRect(),s=getComputedStyle(c),o=n.hasChildren({id:f,filtered:k,hideCompleted:v})?16:40,r=parseInt(s.paddingLeft)-o;l=c.cloneNode(!0),l.style.width=e.width-r+"px",l.style.height=e.height+"px";const{x:a,y:d}=g=As(t);g.shiftX=a-e.x-r,g.shiftY=d-e.y,"touches"in t?(x.callback=()=>{document.addEventListener(i.move,C)},x.timer=setTimeout(x.callback,x.duration)):document.addEventListener(i.move,C)}document.addEventListener(i.up,I)}},C=t=>{g&&("touches"in t||t.preventDefault(),t.stopPropagation(),y(t),p?.length?w(t):(t=>{const{x:e,y:s}=As(t);g?.x===e&&g?.y===s||He(f)&&($=t.altKey?"copy":"move",n.exec("start-drag",{start:f,mode:$}),p=n.getState().draggableIds,T(t),document.body.classList.add("wx-ondrag"),"touches"in t&&document.body.classList.add("wx-ondrag--touch"))})(t))},I=()=>{document.removeEventListener(i.move,C),document.removeEventListener(i.up,I),x.timer&&clearTimeout(x.timer),r.contains(l)&&(r.removeChild(l),r.style.removeProperty("--wx-todo-dragged-tasks-count")),_(),o&&clearTimeout(o),p.length&&(p=[],n.exec("end-drag",{target:h,dropPosition:m,mode:$})),document.body.classList.remove("wx-ondrag"),document.body.classList.remove("wx-ondrag--touch"),r=c=l=u=d=a=s=h=f=g=null},M=t=>{const{x:e,y:n}=As(t);return{x:e-g.shiftX,y:n-g.shiftY}};return t.addEventListener("mousedown",j),t.addEventListener("touchstart",j),{destroy(){t.removeEventListener("mousedown",j),t.removeEventListener("touchstart",j)}}}function As(t){const e={x:0,y:0};return"touches"in t?(e.x=t.touches[0].clientX,e.y=t.touches[0].clientY):(e.x=t.clientX,e.y=t.clientY),e}function Fs(t,e){if(e.readonly)return;const n=t=>{const n=t.target,s=2===t.button;if(n||s){!function({api:t,id:e,menuId:n,context:s}){const{menu:o}=t.getState(),i=t.getSelection({sorted:!0});o&&"task"===o.type&&t.exec("close-menu",{...o});(s||He(n))&&t.exec("open-menu",{id:e,type:"task",source:i})}({id:ds(n,"data-list-id"),menuId:ds(n,"data-menu-id"),api:e.api,context:s})}};return t.addEventListener("click",n),t.addEventListener("contextmenu",n),{destroy(){t.removeEventListener("click",n),t.removeEventListener("contextmenu",n)}}}function Ls(t,e){const n=t=>{const n=ls(t,"data-user-menu-id"),{menu:s,draggableIds:o}=e.api.getState();if(n&&!o.length){const o=ds(t,"data-user-menu-id");if(!s||s&&!ze(s.id,o)){const t=n.getBoundingClientRect();s&&e.api.exec("close-menu",{...s}),e.api.exec("open-menu",{id:o,type:"user",coords:{x:t.left,y:t.bottom}})}t.stopPropagation()}else s&&"user"===s.type&&e.api.exec("close-menu",{...s})};return t.addEventListener("pointerover",n),{destroy(){t.removeEventListener("pointerover",n)}}}function Rs(t,e){const n=t=>{const n=ds(t.target,"data-tag");n&&(e.api.exec("set-filter",{match:n,highlight:!0,strict:!0}),e.api.exec("set-state-search",{value:n,open:!0,focus:!1,dropdown:{open:!1}}),t.stopPropagation())};return t.addEventListener("click",n),{destroy(){t.removeEventListener("click",n)}}}function Os(t,e){if(e.readonly)return;const n=e.api,s=t=>{const e=ds(t.target,"data-list-editor-id"),s=ds(t.target,"data-date"),{stateEditableItem:o}=n.getState();s&&!He(o)&&n.exec("open-inline-editor",{id:e,type:"task",targetDate:s}),"task"!==o?.type||ze(o?.id,e)||o?.dropdown||n.exec("close-inline-editor",{id:o.id,save:!0})},o=t=>{const e=ds(t.target,"data-list-editor-id"),{stateEditableItem:s}=n.getState();ze(s?.id,e)||n.exec("open-inline-editor",{id:e,type:"task"})};return t.addEventListener("click",s),t.addEventListener("dblclick",o),{destroy(){t.removeEventListener("click",s),t.removeEventListener("dblclick",o)}}}function zs(t,e){let n;const s=t=>{n=ds(t,"data-todo-id")},o=t=>{ze(e.widgetId,n)&&e.api.exec("keypress-on-todo",{code:Hs(t),event:t})};return t.addEventListener("mousedown",s),t.addEventListener("focusin",s),t.addEventListener("keydown",o),{destroy(){t.removeEventListener("mousedown",s),t.removeEventListener("focusin",s),t.removeEventListener("keydown",o)}}}function Hs(t){const e=[];let n=t?.code.toLowerCase();const s=t?.key.toLowerCase(),o=n.startsWith("key"),i=n.startsWith("digit"),r=n.startsWith("numpad");return(t.ctrlKey||t.metaKey)&&e.push("ctrl"),t.shiftKey&&e.push("shift"),t.altKey&&e.push("alt"),o&&(n=n.replace("key","")),i&&(n=n.replace("digit","")),r&&(n=n.replace("numpad","")),["control","alt","shift"].includes(s)||e.push(n),e.join("+")}function Ys(t,e){t.forEach((t=>{e(t),t.data&&t.data.length&&Ys(t.data,e)}))}let qs=1;function Bs(t){return Ys(t,(t=>{t.id=t.id||qs++})),t}const Js={};function Gs(t){return Js[t]}function Ws(t,e){Js[t]=e}function Us(t){let e,n;return{c(){e=M("i"),F(e,"class",n="icon "+t[0].icon+" svelte-kwo2zl")},m(t,n){j(t,e,n)},p(t,s){1&s&&n!==(n="icon "+t[0].icon+" svelte-kwo2zl")&&F(e,"class",n)},d(t){t&&C(e)}}}function Vs(t){let e,n,s=t[0].text+"";return{c(){e=M("span"),n=D(s),F(e,"class","value svelte-kwo2zl")},m(t,s){j(t,e,s),T(e,n)},p(t,e){1&e&&s!==(s=t[0].text+"")&&L(n,s)},i:c,o:c,d(t){t&&C(e)}}}function Ks(t){let e,n,s;var o=Gs(t[0].type);function i(t){return{props:{item:t[0]}}}return o&&(e=new o(i(t))),{c(){e&&xt(e.$$.fragment),n=E()},m(t,o){e&&yt(e,t,o),j(t,n,o),s=!0},p(t,s){const r={};if(1&s&&(r.item=t[0]),o!==(o=Gs(t[0].type))){if(e){ut();const t=e;ht(t.$$.fragment,1,0,(()=>{wt(t,1)})),pt()}o?(e=new o(i(t)),xt(e.$$.fragment),ft(e.$$.fragment,1),yt(e,n.parentNode,n)):e=null}else o&&e.$set(r)},i(t){s||(e&&ft(e.$$.fragment,t),s=!0)},o(t){e&&ht(e.$$.fragment,t),s=!1},d(t){t&&C(n),e&&wt(e,t)}}}function Qs(t){let e,n,s=t[0].subtext+"";return{c(){e=M("span"),n=D(s),F(e,"class","subtext svelte-kwo2zl")},m(t,s){j(t,e,s),T(e,n)},p(t,e){1&e&&s!==(s=t[0].subtext+"")&&L(n,s)},d(t){t&&C(e)}}}function Xs(t){let e;return{c(){e=M("i"),F(e,"class","sub-icon wxi-angle-right svelte-kwo2zl")},m(t,n){j(t,e,n)},d(t){t&&C(e)}}}function Zs(t){let e,n,s,o,i,r,a,c,l,d,u,f=t[0].icon&&Us(t);const h=[Ks,Vs],m=[];function g(t,e){return t[0].type?0:1}s=g(t),o=m[s]=h[s](t);let $=t[0].subtext&&Qs(t),k=t[0].data&&Xs();return{c(){e=M("div"),f&&f.c(),n=P(),o.c(),i=P(),$&&$.c(),r=P(),k&&k.c(),F(e,"class",a="item "+(t[0].css||"")+" svelte-kwo2zl"),F(e,"data-id",c=t[0].id)},m(o,a){j(o,e,a),f&&f.m(e,null),T(e,n),m[s].m(e,null),T(e,i),$&&$.m(e,null),T(e,r),k&&k.m(e,null),l=!0,d||(u=[N(e,"mouseenter",t[1]),N(e,"click",t[4])],d=!0)},p(t,[d]){t[0].icon?f?f.p(t,d):(f=Us(t),f.c(),f.m(e,n)):f&&(f.d(1),f=null);let u=s;s=g(t),s===u?m[s].p(t,d):(ut(),ht(m[u],1,1,(()=>{m[u]=null})),pt(),o=m[s],o?o.p(t,d):(o=m[s]=h[s](t),o.c()),ft(o,1),o.m(e,i)),t[0].subtext?$?$.p(t,d):($=Qs(t),$.c(),$.m(e,r)):$&&($.d(1),$=null),t[0].data?k||(k=Xs(),k.c(),k.m(e,null)):k&&(k.d(1),k=null),(!l||1&d&&a!==(a="item "+(t[0].css||"")+" svelte-kwo2zl"))&&F(e,"class",a),(!l||1&d&&c!==(c=t[0].id))&&F(e,"data-id",c)},i(t){l||(ft(o),l=!0)},o(t){ht(o),l=!1},d(t){t&&C(e),f&&f.d(),m[s].d(),$&&$.d(),k&&k.d(),d=!1,p(u)}}}function to(t,e,n){let{item:s}=e,{showSub:o=!1}=e,{activeItem:i=null}=e;return t.$$set=t=>{"item"in t&&n(0,s=t.item),"showSub"in t&&n(2,o=t.showSub),"activeItem"in t&&n(3,i=t.activeItem)},[s,function(){n(2,o=!!s.data&&s.id),n(3,i=this)},o,i,function(e){K.call(this,t,e)}]}class eo extends St{constructor(t){super(),_t(this,t,to,Zs,h,{item:0,showSub:2,activeItem:3})}}function no(t,e,n){const s=t.slice();return s[25]=e[n],s}function so(t){let e,n,s,o;function i(e){t[14](e)}function r(e){t[15](e)}let a={item:t[25]};return void 0!==t[5]&&(a.showSub=t[5]),void 0!==t[6]&&(a.activeItem=t[6]),e=new eo({props:a}),X.push((()=>vt(e,"showSub",i))),X.push((()=>vt(e,"activeItem",r))),e.$on("click",(function(...e){return t[16](t[25],...e)})),{c(){xt(e.$$.fragment)},m(t,n){yt(e,t,n),o=!0},p(o,i){t=o;const r={};4&i&&(r.item=t[25]),!n&&32&i&&(n=!0,r.showSub=t[5],ot((()=>n=!1))),!s&&64&i&&(s=!0,r.activeItem=t[6],ot((()=>s=!1))),e.$set(r)},i(t){o||(ft(e.$$.fragment,t),o=!0)},o(t){ht(e.$$.fragment,t),o=!1},d(t){wt(e,t)}}}function oo(t){let e;return{c(){e=M("div"),F(e,"class","separator svelte-9lfyly")},m(t,n){j(t,e,n)},p:c,i:c,o:c,d(t){t&&C(e)}}}function io(t){let e,n;return e=new lo({props:{relativeTo:t[7],options:t[25].data,level:t[3]+1,at:"right",parent:t[6]}}),e.$on("click",t[17]),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};128&n&&(s.relativeTo=t[7]),4&n&&(s.options=t[25].data),8&n&&(s.level=t[3]+1),64&n&&(s.parent=t[6]),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function ro(t,e){let n,s,o,i,r,a;const c=[oo,so],l=[];function d(t,e){return"separator"===t[25].type?0:1}s=d(e),o=l[s]=c[s](e);let u=e[25].data&&e[5]===e[25].id&&io(e);return{key:t,first:null,c(){n=E(),o.c(),i=P(),u&&u.c(),r=E(),this.first=n},m(t,e){j(t,n,e),l[s].m(t,e),j(t,i,e),u&&u.m(t,e),j(t,r,e),a=!0},p(t,n){let a=s;s=d(e=t),s===a?l[s].p(e,n):(ut(),ht(l[a],1,1,(()=>{l[a]=null})),pt(),o=l[s],o?o.p(e,n):(o=l[s]=c[s](e),o.c()),ft(o,1),o.m(i.parentNode,i)),e[25].data&&e[5]===e[25].id?u?(u.p(e,n),36&n&&ft(u,1)):(u=io(e),u.c(),ft(u,1),u.m(r.parentNode,r)):u&&(ut(),ht(u,1,1,(()=>{u=null})),pt())},i(t){a||(ft(o),ft(u),a=!0)},o(t){ht(o),ht(u),a=!1},d(t){t&&C(n),l[s].d(t),t&&C(i),u&&u.d(t),t&&C(r)}}}function ao(t){let e,n,s,i,r,a=[],c=new Map,l=t[2];const d=t=>t[25].id;for(let e=0;e<l.length;e+=1){let n=no(t,l,e),s=d(n);c.set(s,a[e]=ro(s,n))}return{c(){e=M("div");for(let t=0;t<a.length;t+=1)a[t].c();F(e,"class",n="menu "+(t[3]>1?"sub":"")+" svelte-9lfyly"),O(e,"top",t[1]+"px"),O(e,"left",t[0]+"px"),O(e,"width",t[4]),F(e,"data-level",t[3])},m(n,c){j(n,e,c);for(let t=0;t<a.length;t+=1)a[t].m(e,null);t[18](e),s=!0,i||(r=[S(o.call(null,e,t[10])),N(e,"mouseleave",t[9])],i=!0)},p(t,[o]){492&o&&(l=t[2],ut(),a=kt(a,o,d,1,t,l,c,e,$t,ro,null,no),pt()),(!s||8&o&&n!==(n="menu "+(t[3]>1?"sub":"")+" svelte-9lfyly"))&&F(e,"class",n),(!s||2&o)&&O(e,"top",t[1]+"px"),(!s||1&o)&&O(e,"left",t[0]+"px"),(!s||16&o)&&O(e,"width",t[4]),(!s||8&o)&&F(e,"data-level",t[3])},i(t){if(!s){for(let t=0;t<l.length;t+=1)ft(a[t]);s=!0}},o(t){for(let t=0;t<a.length;t+=1)ht(a[t]);s=!1},d(n){n&&C(e);for(let t=0;t<a.length;t+=1)a[t].d();t[18](null),i=!1,p(r)}}}function co(t,e,n){const s=W();let o,i,r,a,c,l,d,u,{options:p}=e,{level:f=1}=e,{left:h=0}=e,{top:m=0}=e,{at:g="bottom"}=e,{parent:$=null}=e,{relativeTo:k=document.body}=e;G((function(){if(!u)return;const t=document.body.getBoundingClientRect(),e=u.getBoundingClientRect();let s=a;const o=e.bottom-t.bottom;o>0&&n(1,m-=o);const c=e.right-t.right;c>0&&("right"!==g?n(0,h-=c):s=!0),s&&n(0,h=(f>1?0:r?i.right:i.left)-e.width);const l=h-t.left;l<0&&f<2&&n(0,"left"!==g?h-=l:h=f>1?i.width:i.right)}));return t.$$set=t=>{"options"in t&&n(2,p=t.options),"level"in t&&n(3,f=t.level),"left"in t&&n(0,h=t.left),"top"in t&&n(1,m=t.top),"at"in t&&n(11,g=t.at),"parent"in t&&n(12,$=t.parent),"relativeTo"in t&&n(13,k=t.relativeTo)},t.$$.update=()=>{4&t.$$.dirty&&Bs(p),2048&t.$$.dirty&&(r=-1!==g.indexOf("bottom")),2048&t.$$.dirty&&(a=-1!==g.indexOf("left")),2048&t.$$.dirty&&(c=-1!==g.indexOf("fit")),4096&t.$$.dirty&&function(t){if(!t||"point"===g)return;i=t.getBoundingClientRect();const e=k.getBoundingClientRect();n(0,h=("right"===g?i.right+(f?0:1):i.left)-e.left),n(1,m=(r?i.bottom+1:i.top)-e.top),n(4,o=c?i.width+"px":"auto"),n(0,h+=k.scrollLeft),n(1,m+=k.scrollTop)}($)},[h,m,p,f,o,l,d,u,s,function(){n(5,l=!1)},function(){s("click",{action:null})},g,$,k,function(t){l=t,n(5,l)},function(t){d=t,n(6,d)},(t,e)=>{t.data||e.defaultPrevented||s("click",{action:t})},function(e){K.call(this,t,e)},function(t){X[t?"unshift":"push"]((()=>{u=t,n(7,u)}))}]}class lo extends St{constructor(t){super(),_t(this,t,co,ao,h,{options:2,level:3,left:0,top:1,at:11,parent:12,relativeTo:13})}}function uo(t){let e,n,s,o;return{c(){e=M("i"),F(e,"class",n="wx-todo_icon wxi wxi-"+t[0]+" "+(t[4]?t[4]:"wx-todo_icon--default")+" svelte-1dloatb"),O(e,"font-size",t[1]+"px"),O(e,"height",t[1]+"px"),O(e,"width",t[1]+"px"),z(e,"wx-todo_icon--clickable",t[2]),z(e,"wx-todo_icon--disabled",t[3])},m(n,i){j(n,e,i),s||(o=N(e,"click",t[5]),s=!0)},p(t,[s]){17&s&&n!==(n="wx-todo_icon wxi wxi-"+t[0]+" "+(t[4]?t[4]:"wx-todo_icon--default")+" svelte-1dloatb")&&F(e,"class",n),2&s&&O(e,"font-size",t[1]+"px"),2&s&&O(e,"height",t[1]+"px"),2&s&&O(e,"width",t[1]+"px"),21&s&&z(e,"wx-todo_icon--clickable",t[2]),25&s&&z(e,"wx-todo_icon--disabled",t[3])},i:c,o:c,d(t){t&&C(e),s=!1,o()}}}function po(t,e,n){let{name:s}=e,{size:o=20}=e,{clickable:i=!1}=e,{disabled:r=!1}=e,{css:a=""}=e;return t.$$set=t=>{"name"in t&&n(0,s=t.name),"size"in t&&n(1,o=t.size),"clickable"in t&&n(2,i=t.clickable),"disabled"in t&&n(3,r=t.disabled),"css"in t&&n(4,a=t.css)},[s,o,i,r,a,function(e){K.call(this,t,e)}]}class fo extends St{constructor(t){super(),_t(this,t,po,uo,h,{name:0,size:1,clickable:2,disabled:3,css:4})}}function ho(t){let e,n;return e=new fo({props:{name:t[1]}}),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};2&n&&(s.name=t[1]),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function mo(t){let e,n;return{c(){e=M("div"),n=D(t[2]),F(e,"class","wx-todo_item__hotkey svelte-18hs7sv")},m(t,s){j(t,e,s),T(e,n)},p(t,e){4&e&&L(n,t[2])},d(t){t&&C(e)}}}function go(t){let e,n,s;return n=new fo({props:{name:"menu-right"}}),{c(){e=M("div"),xt(n.$$.fragment),F(e,"class","wx-todo_item__sub-icon svelte-18hs7sv")},m(t,o){j(t,e,o),yt(n,e,null),s=!0},i(t){s||(ft(n.$$.fragment,t),s=!0)},o(t){ht(n.$$.fragment,t),s=!1},d(t){t&&C(e),wt(n)}}}function $o(t){let e,n,s,o,i,r,a,c=t[1]&&ho(t),l=t[2]&&mo(t),d=t[0]?.length&&go();return{c(){e=M("div"),c&&c.c(),n=P(),s=M("div"),o=D(t[3]),i=P(),l&&l.c(),r=P(),d&&d.c(),F(s,"class","wx-todo_item__label svelte-18hs7sv"),F(e,"class","wx-todo_item svelte-18hs7sv")},m(t,u){j(t,e,u),c&&c.m(e,null),T(e,n),T(e,s),T(s,o),T(e,i),l&&l.m(e,null),T(e,r),d&&d.m(e,null),a=!0},p(t,[s]){t[1]?c?(c.p(t,s),2&s&&ft(c,1)):(c=ho(t),c.c(),ft(c,1),c.m(e,n)):c&&(ut(),ht(c,1,1,(()=>{c=null})),pt()),(!a||8&s)&&L(o,t[3]),t[2]?l?l.p(t,s):(l=mo(t),l.c(),l.m(e,r)):l&&(l.d(1),l=null),t[0]?.length?d?1&s&&ft(d,1):(d=go(),d.c(),ft(d,1),d.m(e,null)):d&&(ut(),ht(d,1,1,(()=>{d=null})),pt())},i(t){a||(ft(c),ft(d),a=!0)},o(t){ht(c),ht(d),a=!1},d(t){t&&C(e),c&&c.d(),l&&l.d(),d&&d.d()}}}function ko(t,e,n){let s,o,i,r,{item:a}=e;return t.$$set=t=>{"item"in t&&n(4,a=t.item)},t.$$.update=()=>{16&t.$$.dirty&&n(3,s=a.label),16&t.$$.dirty&&n(2,o=a.hotkey),16&t.$$.dirty&&n(1,i=a.icon),16&t.$$.dirty&&n(0,r=a.data)},[r,i,o,s,a]}class vo extends St{constructor(t){super(),_t(this,t,ko,$o,h,{item:4})}}function xo(t){let e,n,s;return{c(){e=M("div"),n=D(t[0]),F(e,"class","wx-todo_avatar svelte-2w6inz"),F(e,"style",s=t[3](t[2],t[1]))},m(t,s){j(t,e,s),T(e,n)},p(t,[o]){1&o&&L(n,t[0]),6&o&&s!==(s=t[3](t[2],t[1]))&&F(e,"style",s)},i:c,o:c,d(t){t&&C(e)}}}function yo(t,e,n){let{value:s=""}=e,{avatar:o=""}=e,{color:i="#0AB169"}=e;return t.$$set=t=>{"value"in t&&n(0,s=t.value),"avatar"in t&&n(1,o=t.avatar),"color"in t&&n(2,i=t.color)},[s,o,i,(t,e)=>{let n=`background-color: ${t};`;return e&&(n+=`background-image: url(${e});`),n}]}class wo extends St{constructor(t){super(),_t(this,t,yo,xo,h,{value:0,avatar:1,color:2})}}function bo(t){let e,n;return e=new fo({props:{name:t[4]}}),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};16&n&&(s.name=t[4]),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function _o(t){let e,n,s,o,i,r,a,c,l=t[4]&&bo(t);return o=new wo({props:{avatar:t[2],color:t[3]}}),{c(){e=M("div"),l&&l.c(),n=P(),s=M("div"),xt(o.$$.fragment),i=P(),r=M("div"),a=D(t[5]),F(s,"class","wx-todo_user-item__avatar svelte-2s0u9f"),F(r,"class","wx-todo_user-item__label svelte-2s0u9f"),F(e,"class","wx-todo_user-item svelte-2s0u9f"),z(e,"wx-todo_user-item--checked",t[1]),z(e,"wx-todo_user-item--clicable",t[0])},m(t,d){j(t,e,d),l&&l.m(e,null),T(e,n),T(e,s),yt(o,s,null),T(e,i),T(e,r),T(r,a),c=!0},p(t,[s]){t[4]?l?(l.p(t,s),16&s&&ft(l,1)):(l=bo(t),l.c(),ft(l,1),l.m(e,n)):l&&(ut(),ht(l,1,1,(()=>{l=null})),pt());const i={};4&s&&(i.avatar=t[2]),8&s&&(i.color=t[3]),o.$set(i),(!c||32&s)&&L(a,t[5]),2&s&&z(e,"wx-todo_user-item--checked",t[1]),1&s&&z(e,"wx-todo_user-item--clicable",t[0])},i(t){c||(ft(l),ft(o.$$.fragment,t),c=!0)},o(t){ht(l),ht(o.$$.fragment,t),c=!1},d(t){t&&C(e),l&&l.d(),wt(o)}}}function So(t,e,n){let s,o,i,r,a,c,{item:l}=e;return t.$$set=t=>{"item"in t&&n(6,l=t.item)},t.$$.update=()=>{64&t.$$.dirty&&n(5,s=l.label),64&t.$$.dirty&&n(4,o=l.icon),64&t.$$.dirty&&n(3,i=l.color),64&t.$$.dirty&&n(2,r=l.avatar),64&t.$$.dirty&&n(1,a=l.checked),64&t.$$.dirty&&n(0,c=l.clickable)},[c,a,r,i,o,s,l]}class To extends St{constructor(t){super(),_t(this,t,So,_o,h,{item:6})}}function jo(t){let e,n,s,o,i,r;function a(e){t[4](e)}let c={cancel:t[2]};return void 0!==t[0]&&(c.value=t[0]),n=new ue({props:c}),X.push((()=>vt(n,"value",a))),{c(){e=M("div"),xt(n.$$.fragment),F(e,"class","wx-todo_date-item svelte-1l2j6bx")},m(s,a){j(s,e,a),yt(n,e,null),o=!0,i||(r=N(e,"click",t[1]),i=!0)},p(t,[e]){const o={};!s&&1&e&&(s=!0,o.value=t[0],ot((()=>s=!1))),n.$set(o)},i(t){o||(ft(n.$$.fragment,t),o=!0)},o(t){ht(n.$$.fragment,t),o=!1},d(t){t&&C(e),wt(n),i=!1,r()}}}function Co(t,e,n){let s,o;let{item:i}=e;return t.$$set=t=>{"item"in t&&n(3,i=t.item)},t.$$.update=()=>{8&t.$$.dirty&&(s=i.store),8&t.$$.dirty&&n(0,o=i.value)},[o,t=>t.preventDefault(),()=>{const{menu:t}=s.getState(),e=s.getSelection().map((t=>({...s.getTask(t),due_date:o||null})));s.eachSelected(((t,n)=>{const i=s.getTask(t);s.in.exec("update-task",{id:t,task:{...i,due_date:o||null},skipProvider:!!n,batch:n?[]:e.slice(1)})})),s.in.exec("close-menu",{...t})},i,function(t){o=t,n(0,o),n(3,i)}]}class Io extends St{constructor(t){super(),_t(this,t,Co,jo,h,{item:3})}}function Mo(t){let e,n;return e=new fo({props:{name:t[1]}}),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};2&n&&(s.name=t[1]),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function Do(t){let e,n;return{c(){e=M("div"),n=D(t[0]),F(e,"class","wx-todo_item__hotkey svelte-rqtk31")},m(t,s){j(t,e,s),T(e,n)},p(t,e){1&e&&L(n,t[0])},d(t){t&&C(e)}}}function Po(t){let e,n,s,o,i,r,a,c,l=t[1]&&Mo(t),d=t[0]&&Do(t);return{c(){e=M("div"),l&&l.c(),n=P(),s=M("div"),o=P(),i=M("div"),r=D(t[3]),a=P(),d&&d.c(),F(s,"class","wx-todo_item__priority-icon svelte-rqtk31"),O(s,"background-color",t[2]),F(i,"class","wx-todo_item__label svelte-rqtk31"),F(e,"class","wx-todo_item svelte-rqtk31")},m(t,u){j(t,e,u),l&&l.m(e,null),T(e,n),T(e,s),T(e,o),T(e,i),T(i,r),T(e,a),d&&d.m(e,null),c=!0},p(t,[o]){t[1]?l?(l.p(t,o),2&o&&ft(l,1)):(l=Mo(t),l.c(),ft(l,1),l.m(e,n)):l&&(ut(),ht(l,1,1,(()=>{l=null})),pt()),(!c||4&o)&&O(s,"background-color",t[2]),(!c||8&o)&&L(r,t[3]),t[0]?d?d.p(t,o):(d=Do(t),d.c(),d.m(e,null)):d&&(d.d(1),d=null)},i(t){c||(ft(l),c=!0)},o(t){ht(l),c=!1},d(t){t&&C(e),l&&l.d(),d&&d.d()}}}function Eo(t,e,n){let s,o,i,r,{item:a}=e;return t.$$set=t=>{"item"in t&&n(4,a=t.item)},t.$$.update=()=>{16&t.$$.dirty&&n(3,s=a.label),16&t.$$.dirty&&n(2,o=a.color),16&t.$$.dirty&&n(1,i=a.icon),16&t.$$.dirty&&n(0,r=a.hotkey)},[r,i,o,s,a]}class No extends St{constructor(t){super(),_t(this,t,Eo,Po,h,{item:4})}}function Ao(t){let e,n,s;return n=new lo({props:{options:t[2],left:t[0],top:t[1]}}),n.$on("click",t[7]),{c(){e=M("div"),xt(n.$$.fragment),F(e,"class","wx-menu")},m(o,i){j(o,e,i),yt(n,e,null),t[8](e),s=!0},p(t,e){const s={};4&e&&(s.options=t[2]),1&e&&(s.left=t[0]),2&e&&(s.top=t[1]),n.$set(s)},i(t){s||(ft(n.$$.fragment,t),s=!0)},o(t){ht(n.$$.fragment,t),s=!1},d(s){s&&C(e),wt(n),t[8](null)}}}function Fo(t){let e,n;return e=new he({props:{theme:"material",$$slots:{default:[Ao]},$$scope:{ctx:t}}}),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,[n]){const s={};1039&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function Lo(t,e,n){Ws("item",vo),Ws("user",To),Ws("datepicker",Io),Ws("priority",No);let{options:s}=e,{parent:o}=e,{left:i=0}=e,{top:r=0}=e,{offsetTop:a=5}=e,{offsetLeft:c=5}=e,l=null;return G((function(){if(!o)return;const t=l.children[0],e=o.getBoundingClientRect(),s=t.getBoundingClientRect(),d=window.pageYOffset,u=window.pageXOffset;n(0,i=e.right-s.width-c+u),n(1,r=e.bottom+a+d)})),t.$$set=t=>{"options"in t&&n(2,s=t.options),"parent"in t&&n(4,o=t.parent),"left"in t&&n(0,i=t.left),"top"in t&&n(1,r=t.top),"offsetTop"in t&&n(5,a=t.offsetTop),"offsetLeft"in t&&n(6,c=t.offsetLeft)},[i,r,s,l,o,a,c,function(e){K.call(this,t,e)},function(t){X[t?"unshift":"push"]((()=>{l=t,n(3,l)}))}]}class Ro extends St{constructor(t){super(),_t(this,t,Lo,Fo,h,{options:2,parent:4,left:0,top:1,offsetTop:5,offsetLeft:6})}}function Oo(t){let e,n;return e=new fo({props:{name:"check",size:16}}),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function zo(t){let e,n,s,o,i,r,a,c=t[0]&&Oo();return{c(){e=M("label"),n=M("input"),s=P(),o=M("span"),c&&c.c(),F(n,"id",t[2]),n.disabled=t[1],F(n,"type","checkbox"),F(n,"class","wx-todo_checkbox__input svelte-1u2bz8m"),F(o,"class","wx-todo_checkbox__icon svelte-1u2bz8m"),z(o,"wx-todo_checkbox--checked",t[0]),F(e,"for",t[2]),F(e,"class","wx-todo_checkbox wx-todo_checkbox__label svelte-1u2bz8m"),z(e,"wx-todo_checkbox--disabled",t[1])},m(l,d){j(l,e,d),T(e,n),n.checked=t[0],T(e,s),T(e,o),c&&c.m(o,null),i=!0,r||(a=[N(n,"change",A(t[3])),N(n,"change",t[4])],r=!0)},p(t,[s]){(!i||4&s)&&F(n,"id",t[2]),(!i||2&s)&&(n.disabled=t[1]),1&s&&(n.checked=t[0]),t[0]?c?1&s&&ft(c,1):(c=Oo(),c.c(),ft(c,1),c.m(o,null)):c&&(ut(),ht(c,1,1,(()=>{c=null})),pt()),1&s&&z(o,"wx-todo_checkbox--checked",t[0]),(!i||4&s)&&F(e,"for",t[2]),2&s&&z(e,"wx-todo_checkbox--disabled",t[1])},i(t){i||(ft(c),i=!0)},o(t){ht(c),i=!1},d(t){t&&C(e),c&&c.d(),r=!1,p(a)}}}function Ho(t,e,n){let{disabled:s=!1}=e,{checked:o=!1}=e,{id:i=Oe().toString()}=e;return t.$$set=t=>{"disabled"in t&&n(1,s=t.disabled),"checked"in t&&n(0,o=t.checked),"id"in t&&n(2,i=t.id)},[o,s,i,function(e){K.call(this,t,e)},function(){o=this.checked,n(0,o)}]}class Yo extends St{constructor(t){super(),_t(this,t,Ho,zo,h,{disabled:1,checked:0,id:2})}}function qo(t){let e,n,s,o;const i=t[4].default,r=$(i,t,t[3],null);return{c(){e=M("button"),r&&r.c(),F(e,"class","wx-todo_button svelte-10n97i3"),O(e,"width","number"==typeof t[0]?`${t[0]}px`:t[0]),O(e,"height","number"==typeof t[1]?`${t[1]}px`:t[1]),z(e,"wx-todo_button--circle",t[2])},m(i,a){j(i,e,a),r&&r.m(e,null),n=!0,s||(o=N(e,"click",t[5]),s=!0)},p(t,[s]){r&&r.p&&(!n||8&s)&&x(r,i,t,t[3],n?v(i,t[3],s,null):y(t[3]),null),(!n||1&s)&&O(e,"width","number"==typeof t[0]?`${t[0]}px`:t[0]),(!n||2&s)&&O(e,"height","number"==typeof t[1]?`${t[1]}px`:t[1]),4&s&&z(e,"wx-todo_button--circle",t[2])},i(t){n||(ft(r,t),n=!0)},o(t){ht(r,t),n=!1},d(t){t&&C(e),r&&r.d(t),s=!1,o()}}}function Bo(t,e,n){let{$$slots:s={},$$scope:o}=e,{width:i=20}=e,{height:r=20}=e,{circle:a=!1}=e;return t.$$set=t=>{"width"in t&&n(0,i=t.width),"height"in t&&n(1,r=t.height),"circle"in t&&n(2,a=t.circle),"$$scope"in t&&n(3,o=t.$$scope)},[i,r,a,o,s,function(e){K.call(this,t,e)}]}class Jo extends St{constructor(t){super(),_t(this,t,Bo,qo,h,{width:0,height:1,circle:2})}}function Go(t){let e,n=ts(t[0],t[1])+"";return{c(){e=M("div"),F(e,"class","wx-todo_text svelte-1h03wzk"),F(e,"tabindex","0"),z(e,"wx-todo_text--completed",t[2])},m(t,s){j(t,e,s),e.innerHTML=n},p(t,[s]){3&s&&n!==(n=ts(t[0],t[1])+"")&&(e.innerHTML=n),4&s&&z(e,"wx-todo_text--completed",t[2])},i:c,o:c,d(t){t&&C(e)}}}function Wo(t,e,n){let{value:s=""}=e,{filter:o}=e,{completed:i=!1}=e;return t.$$set=t=>{"value"in t&&n(0,s=t.value),"filter"in t&&n(1,o=t.filter),"completed"in t&&n(2,i=t.completed)},[s,o,i]}class Uo extends St{constructor(t){super(),_t(this,t,Wo,Go,h,{value:0,filter:1,completed:2})}}function Vo(t){let e,n;const s=t[4].default,o=$(s,t,t[6],null);return{c(){e=M("div"),o&&o.c(),F(e,"class","wx-todo_popup svelte-1thl4la"),O(e,"left",t[0].x+"px"),O(e,"top",t[0].y+"px")},m(s,i){j(s,e,i),o&&o.m(e,null),t[5](e),n=!0},p(t,i){o&&o.p&&(!n||64&i)&&x(o,s,t,t[6],n?v(s,t[6],i,null):y(t[6]),null),(!n||1&i)&&O(e,"left",t[0].x+"px"),(!n||1&i)&&O(e,"top",t[0].y+"px")},i(t){n||(ft(o,t),n=!0)},o(t){ht(o,t),n=!1},d(n){n&&C(e),o&&o.d(n),t[5](null)}}}function Ko(t){let e,n,s,o;return e=new he({props:{theme:"material",$$slots:{default:[Vo]},$$scope:{ctx:t}}}),{c(){xt(e.$$.fragment)},m(i,r){yt(e,i,r),n=!0,s||(o=N(window,"mousedown",t[2]),s=!0)},p(t,[n]){const s={};67&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t),s=!1,o()}}}function Qo(t,e,n){let{$$slots:s={},$$scope:o}=e,{coords:i={x:0,y:0}}=e,{wrapper:r=document.body}=e,a=null;const c=W();return G((function(){if(!a)return;const t=r.getBoundingClientRect(),e=a.getBoundingClientRect(),s=e.bottom-t.bottom;s>0&&n(0,i.y-=s,i);const o=e.right-t.right;o>0&&n(0,i.x-=o,i)})),t.$$set=t=>{"coords"in t&&n(0,i=t.coords),"wrapper"in t&&n(3,r=t.wrapper),"$$scope"in t&&n(6,o=t.$$scope)},[i,a,function(t){a.contains(t.target)||c("cancel",{event:t})},r,s,function(t){X[t?"unshift":"push"]((()=>{a=t,n(1,a)}))},o]}class Xo extends St{constructor(t){super(),_t(this,t,Qo,Ko,h,{coords:0,wrapper:3})}}function Zo(t){let e,n,s;function o(e){t[6](e)}let i={cancel:t[2]};return void 0!==t[0]&&(i.value=t[0]),e=new ue({props:i}),X.push((()=>vt(e,"value",o))),{c(){xt(e.$$.fragment)},m(t,n){yt(e,t,n),s=!0},p(t,s){const o={};!n&&1&s&&(n=!0,o.value=t[0],ot((()=>n=!1))),e.$set(o)},i(t){s||(ft(e.$$.fragment,t),s=!0)},o(t){ht(e.$$.fragment,t),s=!1},d(t){wt(e,t)}}}function ti(t){let e,n;return e=new Xo({props:{coords:t[1],$$slots:{default:[Zo]},$$scope:{ctx:t}}}),e.$on("cancel",t[2]),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,[n]){const s={};2&n&&(s.coords=t[1]),513&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function ei(t,e,n){let{coords:s}=e,{cancel:o=null}=e,{value:i=null}=e,{convert:r=!0}=e,{dateFormat:a="%d %M %Y"}=e;const c=W(),l=V("wx-i18n").getGroup("calendar");i="string"==typeof i?Nn(i,a,!0,Ds(l)):i||null;return t.$$set=t=>{"coords"in t&&n(1,s=t.coords),"cancel"in t&&n(3,o=t.cancel),"value"in t&&n(0,i=t.value),"convert"in t&&n(4,r=t.convert),"dateFormat"in t&&n(5,a=t.dateFormat)},[i,s,()=>{i?c("change",{value:r?En(i,a,Ds(l)):i}):o&&o()},o,r,a,function(t){i=t,n(0,i)}]}class ni extends St{constructor(t){super(),_t(this,t,ei,ti,h,{coords:1,cancel:3,value:0,convert:4,dateFormat:5})}}function si(t,e,n){const s=t.slice();return s[7]=e[n],s}const oi=t=>({item:1&t}),ii=t=>({item:t[7]});function ri(t,e){let n,s,o,i;const r=e[5].default,a=$(r,e,e[4],ii);return{key:t,first:null,c(){n=M("li"),a&&a.c(),s=P(),F(n,"class","wx-todo_list__item svelte-15dwoyv"),F(n,"data-list-id",o=e[7].id),z(n,"wx-todo_list__item--selected",ze(e[7].id,e[1])),this.first=n},m(t,e){j(t,n,e),a&&a.m(n,null),T(n,s),i=!0},p(t,s){e=t,a&&a.p&&(!i||17&s)&&x(a,r,e,e[4],i?v(r,e[4],s,oi):y(e[4]),ii),(!i||1&s&&o!==(o=e[7].id))&&F(n,"data-list-id",o),3&s&&z(n,"wx-todo_list__item--selected",ze(e[7].id,e[1]))},i(t){i||(ft(a,t),i=!0)},o(t){ht(a,t),i=!1},d(t){t&&C(n),a&&a.d(t)}}}function ai(t){let e,n,s,o,i=[],r=new Map,a=t[0];const c=t=>t[7].id;for(let e=0;e<a.length;e+=1){let n=si(t,a,e),s=c(n);r.set(s,i[e]=ri(s,n))}return{c(){e=M("ul");for(let t=0;t<i.length;t+=1)i[t].c();F(e,"class","wx-todo_list svelte-15dwoyv")},m(r,a){j(r,e,a);for(let t=0;t<i.length;t+=1)i[t].m(e,null);n=!0,s||(o=[N(window,"keydown",t[3]),N(e,"click",t[2])],s=!0)},p(t,[n]){19&n&&(a=t[0],ut(),i=kt(i,n,c,1,t,a,r,e,$t,ri,null,si),pt())},i(t){if(!n){for(let t=0;t<a.length;t+=1)ft(i[t]);n=!0}},o(t){for(let t=0;t<i.length;t+=1)ht(i[t]);n=!1},d(t){t&&C(e);for(let t=0;t<i.length;t+=1)i[t].d();s=!1,p(o)}}}function ci(t,e,n){let{$$slots:s={},$$scope:o}=e,{options:i=[]}=e,r=null;const a=W();return t.$$set=t=>{"options"in t&&n(0,i=t.options),"$$scope"in t&&n(4,o=t.$$scope)},[i,r,t=>{n(1,r=ds(t,"data-list-id")),a("click",{id:r})},t=>{const e=i.findIndex((t=>ze(t.id,r)));switch(t.code){case"ArrowUp":t.preventDefault(),n(1,r=He(r)?i[e-1]?.id:i.at(-1).id);break;case"ArrowDown":t.preventDefault(),n(1,r=He(r)?i[e+1]?.id:i[0].id);break;case"Enter":t.preventDefault(),a("click",{id:r})}},o,s]}class li extends St{constructor(t){super(),_t(this,t,ci,ai,h,{options:0})}}function di(t){let e,n,s,o="menu"===t[5].type&&ui(t),i="datepicker"===t[5].type&&hi(t);return{c(){o&&o.c(),e=P(),i&&i.c(),n=E()},m(t,r){o&&o.m(t,r),j(t,e,r),i&&i.m(t,r),j(t,n,r),s=!0},p(t,s){"menu"===t[5].type?o?(o.p(t,s),32&s&&ft(o,1)):(o=ui(t),o.c(),ft(o,1),o.m(e.parentNode,e)):o&&(ut(),ht(o,1,1,(()=>{o=null})),pt()),"datepicker"===t[5].type?i?(i.p(t,s),32&s&&ft(i,1)):(i=hi(t),i.c(),ft(i,1),i.m(n.parentNode,n)):i&&(ut(),ht(i,1,1,(()=>{i=null})),pt())},i(t){s||(ft(o),ft(i),s=!0)},o(t){ht(o),ht(i),s=!1},d(t){o&&o.d(t),t&&C(e),i&&i.d(t),t&&C(n)}}}function ui(t){let e,n;return e=new Xo({props:{coords:t[5].coords,$$slots:{default:[fi]},$$scope:{ctx:t}}}),e.$on("cancel",t[6]),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};32&n&&(s.coords=t[5].coords),2097184&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function pi(t){let e,n;return e=new vo({props:{item:t[20]}}),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};1048576&n&&(s.item=t[20]),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function fi(t){let e,n;return e=new li({props:{options:t[5].options,$$slots:{default:[pi,({item:t})=>({20:t}),({item:t})=>t?1048576:0]},$$scope:{ctx:t}}}),e.$on("click",t[10]),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};32&n&&(s.options=t[5].options),3145728&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function hi(t){let e,n;return e=new ni({props:{dateFormat:t[2].date.format,coords:t[5].coords,cancel:t[7],value:t[3].targetDate}}),e.$on("change",t[11]),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};4&n&&(s.dateFormat=t[2].date.format),32&n&&(s.coords=t[5].coords),8&n&&(s.value=t[3].targetDate),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function mi(t){let e,n,s,o,i,r,a,c=t[5]&&di(t);return{c(){e=M("div"),n=D(t[0]),s=P(),c&&c.c(),o=E(),F(e,"class","wx-todo_editor svelte-124gm4f"),F(e,"contenteditable","true"),F(e,"data-placeholder",t[1]),F(e,"tabindex","0")},m(l,d){j(l,e,d),T(e,n),t[13](e),j(l,s,d),c&&c.m(l,d),j(l,o,d),i=!0,r||(a=[N(e,"input",t[8]),N(e,"keyup",t[9])],r=!0)},p(t,[s]){(!i||1&s)&&L(n,t[0]),(!i||2&s)&&F(e,"data-placeholder",t[1]),t[5]?c?(c.p(t,s),32&s&&ft(c,1)):(c=di(t),c.c(),ft(c,1),c.m(o.parentNode,o)):c&&(ut(),ht(c,1,1,(()=>{c=null})),pt())},i(t){i||(ft(c),i=!0)},o(t){ht(c),i=!1},d(n){n&&C(e),t[13](null),n&&C(s),c&&c.d(n),n&&C(o),r=!1,p(a)}}}function gi(t,e,n){let s,{value:o=""}=e,{placeholder:i=""}=e,{tags:r=[]}=e,{shape:a}=e,{editor:c}=e,l=null,d=null,u=null;const p=W();function f(t){const{x:e,y:n}=function(){const t=window.getSelection().getRangeAt(0).getBoundingClientRect();return{x:t.x,y:t.y}}();p("editing",{value:d,dropdown:{type:t,coords:{x:e+window.scrollX,y:n+window.scrollY+20},options:"menu"===t?Is(r,""):[]},targetDate:c.targetDate})}function h(){p("editing",{dropdown:null,value:d})}function m(t,e,s){const o=t[u+1],i=t;if(e=s+e,o)if(Be(o)){const n=new RegExp(String.raw`${s}\s`,"gm");t=t.replace(n,((t,n)=>n===u?`${e} `:t))}else if("!"===s){const n=new RegExp(/!\((.+?)\)/gm);t=t.replace(n,((t,n,s)=>s===u?e:t))}else t=t.replace(tn(s),((t,n)=>n===u?e:t));else t+=e.substring(1);d=t,n(4,l.innerHTML=Zn(t),l),us(l,u+(i!==d?e.length:1)),h()}return J((function(){d=o,c.targetDate?(u=d.indexOf(c.targetDate)-2,us(l,u),f("datepicker")):us(l)})),t.$$set=t=>{"value"in t&&n(0,o=t.value),"placeholder"in t&&n(1,i=t.placeholder),"tags"in t&&n(12,r=t.tags),"shape"in t&&n(2,a=t.shape),"editor"in t&&n(3,c=t.editor)},t.$$.update=()=>{8&t.$$.dirty&&n(5,s=c?.dropdown)},[o,i,a,c,l,s,h,function(){m(d,"","!"),h()},function(){d=l?.textContent||"",p("editing",{value:d,dropdown:c.dropdown})},function(t){if("Enter"===t.code)return;const e="#",n="!",s=function(t){const e=window.getSelection(),n=document.createRange();return n.setStart(t,0),n.setEnd(e.anchorNode,e.anchorOffset),n.toString().length}(l)-1,o=d[s],i=d[s-1],a=!He(i)||Be(i),m=(o===e||t.key===e)&&a,g=(o===n||t.key===n)&&a;if(m)f("menu"),u=s;else if(g)f("datepicker"),u=s;else if(c.dropdown){const t=[],n=new RegExp(/^\s*$/gm);for(let o=s;o>0;o--){const s=d[o];if(s===e){const e=t.reverse().join(""),n=Is(r,e);if(!n.length)break;return void p("editing",{dropdown:{...c.dropdown,options:n},value:d})}if(t.push(s),n.test(s))break}h()}},function(t){const e=t.detail.id;He(e)?m(d,e.substring(1),"#"):h()},function(t){const e=t.detail.value;m(d,`(${e})`,"!")},r,function(t){X[t?"unshift":"push"]((()=>{l=t,n(4,l)}))}]}class $i extends St{constructor(t){super(),_t(this,t,gi,mi,h,{value:0,placeholder:1,tags:12,shape:2,editor:3})}}function ki(t){let e,n,s,o,i,r,a,c,l;function d(t,e){return t[0]instanceof Date?xi:vi}n=new fo({props:{name:"calendar",css:t[4],size:14}});let u=d(t),p=u(t),f=t[1]&&yi(t);return{c(){e=M("div"),xt(n.$$.fragment),s=P(),o=M("span"),p.c(),r=P(),f&&f.c(),F(o,"class",i=_(t[4])+" svelte-si3fkt"),F(e,"class","wx-todo_due-date svelte-si3fkt"),z(e,"completed",t[3])},m(i,d){j(i,e,d),yt(n,e,null),T(e,s),T(e,o),p.m(o,null),T(e,r),f&&f.m(e,null),a=!0,c||(l=N(e,"click",t[7]),c=!0)},p(t,s){const r={};16&s&&(r.css=t[4]),n.$set(r),u===(u=d(t))&&p?p.p(t,s):(p.d(1),p=u(t),p&&(p.c(),p.m(o,null))),(!a||16&s&&i!==(i=_(t[4])+" svelte-si3fkt"))&&F(o,"class",i),t[1]?f?(f.p(t,s),2&s&&ft(f,1)):(f=yi(t),f.c(),ft(f,1),f.m(e,null)):f&&(ut(),ht(f,1,1,(()=>{f=null})),pt()),8&s&&z(e,"completed",t[3])},i(t){a||(ft(n.$$.fragment,t),ft(f),a=!0)},o(t){ht(n.$$.fragment,t),ht(f),a=!1},d(t){t&&C(e),wt(n),p.d(),f&&f.d(),c=!1,l()}}}function vi(t){let e,n=t[5]("Set due date")+"";return{c(){e=D(n)},m(t,n){j(t,e,n)},p:c,d(t){t&&C(e)}}}function xi(t){let e,n=En(t[0],t[2],Ds(t[6]))+"";return{c(){e=D(n)},m(t,n){j(t,e,n)},p(t,s){5&s&&n!==(n=En(t[0],t[2],Ds(t[6]))+"")&&L(e,n)},d(t){t&&C(e)}}}function yi(t){let e,n;return e=new It({props:{width:"fit-content",cancel:t[8],$$slots:{default:[wi]},$$scope:{ctx:t}}}),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};32769&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function wi(t){let e,n,s;function o(e){t[13](e)}let i={cancel:t[9]};return void 0!==t[0]&&(i.value=t[0]),e=new ue({props:i}),X.push((()=>vt(e,"value",o))),{c(){xt(e.$$.fragment)},m(t,n){yt(e,t,n),s=!0},p(t,s){const o={};!n&&1&s&&(n=!0,o.value=t[0],ot((()=>n=!1))),e.$set(o)},i(t){s||(ft(e.$$.fragment,t),s=!0)},o(t){ht(e.$$.fragment,t),s=!1},d(t){wt(e,t)}}}function bi(t){let e,n,s=t[0]&&ki(t);return{c(){s&&s.c(),e=E()},m(t,o){s&&s.m(t,o),j(t,e,o),n=!0},p(t,[n]){t[0]?s?(s.p(t,n),1&n&&ft(s,1)):(s=ki(t),s.c(),ft(s,1),s.m(e.parentNode,e)):s&&(ut(),ht(s,1,1,(()=>{s=null})),pt())},i(t){n||(ft(s),n=!0)},o(t){ht(s),n=!1},d(t){s&&s.d(t),t&&C(e)}}}function _i(t,e,n){let{id:s}=e,{format:o="%d %M %Y"}=e,{value:i=null}=e,{validate:r=!0}=e,{completed:a=!1}=e,{open:c=!1}=e,{readonly:l=!1}=e;const d=V("wx-i18n").getGroup("todo"),u=V("wx-i18n").getGroup("calendar"),p=W();let f="wx-todo_date";const h=()=>{n(1,c=!1),p("action",{action:"set-state-due-date",data:{open:!1,id:s}})};return t.$$set=t=>{"id"in t&&n(10,s=t.id),"format"in t&&n(2,o=t.format),"value"in t&&n(0,i=t.value),"validate"in t&&n(11,r=t.validate),"completed"in t&&n(3,a=t.completed),"open"in t&&n(1,c=t.open),"readonly"in t&&n(12,l=t.readonly)},t.$$.update=()=>{2053&t.$$.dirty&&i&&("string"==typeof i&&n(0,i=Nn(i,o,!1,Ds(u))),i?.getTime()||n(0,i=null),r&&i instanceof Date&&n(4,f=function(t){const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),s=new Date(t.getFullYear(),t.getMonth(),t.getDate());return n.getTime()<=s.getTime()}(i)?"wx-todo_date--current":"wx-todo_date--expired"))},[i,c,o,a,f,d,u,()=>{l||(n(1,c=!0),p("action",{action:"set-state-due-date",data:{open:!0,id:s}}))},h,()=>{p("action",{action:"update-task",data:{id:s,task:{due_date:i||null}}}),h()},s,r,l,function(t){i=t,n(0,i),n(2,o),n(11,r)}]}class Si extends St{constructor(t){super(),_t(this,t,_i,bi,h,{id:10,format:2,value:0,validate:11,completed:3,open:1,readonly:12})}}function Ti(t){let e;return{c(){e=M("div"),F(e,"class","wx-todo_list__priority-label svelte-12quozm"),O(e,"background",t[0][t[1].priority]?.color)},m(t,n){j(t,e,n)},p(t,n){3&n&&O(e,"background",t[0][t[1].priority]?.color)},d(t){t&&C(e)}}}function ji(t){let e;return{c(){e=M("div"),F(e,"class","wx-todo_list__priority-cover svelte-12quozm"),O(e,"background",t[0][t[1].priority]?.color)},m(t,n){j(t,e,n)},p(t,n){3&n&&O(e,"background",t[0][t[1].priority]?.color)},d(t){t&&C(e)}}}function Ci(t){let e,n,s=t[2]?.label&&Ti(t),o=t[2]?.cover&&ji(t);return{c(){e=M("div"),s&&s.c(),n=P(),o&&o.c(),F(e,"class","wx-todo_list__priority svelte-12quozm")},m(t,i){j(t,e,i),s&&s.m(e,null),T(e,n),o&&o.m(e,null)},p(t,[i]){t[2]?.label?s?s.p(t,i):(s=Ti(t),s.c(),s.m(e,n)):s&&(s.d(1),s=null),t[2]?.cover?o?o.p(t,i):(o=ji(t),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},i:c,o:c,d(t){t&&C(e),s&&s.d(),o&&o.d()}}}function Ii(t,e,n){let{priority:s}=e,{task:o}=e,{config:i}=e;return t.$$set=t=>{"priority"in t&&n(0,s=t.priority),"task"in t&&n(1,o=t.task),"config"in t&&n(2,i=t.config)},[s,o,i]}class Mi extends St{constructor(t){super(),_t(this,t,Ii,Ci,h,{priority:0,task:1,config:2})}}function Di(t,e,n){const s=t.slice();return s[47]=e[n],s[49]=n,s}function Pi(t){let e,n,s;return n=new Jo({props:{circle:!0,$$slots:{default:[Ei]},$$scope:{ctx:t}}}),n.$on("click",t[28]),{c(){e=M("div"),xt(n.$$.fragment),F(e,"class","wx-todo_list-toggle-button svelte-p6km7j")},m(t,o){j(t,e,o),yt(n,e,null),s=!0},p(t,e){const s={};1&e[0]|524288&e[1]&&(s.$$scope={dirty:e,ctx:t}),n.$set(s)},i(t){s||(ft(n.$$.fragment,t),s=!0)},o(t){ht(n.$$.fragment,t),s=!1},d(t){t&&C(e),wt(n)}}}function Ei(t){let e,n;return e=new fo({props:{name:t[0].collapsed?"menu-right":"menu-down"}}),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};1&n[0]&&(s.name=t[0].collapsed?"menu-right":"menu-down"),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function Ni(t){let e,n;return e=new Mi({props:{priority:t[12],task:t[0],config:t[15]?.priority}}),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};4096&n[0]&&(s.priority=t[12]),1&n[0]&&(s.task=t[0]),32768&n[0]&&(s.config=t[15]?.priority),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function Ai(t){let e,n;return e=new Uo({props:{value:t[0].text||"",completed:t[0].checked,filter:t[17]}}),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};1&n[0]&&(s.value=t[0].text||""),1&n[0]&&(s.completed=t[0].checked),131072&n[0]&&(s.filter=t[17]),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function Fi(t){let e,n;return e=new $i({props:{value:t[0].text||"",placeholder:t[18]("Type what you want"),shape:t[15],editor:t[3],tags:t[16]}}),e.$on("editing",t[29]),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};1&n[0]&&(s.value=t[0].text||""),32768&n[0]&&(s.shape=t[15]),8&n[0]&&(s.editor=t[3]),65536&n[0]&&(s.tags=t[16]),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function Li(t){let e;function n(t,e){return"number"===t[0].counter.type?Oi:"percentage"===t[0].counter.type?Ri:void 0}let s=n(t),o=s&&s(t);return{c(){e=M("div"),o&&o.c(),F(e,"class","wx-todo_list__counter svelte-p6km7j")},m(t,n){j(t,e,n),o&&o.m(e,null)},p(t,i){s===(s=n(t))&&o?o.p(t,i):(o&&o.d(1),o=s&&s(t),o&&(o.c(),o.m(e,null)))},d(t){t&&C(e),o&&o.d()}}}function Ri(t){let e,n,s=Math.round(t[0].counter.done/t[0].counter.total*100)+"";return{c(){e=D(s),n=D("%")},m(t,s){j(t,e,s),j(t,n,s)},p(t,n){1&n[0]&&s!==(s=Math.round(t[0].counter.done/t[0].counter.total*100)+"")&&L(e,s)},d(t){t&&C(e),t&&C(n)}}}function Oi(t){let e,n,s,o=t[0].counter.done+"",i=t[0].counter.total+"";return{c(){e=D(o),n=D("/"),s=D(i)},m(t,o){j(t,e,o),j(t,n,o),j(t,s,o)},p(t,n){1&n[0]&&o!==(o=t[0].counter.done+"")&&L(e,o),1&n[0]&&i!==(i=t[0].counter.total+"")&&L(s,i)},d(t){t&&C(e),t&&C(n),t&&C(s)}}}function zi(t){let e,n,s,o,i=t[10],r=[];for(let e=0;e<i.length;e+=1)r[e]=Yi(Di(t,i,e));const a=t=>ht(r[t],1,1,(()=>{r[t]=null}));let c=t[10].length>3&&qi(t);return{c(){e=M("div");for(let t=0;t<r.length;t+=1)r[t].c();n=P(),c&&c.c(),F(e,"class","wx-todo_user-menu svelte-p6km7j"),O(e,"width",(t[10].length>=3?60:16*t[10].length+14)+"px"),F(e,"data-user-menu-id",s=t[0].id)},m(s,i){j(s,e,i);for(let t=0;t<r.length;t+=1)r[t].m(e,null);T(e,n),c&&c.m(e,null),t[43](e),o=!0},p(t,l){if(1024&l[0]){let s;for(i=t[10],s=0;s<i.length;s+=1){const o=Di(t,i,s);r[s]?(r[s].p(o,l),ft(r[s],1)):(r[s]=Yi(o),r[s].c(),ft(r[s],1),r[s].m(e,n))}for(ut(),s=i.length;s<r.length;s+=1)a(s);pt()}t[10].length>3?c?(c.p(t,l),1024&l[0]&&ft(c,1)):(c=qi(t),c.c(),ft(c,1),c.m(e,null)):c&&(ut(),ht(c,1,1,(()=>{c=null})),pt()),(!o||1024&l[0])&&O(e,"width",(t[10].length>=3?60:16*t[10].length+14)+"px"),(!o||1&l[0]&&s!==(s=t[0].id))&&F(e,"data-user-menu-id",s)},i(t){if(!o){for(let t=0;t<i.length;t+=1)ft(r[t]);ft(c),o=!0}},o(t){r=r.filter(Boolean);for(let t=0;t<r.length;t+=1)ht(r[t]);ht(c),o=!1},d(n){n&&C(e),I(r,n),c&&c.d(),t[43](null)}}}function Hi(t){let e,n,s;return n=new wo({props:{color:t[47].color,avatar:t[47].avatar}}),{c(){e=M("div"),xt(n.$$.fragment),F(e,"class","wx-todo_user-menu__avatar svelte-p6km7j"),O(e,"left",16*t[49]+"px")},m(t,o){j(t,e,o),yt(n,e,null),s=!0},p(t,e){const s={};1024&e[0]&&(s.color=t[47].color),1024&e[0]&&(s.avatar=t[47].avatar),n.$set(s)},i(t){s||(ft(n.$$.fragment,t),s=!0)},o(t){ht(n.$$.fragment,t),s=!1},d(t){t&&C(e),wt(n)}}}function Yi(t){let e,n,s=(3===t[10].length&&t[49]<3||t[49]<2)&&Hi(t);return{c(){s&&s.c(),e=E()},m(t,o){s&&s.m(t,o),j(t,e,o),n=!0},p(t,n){3===t[10].length&&t[49]<3||t[49]<2?s?(s.p(t,n),1024&n[0]&&ft(s,1)):(s=Hi(t),s.c(),ft(s,1),s.m(e.parentNode,e)):s&&(ut(),ht(s,1,1,(()=>{s=null})),pt())},i(t){n||(ft(s),n=!0)},o(t){ht(s),n=!1},d(t){s&&s.d(t),t&&C(e)}}}function qi(t){let e,n,s;return n=new wo({props:{value:"+"+(t[10].length-2)}}),{c(){e=M("div"),xt(n.$$.fragment),F(e,"class","wx-todo_user-menu__avatar svelte-p6km7j"),O(e,"left","32px")},m(t,o){j(t,e,o),yt(n,e,null),s=!0},p(t,e){const s={};1024&e[0]&&(s.value="+"+(t[10].length-2)),n.$set(s)},i(t){s||(ft(n.$$.fragment,t),s=!0)},o(t){ht(n.$$.fragment,t),s=!1},d(t){t&&C(e),wt(n)}}}function Bi(t){let e,n,s,o;return n=new fo({props:{name:"dots-v"}}),{c(){e=M("button"),xt(n.$$.fragment),F(e,"data-menu-id",s=t[0].id),F(e,"class","wx-todo_list-menu-button svelte-p6km7j")},m(s,i){j(s,e,i),yt(n,e,null),t[44](e),o=!0},p(t,n){(!o||1&n[0]&&s!==(s=t[0].id))&&F(e,"data-menu-id",s)},i(t){o||(ft(n.$$.fragment,t),o=!0)},o(t){ht(n.$$.fragment,t),o=!1},d(s){s&&C(e),wt(n),t[44](null)}}}function Ji(t){let e,n,s,o="user"===t[2].type&&Gi(t),i="task"===t[2].type&&Wi(t);return{c(){o&&o.c(),e=P(),i&&i.c(),n=E()},m(t,r){o&&o.m(t,r),j(t,e,r),i&&i.m(t,r),j(t,n,r),s=!0},p(t,s){"user"===t[2].type?o?(o.p(t,s),4&s[0]&&ft(o,1)):(o=Gi(t),o.c(),ft(o,1),o.m(e.parentNode,e)):o&&(ut(),ht(o,1,1,(()=>{o=null})),pt()),"task"===t[2].type?i?(i.p(t,s),4&s[0]&&ft(i,1)):(i=Wi(t),i.c(),ft(i,1),i.m(n.parentNode,n)):i&&(ut(),ht(i,1,1,(()=>{i=null})),pt())},i(t){s||(ft(o),ft(i),s=!0)},o(t){ht(o),ht(i),s=!1},d(t){o&&o.d(t),t&&C(e),i&&i.d(t),t&&C(n)}}}function Gi(t){let e,n;return e=new Ro({props:{options:t[10],parent:t[6]}}),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};1024&n[0]&&(s.options=t[10]),64&n[0]&&(s.parent=t[6]),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function Wi(t){let e,n;return e=new Ro({props:{options:t[11],parent:t[7]}}),e.$on("click",t[30]),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};2048&n[0]&&(s.options=t[11]),128&n[0]&&(s.parent=t[7]),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function Ui(t){let e,n,s,o,i,r,a,c,l,d,u,p,f,h,m,g,$,k,v,x,y,w,b=t[2]&&ze(t[2].id,t[0].id),_=t[4]&&Pi(t);o=new Yo({props:{checked:t[0].checked}}),o.$on("change",t[27]);let S=t[0]?.priority&&Ni(t);const I=[Fi,Ai],D=[];function N(t,e){return t[8]&&!t[14]?0:1}l=N(t),d=D[l]=I[l](t),p=new Si({props:{id:t[0].id,open:t[13]?.open&&ze(t[0].id,t[13]?.id),format:t[15]?.date?.format,validate:t[15]?.date?.validate,completed:t[0].checked,value:t[0].due_date,readonly:t[14]}}),p.$on("action",t[42]);let A=t[4]&&Li(t),L=t[10]?.length&&zi(t),R=!t[14]&&Bi(t),H=b&&Ji(t);return{c(){e=M("div"),n=M("div"),_&&_.c(),s=P(),xt(o.$$.fragment),i=P(),r=M("div"),S&&S.c(),a=P(),c=M("div"),d.c(),u=P(),xt(p.$$.fragment),h=P(),m=M("div"),A&&A.c(),g=P(),L&&L.c(),$=P(),R&&R.c(),x=P(),H&&H.c(),y=E(),F(n,"class","wx-todo_list__controls wx-todo_list__controls-manual svelte-p6km7j"),F(c,"class","wx-todo_list__text svelte-p6km7j"),F(r,"class","wx-todo_list__content svelte-p6km7j"),F(r,"data-list-editor-id",f=t[0].id),F(m,"class","wx-todo_list__controls svelte-p6km7j"),F(e,"tabindex","0"),F(e,"data-list-level",t[1]),F(e,"data-list-id",k=t[0].id),F(e,"data-drag-list-id",v=t[0].id),F(e,"class","wx-todo_list svelte-p6km7j"),O(e,"padding-left",t[9]+"px"),z(e,"wx-todo_list--selected",t[0].selected&&!t[8]),z(e,"wx-todo_list--draggable",t[0].draggable&&!t[8])},m(d,f){j(d,e,f),T(e,n),_&&_.m(n,null),T(n,s),yt(o,n,null),T(e,i),T(e,r),S&&S.m(r,null),T(r,a),T(r,c),D[l].m(c,null),T(r,u),yt(p,r,null),T(e,h),T(e,m),A&&A.m(m,null),T(m,g),L&&L.m(m,null),T(m,$),R&&R.m(m,null),t[45](e),j(d,x,f),H&&H.m(d,f),j(d,y,f),w=!0},p(t,i){t[4]?_?(_.p(t,i),16&i[0]&&ft(_,1)):(_=Pi(t),_.c(),ft(_,1),_.m(n,s)):_&&(ut(),ht(_,1,1,(()=>{_=null})),pt());const u={};1&i[0]&&(u.checked=t[0].checked),o.$set(u),t[0]?.priority?S?(S.p(t,i),1&i[0]&&ft(S,1)):(S=Ni(t),S.c(),ft(S,1),S.m(r,a)):S&&(ut(),ht(S,1,1,(()=>{S=null})),pt());let h=l;l=N(t),l===h?D[l].p(t,i):(ut(),ht(D[h],1,1,(()=>{D[h]=null})),pt(),d=D[l],d?d.p(t,i):(d=D[l]=I[l](t),d.c()),ft(d,1),d.m(c,null));const x={};1&i[0]&&(x.id=t[0].id),8193&i[0]&&(x.open=t[13]?.open&&ze(t[0].id,t[13]?.id)),32768&i[0]&&(x.format=t[15]?.date?.format),32768&i[0]&&(x.validate=t[15]?.date?.validate),1&i[0]&&(x.completed=t[0].checked),1&i[0]&&(x.value=t[0].due_date),16384&i[0]&&(x.readonly=t[14]),p.$set(x),(!w||1&i[0]&&f!==(f=t[0].id))&&F(r,"data-list-editor-id",f),t[4]?A?A.p(t,i):(A=Li(t),A.c(),A.m(m,g)):A&&(A.d(1),A=null),t[10]?.length?L?(L.p(t,i),1024&i[0]&&ft(L,1)):(L=zi(t),L.c(),ft(L,1),L.m(m,$)):L&&(ut(),ht(L,1,1,(()=>{L=null})),pt()),t[14]?R&&(ut(),ht(R,1,1,(()=>{R=null})),pt()):R?(R.p(t,i),16384&i[0]&&ft(R,1)):(R=Bi(t),R.c(),ft(R,1),R.m(m,null)),(!w||2&i[0])&&F(e,"data-list-level",t[1]),(!w||1&i[0]&&k!==(k=t[0].id))&&F(e,"data-list-id",k),(!w||1&i[0]&&v!==(v=t[0].id))&&F(e,"data-drag-list-id",v),(!w||512&i[0])&&O(e,"padding-left",t[9]+"px"),257&i[0]&&z(e,"wx-todo_list--selected",t[0].selected&&!t[8]),257&i[0]&&z(e,"wx-todo_list--draggable",t[0].draggable&&!t[8]),5&i[0]&&(b=t[2]&&ze(t[2].id,t[0].id)),b?H?(H.p(t,i),5&i[0]&&ft(H,1)):(H=Ji(t),H.c(),ft(H,1),H.m(y.parentNode,y)):H&&(ut(),ht(H,1,1,(()=>{H=null})),pt())},i(t){w||(ft(_),ft(o.$$.fragment,t),ft(S),ft(d),ft(p.$$.fragment,t),ft(L),ft(R),ft(H),w=!0)},o(t){ht(_),ht(o.$$.fragment,t),ht(S),ht(d),ht(p.$$.fragment,t),ht(L),ht(R),ht(H),w=!1},d(n){n&&C(e),_&&_.d(),wt(o),S&&S.d(),D[l].d(),wt(p),A&&A.d(),L&&L.d(),R&&R.d(),t[45](null),n&&C(x),H&&H.d(n),n&&C(y)}}}function Vi(t,e,n){let s,o,i,r,a,c,l,d,u,p,f,h,m,$,k,v,x,y,w,b,_,S;const T=W(),j=V("wx-i18n").getGroup("todo");let{store:C}=e,{api:I}=e,{task:M}=e,{level:D=0}=e,P=null,E=null,N=null;const{stateDueDate:A,stateEditableItem:F,menu:L,filter:R,tags:O,taskShape:z,readonly:H,priorityMap:Y}=C;return g(t,A,(t=>n(35,v=t))),g(t,F,(t=>n(41,S=t))),g(t,L,(t=>n(40,_=t))),g(t,R,(t=>n(39,b=t))),g(t,O,(t=>n(38,w=t))),g(t,z,(t=>n(37,y=t))),g(t,H,(t=>n(36,x=t))),g(t,Y,(t=>n(34,k=t))),M.selected&&J((()=>P?.focus())),t.$$set=t=>{"store"in t&&n(31,C=t.store),"api"in t&&n(32,I=t.api),"task"in t&&n(0,M=t.task),"level"in t&&n(1,D=t.level)},t.$$.update=()=>{1024&t.$$.dirty[1]&&n(3,s=S),512&t.$$.dirty[1]&&n(2,o=_),256&t.$$.dirty[1]&&n(17,i=b),128&t.$$.dirty[1]&&n(16,r=w),64&t.$$.dirty[1]&&n(15,a=y),32&t.$$.dirty[1]&&n(14,c=x),16&t.$$.dirty[1]&&n(13,l=v),8&t.$$.dirty[1]&&n(12,d=k),4&t.$$.dirty[0]&&n(11,u=Ms(o?.options||[],j)),1&t.$$.dirty[0]&&n(10,p=Ms(M?.availableUsers,j)),1&t.$$.dirty[0]&&n(4,f=M?.children?.length),16&t.$$.dirty[0]&&n(33,h=f?16:40),2&t.$$.dirty[0]|4&t.$$.dirty[1]&&n(9,m=h+(D>1?24*(D-1):0)),9&t.$$.dirty[0]&&n(8,$="task"===s?.type&&ze(s?.id,M.id))},[M,D,o,s,f,P,E,N,$,m,p,u,d,l,c,a,r,i,j,A,F,L,R,O,z,H,Y,function(){M?.checked?I.in.exec("uncheck-task",{id:M.id}):ps({store:I,id:M.id})},function(){T("action",{action:M.collapsed?"expand-task":"collapse-task",data:{id:M.id}})},function(t){const{value:e,dropdown:n,targetDate:s}=t.detail;T("action",{action:"edit-item",data:{id:M.id,currentValue:e,dropdown:n,targetDate:s}})},function(t){const e=t.detail.action?.id??t.detail.action;T("action",{action:"click-menu-item",data:{id:o.id,action:e,type:"task"}})},C,I,h,k,v,x,y,w,b,_,S,function(e){K.call(this,t,e)},function(t){X[t?"unshift":"push"]((()=>{E=t,n(6,E)}))},function(t){X[t?"unshift":"push"]((()=>{N=t,n(7,N)}))},function(t){X[t?"unshift":"push"]((()=>{P=t,n(5,P)}))}]}class Ki extends St{constructor(t){super(),_t(this,t,Vi,Ui,h,{store:31,api:32,task:0,level:1},null,[-1,-1])}}function Qi(t){let e,n;return{c(){e=M("div"),n=M("div"),F(n,"class","wx-todo_separator__line svelte-y9zbw4"),F(e,"class","wx-todo_separator svelte-y9zbw4"),O(e,"padding",t[0]),F(e,"data-separator",!0)},m(t,s){j(t,e,s),T(e,n)},p(t,[n]){1&n&&O(e,"padding",t[0])},i:c,o:c,d(t){t&&C(e)}}}function Xi(t,e,n){let{padding:s="6px 16px"}=e;return t.$$set=t=>{"padding"in t&&n(0,s=t.padding)},[s]}class Zi extends St{constructor(t){super(),_t(this,t,Xi,Qi,h,{padding:0})}}function tr(t,e,n){const s=t.slice();return s[12]=e[n],s}function er(t){let e,n,s,o,i,r,a;n=new Ki({props:{store:t[0],api:t[1],task:t[12],level:t[3]+1}}),n.$on("action",t[10]);const c=t[9].default,l=$(c,t,t[8],null);let d=t[12].children.length&&!t[12].collapsed&&nr(t),u=0===t[3]&&sr();return{c(){e=M("li"),xt(n.$$.fragment),s=P(),l&&l.c(),o=P(),d&&d.c(),i=P(),u&&u.c(),r=P(),F(e,"class","wx-todo_tree__row svelte-15zeydw")},m(t,c){j(t,e,c),yt(n,e,null),T(e,s),l&&l.m(e,null),T(e,o),d&&d.m(e,null),T(e,i),u&&u.m(e,null),T(e,r),a=!0},p(t,s){const o={};1&s&&(o.store=t[0]),2&s&&(o.api=t[1]),4&s&&(o.task=t[12]),8&s&&(o.level=t[3]+1),n.$set(o),l&&l.p&&(!a||256&s)&&x(l,c,t,t[8],a?v(c,t[8],s,null):y(t[8]),null),t[12].children.length&&!t[12].collapsed?d?(d.p(t,s),4&s&&ft(d,1)):(d=nr(t),d.c(),ft(d,1),d.m(e,i)):d&&(ut(),ht(d,1,1,(()=>{d=null})),pt()),0===t[3]?u?8&s&&ft(u,1):(u=sr(),u.c(),ft(u,1),u.m(e,r)):u&&(ut(),ht(u,1,1,(()=>{u=null})),pt())},i(t){a||(ft(n.$$.fragment,t),ft(l,t),ft(d),ft(u),a=!0)},o(t){ht(n.$$.fragment,t),ht(l,t),ht(d),ht(u),a=!1},d(t){t&&C(e),wt(n),l&&l.d(t),d&&d.d(),u&&u.d()}}}function nr(t){let e,n;return e=new ar({props:{store:t[0],api:t[1],level:t[3]+1,data:t[12].children}}),e.$on("action",t[11]),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};1&n&&(s.store=t[0]),2&n&&(s.api=t[1]),8&n&&(s.level=t[3]+1),4&n&&(s.data=t[12].children),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function sr(t){let e,n;return e=new Zi({}),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function or(t,e){let n,s,o,i=!(e[5]&&e[12].checked)&&er(e);return{key:t,first:null,c(){n=E(),i&&i.c(),s=E(),this.first=n},m(t,e){j(t,n,e),i&&i.m(t,e),j(t,s,e),o=!0},p(t,n){(e=t)[5]&&e[12].checked?i&&(ut(),ht(i,1,1,(()=>{i=null})),pt()):i?(i.p(e,n),36&n&&ft(i,1)):(i=er(e),i.c(),ft(i,1),i.m(s.parentNode,s))},i(t){o||(ft(i),o=!0)},o(t){ht(i),o=!1},d(t){t&&C(n),i&&i.d(t),t&&C(s)}}}function ir(t){let e,n,s=[],o=new Map,i=t[2];const r=t=>t[12].id;for(let e=0;e<i.length;e+=1){let n=tr(t,i,e),a=r(n);o.set(a,s[e]=or(a,n))}return{c(){e=M("ul");for(let t=0;t<s.length;t+=1)s[t].c();F(e,"class","wx-todo_tree svelte-15zeydw"),F(e,"data-todo-wrapper-id",t[4]),z(e,"wx-todo_tree--root",!t[3])},m(t,o){j(t,e,o);for(let t=0;t<s.length;t+=1)s[t].m(e,null);n=!0},p(t,[a]){303&a&&(i=t[2],ut(),s=kt(s,a,r,1,t,i,o,e,$t,or,null,tr),pt()),(!n||16&a)&&F(e,"data-todo-wrapper-id",t[4]),8&a&&z(e,"wx-todo_tree--root",!t[3])},i(t){if(!n){for(let t=0;t<i.length;t+=1)ft(s[t]);n=!0}},o(t){for(let t=0;t<s.length;t+=1)ht(s[t]);n=!1},d(t){t&&C(e);for(let t=0;t<s.length;t+=1)s[t].d()}}}function rr(t,e,n){let s,o,{$$slots:i={},$$scope:r}=e,{store:a}=e,{api:c}=e,{data:l}=e,{level:d=0}=e,{id:u}=e;const p=a.taskShape;return g(t,p,(t=>n(7,o=t))),t.$$set=t=>{"store"in t&&n(0,a=t.store),"api"in t&&n(1,c=t.api),"data"in t&&n(2,l=t.data),"level"in t&&n(3,d=t.level),"id"in t&&n(4,u=t.id),"$$scope"in t&&n(8,r=t.$$scope)},t.$$.update=()=>{128&t.$$.dirty&&n(5,s=o?.completed?.taskHide)},[a,c,l,d,u,s,p,o,r,i,function(e){K.call(this,t,e)},function(e){K.call(this,t,e)}]}class ar extends St{constructor(t){super(),_t(this,t,rr,ir,h,{store:0,api:1,data:2,level:3,id:4})}}function cr(t){let e,n;return e=new ar({props:{data:t[2],id:t[3],store:t[0],api:t[1]}}),e.$on("action",t[6]),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,[n]){const s={};4&n&&(s.data=t[2]),8&n&&(s.id=t[3]),1&n&&(s.store=t[0]),2&n&&(s.api=t[1]),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function lr(t,e,n){let s,o,{store:i}=e,{api:r}=e;const a=i.treeTasks;g(t,a,(t=>n(2,s=t)));const c=i.id;return g(t,c,(t=>n(3,o=t))),t.$$set=t=>{"store"in t&&n(0,i=t.store),"api"in t&&n(1,r=t.api)},[i,r,s,o,a,c,function(e){K.call(this,t,e)}]}class dr extends St{constructor(t){super(),_t(this,t,lr,cr,h,{store:0,api:1})}}function ur(t){let e,n,s,o,i,r;return s=new fo({props:{name:"plus",size:16}}),{c(){e=M("div"),n=M("div"),xt(s.$$.fragment),o=P(),i=M("span"),i.textContent=`${t[1]("Add task")}`,F(n,"class","wx-todo_button-add__icon svelte-1c08e70"),F(i,"class","wx-todo_button-add__text svelte-1c08e70"),F(e,"class","wx-todo_button-add__content svelte-1c08e70")},m(t,a){j(t,e,a),T(e,n),yt(s,n,null),T(e,o),T(e,i),r=!0},p:c,i(t){r||(ft(s.$$.fragment,t),r=!0)},o(t){ht(s.$$.fragment,t),r=!1},d(t){t&&C(e),wt(s)}}}function pr(t){let e;return{c(){e=M("mark"),e.textContent=`${window.atob("VHJpYWw=")}`,F(e,"class","wx-todo_mark svelte-1c08e70"),z(e,"wx-todo_mark--error",0<new Date)},m(t,n){j(t,e,n)},p(t,n){0&n&&z(e,"wx-todo_mark--error",0<new Date)},d(t){t&&C(e)}}}function fr(t){let e,n,s,o,i,r,a=!1;n=new Jo({props:{height:36,width:"100%",$$slots:{default:[ur]},$$scope:{ctx:t}}}),n.$on("click",t[2]),o=new Zi({});let c=a&&pr();return{c(){e=M("div"),xt(n.$$.fragment),s=P(),xt(o.$$.fragment),i=P(),c&&c.c(),F(e,"class","wx-todo_button-add svelte-1c08e70")},m(t,a){j(t,e,a),yt(n,e,null),T(e,s),yt(o,e,null),T(e,i),c&&c.m(e,null),r=!0},p(t,[s]){const o={};8&s&&(o.$$scope={dirty:s,ctx:t}),n.$set(o),1&s&&(a=!1),a?c?c.p(t,s):(c=pr(),c.c(),c.m(e,null)):c&&(c.d(1),c=null)},i(t){r||(ft(n.$$.fragment,t),ft(o.$$.fragment,t),r=!0)},o(t){ht(n.$$.fragment,t),ht(o.$$.fragment,t),r=!1},d(t){t&&C(e),wt(n),wt(o),c&&c.d()}}}function hr(t,e,n){return[undefined,V("wx-i18n").getGroup("todo"),function(e){K.call(this,t,e)}]}class mr extends St{constructor(t){super(),_t(this,t,hr,fr,h,{})}}const gr=[];function $r(t,e=c){let n;const s=new Set;function o(e){if(h(t,e)&&(t=e,n)){const e=!gr.length;for(const e of s)e[1](),gr.push(e,t);if(e){for(let t=0;t<gr.length;t+=2)gr[t][0](gr[t+1]);gr.length=0}}}return{set:o,update:function(e){o(e(t))},subscribe:function(i,r=c){const a=[i,r];return s.add(a),1===s.size&&(n=e(o)||c),i(t),()=>{s.delete(a),0===s.size&&(n(),n=null)}}}}function kr(t){let e,n;return e=new mr({}),e.$on("click",t[7]),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p:c,i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function vr(t){let e,n,s,o,i,r,a,c,l,d,u=!t[1]&&kr(t);return o=new dr({props:{store:t[5],api:t[4]}}),o.$on("action",t[6]),{c(){e=M("div"),u&&u.c(),n=P(),s=M("div"),xt(o.$$.fragment),F(s,"class","wx-todo__wrapper svelte-c4slbb"),F(e,"class","wx-todo svelte-c4slbb"),F(e,"data-todo-id",t[0])},m(p,f){j(p,e,f),u&&u.m(e,null),T(e,n),T(e,s),yt(o,s,null),c=!0,l||(d=[N(s,"contextmenu",wr),S(Rs.call(null,s,{api:t[3]})),S(i=Ps.call(null,s,{api:t[3],readonly:t[1]})),S(r=Fs.call(null,s,{api:t[3],readonly:t[1]})),S(a=Ns.call(null,s,{api:t[3],readonly:!t[2]||t[1],id:t[0]})),S(Ls.call(null,s,{api:t[3]}))],l=!0)},p(t,s){t[1]?u&&(ut(),ht(u,1,1,(()=>{u=null})),pt()):u?(u.p(t,s),2&s&&ft(u,1)):(u=kr(t),u.c(),ft(u,1),u.m(e,n)),i&&f(i.update)&&2&s&&i.update.call(null,{api:t[3],readonly:t[1]}),r&&f(r.update)&&2&s&&r.update.call(null,{api:t[3],readonly:t[1]}),a&&f(a.update)&&7&s&&a.update.call(null,{api:t[3],readonly:!t[2]||t[1],id:t[0]}),(!c||1&s)&&F(e,"data-todo-id",t[0])},i(t){c||(ft(u),ft(o.$$.fragment,t),c=!0)},o(t){ht(u),ht(o.$$.fragment,t),c=!1},d(t){t&&C(e),u&&u.d(),wt(o),l=!1,p(d)}}}function xr(t){let e,n;return e=new Ce({props:{$$slots:{default:[vr]},$$scope:{ctx:t}}}),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};262151&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function yr(t){let e,n,s,o,i,r,a,c,l=!document.querySelector(".wx-portal");s=new _e({props:{words:{...Me,...Ie},optional:!0,$$slots:{default:[xr]},$$scope:{ctx:t}}});let d=l&&function(t){let e,n;return e=new he({props:{theme:"material"}}),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}();return{c(){xt(s.$$.fragment),o=P(),d&&d.c(),i=E()},m(l,u){yt(s,l,u),j(l,o,u),d&&d.m(l,u),j(l,i,u),r=!0,a||(c=[S(e=zs.call(null,window,{api:t[3],widgetId:t[0]})),S(n=Os.call(null,window,{api:t[3],readonly:t[1]}))],a=!0)},p(t,[o]){e&&f(e.update)&&1&o&&e.update.call(null,{api:t[3],widgetId:t[0]}),n&&f(n.update)&&2&o&&n.update.call(null,{api:t[3],readonly:t[1]});const i={};262151&o&&(i.$$scope={dirty:o,ctx:t}),s.$set(i)},i(t){r||(ft(s.$$.fragment,t),ft(d),r=!0)},o(t){ht(s.$$.fragment,t),ht(d),r=!1},d(t){wt(s,t),t&&C(o),d&&d.d(t),t&&C(i),a=!1,p(c)}}}const wr=t=>t.preventDefault();function br(t,e,n){let{id:s=Oe()}=e,{tasks:o=[]}=e,{projects:i=[]}=e,{users:r=[]}=e,{tags:a=[]}=e,{selected:c=[]}=e,{activeProject:l}=e,{readonly:d=!1}=e,{taskShape:u=Ke}=e,{drag:p=Qe}=e,{priorities:f=Xe}=e;const h=W(),m=new Cs($r),g=m.getReactive();let $=new Le(h);const k=function(t,e){let n=e;return{exec:t.in.exec,getState:t.getState.bind(t),getReactiveState:t.getReactive.bind(t),setNext:t=>{n.setNext(t.exec),n=t},getStores:()=>({state:t}),intercept:t.in.on.bind(t.in),on:t.out.on.bind(t.out),getSelection:e=>t.getSelection(e),eachSelected:(e,n,s)=>t.eachSelected(e,n,s),serialize:()=>t.serialize(),parse:e=>t.parse(e),existsTask:({id:e})=>t.existsTask(e),existsProject:({id:e})=>t.existsProject(e),getTask:({id:e})=>t.getTask(e),getProject:({id:e})=>t.getProject(e),hasChildren:({id:e,filtered:n,hideCompleted:s})=>t.hasChildren(e,n,s),getChildrenIds:e=>t.getChildrenIds(e),getParentIds:({id:e})=>t.getParentIds(e)}}(m,$);return m.out.setNext($.exec),t.$$set=t=>{"id"in t&&n(0,s=t.id),"tasks"in t&&n(8,o=t.tasks),"projects"in t&&n(9,i=t.projects),"users"in t&&n(10,r=t.users),"tags"in t&&n(11,a=t.tags),"selected"in t&&n(12,c=t.selected),"activeProject"in t&&n(13,l=t.activeProject),"readonly"in t&&n(1,d=t.readonly),"taskShape"in t&&n(14,u=t.taskShape),"drag"in t&&n(2,p=t.drag),"priorities"in t&&n(15,f=t.priorities)},t.$$.update=()=>{65287&t.$$.dirty&&m.init({tasks:o,users:r,tags:a,selected:c,taskShape:{...Ke,...u},drag:p?{...Qe,...p}:p,priorities:"boolean"==typeof f?f&&Xe:Array.isArray(f)&&f,projects:i,activeProject:l,readonly:d,id:s})},[s,d,p,k,m,g,function(t){const{action:e,data:n}=t.detail;m.in.exec(e,n)},function(t){He(m.getState().filter)||(t.stopPropagation(),Bn({store:m,reverse:!0}))},o,i,r,a,c,l,u,f]}class _r extends St{constructor(t){super(),_t(this,t,br,yr,h,{id:0,tasks:8,projects:9,users:10,tags:11,selected:12,activeProject:13,readonly:1,taskShape:14,drag:2,priorities:15,api:3})}get api(){return this.$$.ctx[3]}}function Sr(t){let e;const n=t[1].default,s=$(n,t,t[2],null);return{c(){s&&s.c()},m(t,n){s&&s.m(t,n),e=!0},p(t,o){s&&s.p&&(!e||4&o)&&x(s,n,t,t[2],e?v(n,t[2],o,null):y(t[2]),null)},i(t){e||(ft(s,t),e=!0)},o(t){ht(s,t),e=!1},d(t){s&&s.d(t)}}}function Tr(t){let e,n,s=t[0]&&Sr(t);return{c(){e=M("div"),s&&s.c(),F(e,"class","wx-todo_toolbar svelte-18c2a5y")},m(t,o){j(t,e,o),s&&s.m(e,null),n=!0},p(t,n){t[0]?s?(s.p(t,n),1&n&&ft(s,1)):(s=Sr(t),s.c(),ft(s,1),s.m(e,null)):s&&(ut(),ht(s,1,1,(()=>{s=null})),pt())},i(t){n||(ft(s),n=!0)},o(t){ht(s),n=!1},d(t){t&&C(e),s&&s.d()}}}function jr(t){let e,n;return e=new _e({props:{words:{...Me,...Ie},optional:!0,$$slots:{default:[Tr]},$$scope:{ctx:t}}}),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,[n]){const s={};5&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function Cr(t,e,n){let{$$slots:s={},$$scope:o}=e,{api:i}=e;return t.$$set=t=>{"api"in t&&n(0,i=t.api),"$$scope"in t&&n(2,o=t.$$scope)},[i,s,o]}class Ir extends St{constructor(t){super(),_t(this,t,Cr,jr,h,{api:0})}}function Mr(t){let e,n;return e=new Ro({props:{options:t[2],parent:t[1]}}),e.$on("click",t[7]),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};4&n&&(s.options=t[2]),2&n&&(s.parent=t[1]),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function Dr(t){let e,n,s,o,i;n=new fo({props:{name:"dots-v"}}),n.$on("click",t[8]);let r="toolbar"===t[0]?.type&&Mr(t);return{c(){e=M("button"),xt(n.$$.fragment),s=P(),r&&r.c(),o=E(),F(e,"class","wx-todo_toolbar-menu-button svelte-r66yne"),F(e,"tabindex","0"),F(e,"data-toolbar-icon",!0),F(e,"data-todo-id",t[6])},m(a,c){j(a,e,c),yt(n,e,null),t[11](e),j(a,s,c),r&&r.m(a,c),j(a,o,c),i=!0},p(t,[n]){(!i||64&n)&&F(e,"data-todo-id",t[6]),"toolbar"===t[0]?.type?r?(r.p(t,n),1&n&&ft(r,1)):(r=Mr(t),r.c(),ft(r,1),r.m(o.parentNode,o)):r&&(ut(),ht(r,1,1,(()=>{r=null})),pt())},i(t){i||(ft(n.$$.fragment,t),ft(r),i=!0)},o(t){ht(n.$$.fragment,t),ht(r),i=!1},d(i){i&&C(e),wt(n),t[11](null),i&&C(s),r&&r.d(i),i&&C(o)}}}function Pr(t,e,n){let s,o,i,r,a,l,d,u,p=c,f=c,h=c;t.$$.on_destroy.push((()=>p())),t.$$.on_destroy.push((()=>f())),t.$$.on_destroy.push((()=>h()));let{api:g}=e;const $=V("wx-i18n").getGroup("todo");let k=null;return t.$$set=t=>{"api"in t&&n(9,g=t.api)},t.$$.update=()=>{512&t.$$.dirty&&n(10,s=g.getReactiveState()),1024&t.$$.dirty&&(n(5,o=s.id),h(),h=m(o,(t=>n(6,u=t)))),1024&t.$$.dirty&&(n(4,i=s.menu),f(),f=m(i,(t=>n(0,d=t)))),1024&t.$$.dirty&&(n(3,r=s.activeProject),p(),p=m(r,(t=>n(12,l=t)))),1&t.$$.dirty&&n(2,a=Ms(d?.options||[],$))},[d,k,a,r,i,o,u,function(t){const e=t.detail.action?.id??t.detail.action;g.exec("click-menu-item",{id:l,type:"toolbar",action:e,params:{locate:$}})},function(){const{menu:t,activeProject:e}=g.getState();t?.open&&"toolbar"===t.type?g.exec("close-menu",{...t}):g.exec("open-menu",{id:e,type:"toolbar"})},g,s,function(t){X[t?"unshift":"push"]((()=>{k=t,n(1,k)}))}]}class Er extends St{constructor(t){super(),_t(this,t,Pr,Dr,h,{api:9})}}function Nr(t){let e,n;return e=new fo({props:{name:"close",clickable:!0}}),e.$on("click",t[3]),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p:c,i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function Ar(t){let e,n,s,o,i,r,a=t[0]&&Nr(t);return{c(){e=M("div"),n=M("input"),s=P(),a&&a.c(),F(n,"class","wx-todo_input__value svelte-4g7y4h"),F(n,"placeholder",t[1]),F(e,"class","wx-todo_input svelte-4g7y4h")},m(c,l){j(c,e,l),T(e,n),t[7](n),R(n,t[0]),T(e,s),a&&a.m(e,null),o=!0,i||(r=[N(n,"input",t[8]),N(n,"keypress",t[4]),N(n,"focus",t[5]),N(n,"blur",t[6])],i=!0)},p(t,[s]){(!o||2&s)&&F(n,"placeholder",t[1]),1&s&&n.value!==t[0]&&R(n,t[0]),t[0]?a?(a.p(t,s),1&s&&ft(a,1)):(a=Nr(t),a.c(),ft(a,1),a.m(e,null)):a&&(ut(),ht(a,1,1,(()=>{a=null})),pt())},i(t){o||(ft(a),o=!0)},o(t){ht(a),o=!1},d(n){n&&C(e),t[7](null),a&&a.d(),i=!1,p(r)}}}function Fr(t,e,n){let{placeholder:s=""}=e,{value:o=""}=e,i=null;const r=W();return t.$$set=t=>{"placeholder"in t&&n(1,s=t.placeholder),"value"in t&&n(0,o=t.value)},t.$$.update=()=>{5&t.$$.dirty&&(i||o)&&setTimeout((()=>us(i)))},[o,s,i,function(){n(0,o=""),r("clear"),i?.focus()},function(e){K.call(this,t,e)},function(e){K.call(this,t,e)},function(e){K.call(this,t,e)},function(t){X[t?"unshift":"push"]((()=>{i=t,n(2,i)}))},function(){o=this.value,n(0,o)}]}class Lr extends St{constructor(t){super(),_t(this,t,Fr,Ar,h,{placeholder:1,value:0})}}function Rr(t){let e,n,s,o,i;function r(e){t[19](e)}let a={placeholder:t[8]("Search")};void 0!==t[1].value&&(a.value=t[1].value),n=new Lr({props:a}),X.push((()=>vt(n,"value",r))),n.$on("focus",t[10]),n.$on("blur",t[11]);let c=t[0]&&t[2]?.open&&t[1].value&&Or(t);return{c(){e=M("div"),xt(n.$$.fragment),o=P(),c&&c.c(),F(e,"class","wx-todo_search__input svelte-1fjg0pe")},m(t,s){j(t,e,s),yt(n,e,null),T(e,o),c&&c.m(e,null),i=!0},p(t,o){const i={};!s&&2&o&&(s=!0,i.value=t[1].value,ot((()=>s=!1))),n.$set(i),t[0]&&t[2]?.open&&t[1].value?c?(c.p(t,o),7&o&&ft(c,1)):(c=Or(t),c.c(),ft(c,1),c.m(e,null)):c&&(ut(),ht(c,1,1,(()=>{c=null})),pt())},i(t){i||(ft(n.$$.fragment,t),ft(c),i=!0)},o(t){ht(n.$$.fragment,t),ht(c),i=!1},d(t){t&&C(e),wt(n),c&&c.d()}}}function Or(t){let e,n;return e=new It({props:{width:"fit-content",cancel:t[13],$$slots:{default:[Hr]},$$scope:{ctx:t}}}),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};8388612&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function zr(t){let e,n;return e=new vo({props:{item:t[22]}}),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};4194304&n&&(s.item=t[22]),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function Hr(t){let e,n;return e=new li({props:{options:t[2].options,$$slots:{default:[zr,({item:t})=>({22:t}),({item:t})=>t?4194304:0]},$$scope:{ctx:t}}}),e.$on("click",t[12]),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};4&n&&(s.options=t[2].options),12582912&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function Yr(t){let e,n,s,o;n=new fo({props:{name:"search",clickable:!0}}),n.$on("click",t[9]);let i=t[1]?.open&&Rr(t);return{c(){e=M("div"),xt(n.$$.fragment),s=P(),i&&i.c(),F(e,"data-todo-id",t[7]),F(e,"class","wx-todo_search svelte-1fjg0pe"),z(e,"wx-todo_search--opened",t[1]?.open)},m(r,a){j(r,e,a),yt(n,e,null),T(e,s),i&&i.m(e,null),t[20](e),o=!0},p(t,[n]){t[1]?.open?i?(i.p(t,n),2&n&&ft(i,1)):(i=Rr(t),i.c(),ft(i,1),i.m(e,null)):i&&(ut(),ht(i,1,1,(()=>{i=null})),pt()),(!o||128&n)&&F(e,"data-todo-id",t[7]),2&n&&z(e,"wx-todo_search--opened",t[1]?.open)},i(t){o||(ft(n.$$.fragment,t),ft(i),o=!0)},o(t){ht(n.$$.fragment,t),ht(i),o=!1},d(s){s&&C(e),wt(n),i&&i.d(),t[20](null)}}}function qr(t,e,n){let s,o,i,r,a,l,d,u,p,f,h=c,g=c,$=c,k=c;t.$$.on_destroy.push((()=>h())),t.$$.on_destroy.push((()=>g())),t.$$.on_destroy.push((()=>$())),t.$$.on_destroy.push((()=>k()));let{api:v}=e,x=null,y=null;const w=V("wx-i18n").getGroup("todo");function b(){v?.exec("set-state-search",{...d,dropdown:{open:!1}}),n(15,y=null)}return t.$$set=t=>{"api"in t&&n(14,v=t.api)},t.$$.update=()=>{16384&t.$$.dirty&&n(16,s=v.getReactiveState()),65536&t.$$.dirty&&(n(6,o=s.id),k(),k=m(o,(t=>n(7,f=t)))),65536&t.$$.dirty&&(n(5,i=s.filter),$(),$=m(i,(t=>n(18,p=t)))),65536&t.$$.dirty&&(n(4,r=s.tags),g(),g=m(r,(t=>n(17,u=t)))),65536&t.$$.dirty&&(n(3,a=s.stateSearch),h(),h=m(a,(t=>n(1,d=t)))),2&t.$$.dirty&&n(2,l=d?.dropdown),442371&t.$$.dirty&&He(d?.value)&&d.value!==(p?.match||"")&&d.focus&&(d.value?.length?v.exec("set-filter",{match:d.value,highlight:!0,strict:d.value?.startsWith("#")&&u.includes(d.value)}):v.exec("set-filter",{match:null}),x&&d.value?.startsWith("#")&&y!==d?.value?function(){const t=Is(u,d.value);setTimeout((()=>{v.exec("set-state-search",{...d,open:!0,dropdown:{open:!0,options:t}})}),d?.open?0:250)}():b())},[x,d,l,a,r,i,o,f,w,function(){v.exec("set-state-search",{...d,open:!d?.open})},function(){v.exec("set-state-search",{...d,focus:!0})},function(){v.exec("set-state-search",{...d,focus:!1,open:!!d.value?.length})},function(t){n(15,y=t.detail.id),v.exec("set-state-search",{...d,value:y?.length?y:d?.value,dropdown:{open:!1}})},b,v,y,s,u,p,function(e){t.$$.not_equal(d.value,e)&&(d.value=e,a.set(d))},function(t){X[t?"unshift":"push"]((()=>{x=t,n(0,x)}))}]}class Br extends St{constructor(t){super(),_t(this,t,qr,Yr,h,{api:14})}}function Jr(t){let e,n;return{c(){e=M("div"),n=D(t[2]),F(e,"class","wx-todo_text__value svelte-ti50q3"),F(e,"tabindex","0")},m(t,s){j(t,e,s),T(e,n)},p(t,e){4&e&&L(n,t[2])},d(t){t&&C(e)}}}function Gr(t){let e,n,s,o;return{c(){e=M("div"),n=D(t[2]),F(e,"class","wx-todo_text__value svelte-ti50q3"),F(e,"contenteditable",!0),F(e,"data-placeholder",t[1]),F(e,"tabindex","0"),z(e,"wx-todo_text__value--editing",t[0])},m(i,r){j(i,e,r),T(e,n),t[9](e),s||(o=[N(e,"blur",t[7]),N(e,"input",t[5])],s=!0)},p(t,s){4&s&&L(n,t[2]),2&s&&F(e,"data-placeholder",t[1]),1&s&&z(e,"wx-todo_text__value--editing",t[0])},d(n){n&&C(e),t[9](null),s=!1,p(o)}}}function Wr(t){let e,n,s;function o(t,e){return t[0]&&t[3]?Gr:Jr}let i=o(t),r=i(t);return{c(){e=M("div"),r.c(),F(e,"class","wx-todo_text svelte-ti50q3")},m(o,i){j(o,e,i),r.m(e,null),n||(s=N(e,"dblclick",A(t[6])),n=!0)},p(t,[n]){i===(i=o(t))&&r?r.p(t,n):(r.d(1),r=i(t),r&&(r.c(),r.m(e,null)))},i:c,o:c,d(t){t&&C(e),r.d(),n=!1,s()}}}function Ur(t,e,n){let{placeholder:s=""}=e,{value:o=""}=e,{editable:i=!0}=e,{editing:r=!1}=e,{enableRange:a=!1}=e,c=null;const l=W();return t.$$set=t=>{"placeholder"in t&&n(1,s=t.placeholder),"value"in t&&n(2,o=t.value),"editable"in t&&n(3,i=t.editable),"editing"in t&&n(0,r=t.editing),"enableRange"in t&&n(8,a=t.enableRange)},t.$$.update=()=>{272&t.$$.dirty&&c&&(a?function(t){if(!t)return;const e=document.createRange(),n=window.getSelection();e.setStart(t,0),e.setEnd(t,t?.childNodes?.length||0),n.removeAllRanges(),n.addRange(e)}(c):us(c))},[r,s,o,i,c,function(){l("editing",{value:c?.textContent||""})},function(){i&&!r&&(n(0,r=!0),l("open",{value:o}))},function(){r&&(n(0,r=!1),l("close",{value:o}))},a,function(t){X[t?"unshift":"push"]((()=>{c=t,n(4,c)}))}]}class Vr extends St{constructor(t){super(),_t(this,t,Ur,Wr,h,{placeholder:1,value:2,editable:3,editing:0,enableRange:8})}}function Kr(t){let e,n;return e=new It({props:{width:"fit-content",cancel:t[18],$$slots:{default:[Xr]},$$scope:{ctx:t}}}),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};3&n[0]|2&n[1]&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function Qr(t){let e,n;return e=new vo({props:{item:t[31]}}),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};1&n[1]&&(s.item=t[31]),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function Xr(t){let e,n,s,o,i,r,a,c,l,d,u,p;function f(e){t[30](e)}o=new fo({props:{name:"search"}});let h={placeholder:t[16]("Search project")};return void 0!==t[0]&&(h.value=t[0]),r=new Lr({props:h}),X.push((()=>vt(r,"value",f))),l=new Zi({props:{padding:"0"}}),u=new li({props:{options:t[1],$$slots:{default:[Qr,({item:t})=>({31:t}),({item:t})=>[0,t?1:0]]},$$scope:{ctx:t}}}),u.$on("click",t[19]),{c(){e=M("div"),n=M("div"),s=M("div"),xt(o.$$.fragment),i=P(),xt(r.$$.fragment),c=P(),xt(l.$$.fragment),d=P(),xt(u.$$.fragment),F(s,"class","wx-todo_combo-search__icon svelte-1fotihc"),F(n,"class","wx-todo_combo-search svelte-1fotihc"),F(e,"class","wx-todo_combo-dropdown")},m(t,a){j(t,e,a),T(e,n),T(n,s),yt(o,s,null),T(n,i),yt(r,n,null),T(e,c),yt(l,e,null),T(e,d),yt(u,e,null),p=!0},p(t,e){const n={};!a&&1&e[0]&&(a=!0,n.value=t[0],ot((()=>a=!1))),r.$set(n);const s={};2&e[0]&&(s.options=t[1]),3&e[1]&&(s.$$scope={dirty:e,ctx:t}),u.$set(s)},i(t){p||(ft(o.$$.fragment,t),ft(r.$$.fragment,t),ft(l.$$.fragment,t),ft(u.$$.fragment,t),p=!0)},o(t){ht(o.$$.fragment,t),ht(r.$$.fragment,t),ht(l.$$.fragment,t),ht(u.$$.fragment,t),p=!1},d(t){t&&C(e),wt(o),wt(r),wt(l),wt(u)}}}function Zr(t){let e,n,s,o,i,r,a,c,l,d;s=new Vr({props:{editing:t[5],value:t[4],enableRange:!0,placeholder:t[16]("Type what you want"),editable:He(t[2])&&!t[15]}}),s.$on("close",t[21]),s.$on("open",t[20]),s.$on("editing",t[22]),r=new fo({props:{name:"menu-down",clickable:!0}});let u=t[13]?.open&&!t[5]&&Kr(t);return{c(){e=M("div"),n=M("div"),xt(s.$$.fragment),o=P(),i=M("div"),xt(r.$$.fragment),a=P(),u&&u.c(),F(i,"class","wx-todo_combo__icon"),F(n,"class","wx-todo_combo__wrapper svelte-1fotihc"),F(e,"data-todo-id",t[14]),F(e,"class","wx-todo_combo svelte-1fotihc")},m(p,f){j(p,e,f),T(e,n),yt(s,n,null),T(n,o),T(n,i),yt(r,i,null),t[29](n),T(e,a),u&&u.m(e,null),c=!0,l||(d=N(n,"click",t[17]),l=!0)},p(t,n){const o={};32&n[0]&&(o.editing=t[5]),16&n[0]&&(o.value=t[4]),32772&n[0]&&(o.editable=He(t[2])&&!t[15]),s.$set(o),t[13]?.open&&!t[5]?u?(u.p(t,n),8224&n[0]&&ft(u,1)):(u=Kr(t),u.c(),ft(u,1),u.m(e,null)):u&&(ut(),ht(u,1,1,(()=>{u=null})),pt()),(!c||16384&n[0])&&F(e,"data-todo-id",t[14])},i(t){c||(ft(s.$$.fragment,t),ft(r.$$.fragment,t),ft(u),c=!0)},o(t){ht(s.$$.fragment,t),ht(r.$$.fragment,t),ht(u),c=!1},d(n){n&&C(e),wt(s),wt(r),t[29](null),u&&u.d(),l=!1,d()}}}function ta(t,e,n){let s,o,i,r,a,l,d,u,p,f,h,g,$,k,v,x,y,w,b=c,_=c,S=c,T=c,j=c,C=c,I=c;t.$$.on_destroy.push((()=>b())),t.$$.on_destroy.push((()=>_())),t.$$.on_destroy.push((()=>S())),t.$$.on_destroy.push((()=>T())),t.$$.on_destroy.push((()=>j())),t.$$.on_destroy.push((()=>C())),t.$$.on_destroy.push((()=>I()));let{api:M}=e;const D=V("wx-i18n").getGroup("todo");let P=null,E=null,N=[];function A(t){n(0,E=null),v.open&&!P.contains(t?.target)&&M.exec("set-state-combo",{open:!1})}return t.$$set=t=>{"api"in t&&n(23,M=t.api)},t.$$.update=()=>{8388608&t.$$.dirty[0]&&n(25,s=M.getReactiveState()),33554432&t.$$.dirty[0]&&(n(12,o=s.stateEditableItem),b(),b=m(o,(t=>n(26,g=t)))),33554432&t.$$.dirty[0]&&(n(11,i=s.activeProject),S(),S=m(i,(t=>n(2,k=t)))),33554432&t.$$.dirty[0]&&(n(10,r=s.projects),_(),_=m(r,(t=>n(27,$=t)))),33554432&t.$$.dirty[0]&&(n(9,a=s.tasks),j(),j=m(a,(t=>n(28,x=t)))),33554432&t.$$.dirty[0]&&(n(8,l=s.id),C(),C=m(l,(t=>n(14,y=t)))),33554432&t.$$.dirty[0]&&(n(7,d=s.readonly),I(),I=m(d,(t=>n(15,w=t)))),33554432&t.$$.dirty[0]&&(n(6,u=s.stateCombo),T(),T=m(u,(t=>n(13,v=t)))),67108868&t.$$.dirty[0]&&n(5,p=ze(g?.id,k)&&"project"===g?.type),402653184&t.$$.dirty[0]&&n(24,f=$.every((t=>He(t.id)))&&x.some((t=>!He(t.project)&&!He(t.parent)))?[{id:null,label:D("No project")},...$]:[...$]),16777220&t.$$.dirty[0]&&n(4,h=(f.find((t=>ze(k,t?.id)))?.label||D("No project")).trim()),16777223&t.$$.dirty[0]&&(He(E)?n(1,N=f.filter((({label:t})=>t.toLowerCase().includes(E.toLowerCase())))):n(1,N=f),n(1,N=N.map((t=>{const e=ze(t.id,k)?"check":"empty";return{...t,icon:e}}))))},[E,N,k,P,h,p,u,d,l,a,r,i,o,v,y,w,D,function(t){n(0,E=null),P.contains(t?.target)&&M.exec("set-state-combo",{open:!v?.open})},A,function(t){M.exec("set-project",{id:t.detail.id}),A(t)},function(){M.exec("open-inline-editor",{id:k,type:"project"})},function(){He(g?.id)&&M.exec("close-inline-editor",{id:g.id})},function(t){const e=t.detail.value.trim(),n=$.filter((({label:t})=>t!==h));M.exec("edit-item",{id:g.id,currentValue:e.length?e:es("Untilted",n,D)})},M,f,s,g,$,x,function(t){X[t?"unshift":"push"]((()=>{P=t,n(3,P)}))},function(t){E=t,n(0,E)}]}class ea extends St{constructor(t){super(),_t(this,t,ta,Zr,h,{api:23},null,[-1,-1])}}class na{constructor(t){this._api=t}on(t,e){this._api.on(t,e)}exec(t,e){this._api.exec(t,e)}}function sa(t){let e,n;return{c(){e=new H,n=E(),e.a=n},m(s,o){e.m(t[0],s,o),j(s,n,o)},p(t,n){1&n&&e.p(t[0])},d(t){t&&C(n),t&&e.d()}}}function oa(t){let e,n=t[0]&&sa(t);return{c(){n&&n.c(),e=E()},m(t,s){n&&n.m(t,s),j(t,e,s)},p(t,[s]){t[0]?n?n.p(t,s):(n=sa(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:c,o:c,d(t){n&&n.d(t),t&&C(e)}}}function ia(t,e,n){let s;const o=["template"];let i=b(e,o),{template:r}=e;return t.$$set=t=>{e=l(l({},e),w(t)),n(2,i=b(e,o)),"template"in t&&n(1,r=t.template)},t.$$.update=()=>{n(0,s="function"==typeof r?r(Object.assign({},i)):r)},[s,r]}class ra extends St{constructor(t){super(),_t(this,t,ia,oa,h,{template:1})}}function aa(t,e,n){const s=t.slice();return s[2]=e[n],s}function ca(t){let e,n;return e=new ra({props:{template:t[2].type}}),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};2&n&&(s.template=t[2].type),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function la(t){let e,n;return e=new ra({props:{template:t[2].template}}),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};2&n&&(s.template=t[2].template),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function da(t){let e,n;return e=new ea({props:{api:t[0]}}),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};1&n&&(s.api=t[0]),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function ua(t){let e,n;return e=new Er({props:{api:t[0]}}),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};1&n&&(s.api=t[0]),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function pa(t){let e,n;return e=new Br({props:{api:t[0]}}),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};1&n&&(s.api=t[0]),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function fa(t){let e,n,s,o;const i=[pa,ua,da,la,ca],r=[];function a(t,e){return"search"===t[2].type?0:"menu"===t[2].type?1:"combo"===t[2].type?2:t[2].template?3:t[2].type?4:-1}return~(e=a(t))&&(n=r[e]=i[e](t)),{c(){n&&n.c(),s=E()},m(t,n){~e&&r[e].m(t,n),j(t,s,n),o=!0},p(t,o){let c=e;e=a(t),e===c?~e&&r[e].p(t,o):(n&&(ut(),ht(r[c],1,1,(()=>{r[c]=null})),pt()),~e?(n=r[e],n?n.p(t,o):(n=r[e]=i[e](t),n.c()),ft(n,1),n.m(s.parentNode,s)):n=null)},i(t){o||(ft(n),o=!0)},o(t){ht(n),o=!1},d(t){~e&&r[e].d(t),t&&C(s)}}}function ha(t){let e,n,s=t[1],o=[];for(let e=0;e<s.length;e+=1)o[e]=fa(aa(t,s,e));const i=t=>ht(o[t],1,1,(()=>{o[t]=null}));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=E()},m(t,s){for(let e=0;e<o.length;e+=1)o[e].m(t,s);j(t,e,s),n=!0},p(t,n){if(3&n){let r;for(s=t[1],r=0;r<s.length;r+=1){const i=aa(t,s,r);o[r]?(o[r].p(i,n),ft(o[r],1)):(o[r]=fa(i),o[r].c(),ft(o[r],1),o[r].m(e.parentNode,e))}for(ut(),r=s.length;r<o.length;r+=1)i(r);pt()}},i(t){if(!n){for(let t=0;t<s.length;t+=1)ft(o[t]);n=!0}},o(t){o=o.filter(Boolean);for(let t=0;t<o.length;t+=1)ht(o[t]);n=!1},d(t){I(o,t),t&&C(e)}}}function ma(t){let e,n;return e=new Ir({props:{api:t[0],$$slots:{default:[ha]},$$scope:{ctx:t}}}),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,n){const s={};1&n&&(s.api=t[0]),35&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function ga(t){let e,n;return e=new Ce({props:{$$slots:{default:[ma]},$$scope:{ctx:t}}}),{c(){xt(e.$$.fragment)},m(t,s){yt(e,t,s),n=!0},p(t,[n]){const s={};35&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){wt(e,t)}}}function $a(t,e,n){let{api:s}=e,{items:o}=e;return t.$$set=t=>{"api"in t&&n(0,s=t.api),"items"in t&&n(1,o=t.items)},[s,o]}class ka extends St{constructor(t){super(),_t(this,t,$a,ga,h,{api:0,items:1})}}const va=Symbol();class xa{constructor(){this._awaitAddingQueue=[],this._queue={},this._idPool={},this._batchPull={},this._backId=[],this.add=this.add.bind(this)}resolve(t,e){const n=this._backId[e];if(void 0===n)return t;const s=n[t];return void 0===s?t:s}add(t,e,n){if(n.debounce){const s=e.batchID;delete e.batchID;const o=`${t}"/"${s||e.id}`;s&&(this._batchPull[s]||(this._batchPull[s]=[]),this._batchPull[s].push(e));const i=this._queue[o];return i&&clearTimeout(i),void(this._queue[o]=setTimeout((()=>{const o=this._batchPull[s];o&&o.length>1&&(e={opbatch:o}),this.add(t,e,{...n,debounce:!1})}),n.debounce))}const s=this.tryExec(t,e,n);null===s?this._awaitAddingQueue.push({action:t,data:e,proc:n}):s.then((t=>{t&&t.id&&t.id!=e.id&&this.isTempID(e.id)&&(this._idPool[e.id]=t.id,this.execQueue())}))}tryExec(t,e,n){const s=this.exec(t,e,n);return null===s?this._awaitAddingQueue.push({action:t,data:e,proc:n}):s.then((t=>{if(t&&t.id&&t.id!=e.id&&this.isTempID(e.id)){if(this._idPool[e.id]=t.id,n.kind){let s=this._backId[n.kind];s||(s=this._backId[n.kind]={}),s[t.id]=e.id}this.execQueue()}})),s}exec(t,e,n){const s=this.correctID(e,n.ignoreID?e.id:null,n.skipCorrect);return s===va?null:n.handler(s,t,e)}isTempID(t){return"string"==typeof t&&20===t.length&&parseInt(t.substr(7))>1e12}correctID(t,e,n){let s=null;for(const o in t){if(n&&n.includes(o))continue;const i=t[o];if("object"==typeof i){const r=this.correctID(i,e,n);if(r!==i){if(r===va)return va;null===s&&(s={...t}),s[o]=r}}else if(i!==e&&this.isTempID(i)){const e=this._idPool[i];if(!e)return va;null===s&&(s={...t}),s[o]=e}}return s||t}execQueue(){this._awaitAddingQueue=this._awaitAddingQueue.map((t=>this.tryExec(t.action,t.data,t.proc)?null:t)).filter((t=>null!==t))}setID(t,e,n){if(this._idPool[t]=e,n){let s=this._backId[n];s||(s=this._backId[n]={}),s[e]=t}}}class ya{constructor(t){const{url:e,token:n}=t;this._url=e,this._token=n,this._mode=1,this._seed=1,this._queue=[],this.data={},this.api={},this._events={}}headers(){return{Accept:"application/json","Content-Type":"application/json","Remote-Token":this._token}}fetch(t,e){const n={credentials:"include",headers:this.headers()};return e&&(n.method="POST",n.body=e),fetch(t,n).then((t=>t.json()))}load(t){return t&&(this._url=t),this.fetch(this._url).then((t=>this.parse(t)))}parse(t){const{key:e,websocket:n}=t;e&&(this._token=t.key);for(const e in t.data)this.data[e]=t.data[e];for(const e in t.api){const n=this.api[e]={},s=t.api[e];for(const t in s)n[t]=this._wrapper(e+"."+t)}return n&&this.connect(),this}connect(){const t=this._socket;t&&(this._socket=null,t.onclose=function(){},t.close()),this._mode=2,this._socket=function(t,e,n,s){let o=e;"/"===o[0]&&(o=document.location.protocol+"//"+document.location.host+e),o=o.replace(/^http(s|):/,"ws$1:");const i=-1!=o.indexOf("?")?"&":"?";o=`${o}${i}token=${n}&ws=1`;const r=new WebSocket(o);return r.onclose=()=>setTimeout((()=>t.connect()),2e3),r.onmessage=e=>{const n=JSON.parse(e.data);switch(n.action){case"result":t.result(n.body,[]);break;case"event":t.fire(n.body.name,n.body.value);break;case"start":s();break;default:t.onError(n.data)}},r}(this,this._url,this._token,(()=>(this._mode=3,this._send(),this._resubscribe(),this)))}_wrapper(t){return function(){const e=[].slice.call(arguments);let n=null;const s=new Promise(((s,o)=>{n={data:{id:this._uid(),name:t,args:e},status:1,resolve:s,reject:o},this._queue.push(n)}));return this.onCall(n,s),3===this._mode?this._send(n):setTimeout((()=>this._send()),1),s}.bind(this)}_uid(){return(this._seed++).toString()}_send(t){if(2==this._mode)return void setTimeout((()=>this._send()),100);const e=t?[t]:this._queue.filter((t=>1===t.status));if(!e.length)return;const n=e.map((t=>(t.status=2,t.data)));3!==this._mode?this.fetch(this._url,JSON.stringify(n)).catch((t=>this.onError(t))).then((t=>this.result(t,n))):this._socket.send(JSON.stringify({action:"call",body:n}))}result(t,e){const n={};if(t)for(let e=0;e<t.length;e++)n[t[e].id]=t[e];else for(let t=0;t<e.length;t++)n[e[t].id]={id:e[t].id,error:"Network Error",data:null};for(let t=this._queue.length-1;t>=0;t--){const e=this._queue[t],s=n[e.data.id];s&&(this.onResponse(e,s),s.error?e.reject(s.error):e.resolve(s.data),this._queue.splice(t,1))}}on(t,e){const n=this._uid();let s=this._events[t];const o=!!s;return o||(s=this._events[t]=[]),s.push({id:n,handler:e}),o||3!=this._mode||this._socket.send(JSON.stringify({action:"subscribe",name:t})),{name:t,id:n}}_resubscribe(){if(3==this._mode)for(const t in this._events)this._socket.send(JSON.stringify({action:"subscribe",name:t}))}detach(t){if(!t){if(3==this._mode)for(const t in this._events)this._socket.send(JSON.stringify({action:"unsubscribe",key:t}));return void(this._events={})}const{id:e,name:n}=t,s=this._events[n];if(s){const t=s.filter((t=>t.id!=e));t.length?this._events[n]=t:(delete this._events[n],3==this._mode&&this._socket.send(JSON.stringify({action:"unsubscribe",name:n})))}}fire(t,e){const n=this._events[t];if(n)for(let t=0;t<n.length;t++)n[t].handler(e)}onError(t){return null}onCall(t,e){}onResponse(t,e){}}return t.RemoteEvents=class{constructor(t,e){const n=new ya({url:t,token:e});n.fetch=function(t,e){const n={headers:this.headers()};return e&&(n.method="POST",n.body=e),fetch(t,n).then((t=>t.json()))},this._ready=n.load().then((t=>this._remote=t))}ready(){return this._ready}on(t,e){this.ready().then((n=>{if("string"==typeof t)n.on(t,e);else for(const e in t)n.on(e,t[e])}))}},t.RestDataProvider=class extends Ae{constructor(t,e){super(),this._url=t,this._api=e,this._queue=new xa;const n={"add-task":{ignoreID:!0,kind:1,handler:t=>this.send("tasks","POST",t)},"update-task":{handler:t=>(t.task.batch=this.toArray(t?.batch),this.send(`tasks/${t.id}`,"PUT",t.task))},"delete-task":{handler:t=>this.send(`tasks/${t.id}`,"DELETE")},"add-project":{kind:2,ignoreID:!0,handler:t=>this.send("projects","POST",t.project)},"update-project":{handler:t=>this.send(`projects/${t.id}`,"PUT",t.project)},"delete-project":{handler:t=>this.send(`projects/${t.id}`,"DELETE")},"set-project":{handler:t=>this.send(`tasks/projects/${t.id}`,"GET").then((t=>(this._api.parse({tasks:t}),Promise.resolve())))},"move-task":{debounce:300,handler:t=>(t.batch&&(t.id=0),this.send(`move/${t.id}`,"PUT",t))},"clone-task":{skipCorrect:["batch"],handler:t=>this.send("clone","POST",t).then((e=>{const n=e;for(let e=0;e<t.batch.length;e++){const s=t.batch[e].id,o=n[e];this._queue.setID(s,o,1)}}))},"set-sort":{handler:t=>{const e=this._api.getState().activeProject;return this.send(`sort/${e}`,"PUT",t)}}},s=this.getHandlers(n);for(const t in s)this.on(t,(e=>{e.skipProvider||this._queue.add(t,e,s[t])}))}getTasks(){return this.send("tasks","GET")}getProjectTasks(t){return this.send("tasks/projects/"+t,"GET")}getUsers(){return this.send("users","GET")}getProjects(){return this.send("projects","GET")}getTags(){return this.send("tags","GET")}setAPI(t){this._api=t}setHeaders(t){this._customHeaders=t}getIDResolver(){return this._queue.resolve.bind(this._queue)}getHandlers(t){return t}send(t,e,n,s={}){const o={method:e,headers:{"Content-Type":"application/json",...s,...this._customHeaders}};return n&&(o.body="object"==typeof n?JSON.stringify(n):n),fetch(`${this._url}/${t}`,o).then((async t=>{if(500==t.status){const e=await t.text();return Promise.reject(e)}return await t.json()}))}toArray(t){return t?Array.isArray(t)?t:Object.values(t):[]}},t.ToDo=class{constructor(t,e){this.container="string"==typeof t?document.querySelector(t):t,this.config=e,this._init()}destructor(){this._widget.$destroy(),this._widget=this.api=this.events=null}setConfig(t){t&&(this.config=Object.assign(Object.assign({},this.config),t),this._init())}parse(t){this.api.parse(t)}serialize(){return this.api.serialize()}existsTask(t){return this.api.existsTask(t)}existsProject(t){return this.api.existsProject(t)}getTask(t){return this.api.getTask(t)}getProject(t){return this.api.getProject(t)}hasChildren(t){return this.api.hasChildren(t)}getChildrenIds(t){return this.api.getChildrenIds(t)}getParentIds(t){return this.api.getParentIds(t)}setLocale(t){t&&this.setConfig({locale:t})}setFilter(t){this.api.exec("set-filter",t)}setSort(t){this.api.exec("set-sort",t)}selectTask(t){this.api.exec("select-task",t)}unselectTask(t){this.api.exec("unselect-task",t)}getSelection(t){return this.api.getSelection(t)}eachSelected(t,e,n){this.api.eachSelected(t,e,n)}addTask(t){this.api.exec("add-task",t)}copyTask(t){this.api.exec("copy-task",t)}pasteTask(t){this.api.exec("paste-task",t)}moveTask(t){this.api.exec("move-task",t)}updateTask(t){this.api.exec("update-task",t)}deleteTask(t){this.api.exec("delete-task",t)}indentTask(t){this.api.exec("indent-task",t)}unindentTask(t){this.api.exec("unindent-task",t)}checkTask(t){var e;(null===(e=this.getTask({id:t.id}))||void 0===e?void 0:e.checked)||this.api.exec("check-task",t)}uncheckTask(t){var e;(null===(e=this.getTask({id:t.id}))||void 0===e?void 0:e.checked)&&this.api.exec("uncheck-task",t)}expandTask(t){var e;(null===(e=this.getTask({id:t.id}))||void 0===e?void 0:e.collapsed)&&this.api.exec("expand-task",t)}collapseTask(t){var e;(null===(e=this.getTask({id:t.id}))||void 0===e?void 0:e.collapsed)||this.api.exec("collapse-task",t)}showCompletedTasks(){this.api.exec("show-completed-tasks",{})}hideCompletedTasks(){this.api.exec("hide-completed-tasks",{})}openInlineEditor(t){this.api.exec("open-inline-editor",t)}closeInlineEditor(t){this.api.exec("close-inline-editor",t)}assignUser(t){this.api.exec("assign-user",t)}unassignUser(t){this.api.exec("unassign-user",t)}addProject(t){this.api.exec("add-project",t)}updateProject(t){this.api.exec("update-project",t)}setProject(t){this.api.exec("set-project",t)}deleteProject(t){this.api.exec("delete-project",t)}_init(){var t;this._widget&&this.destructor();const e=new Map([["wx-i18n",a(null===(t=this.config)||void 0===t?void 0:t.locale)]]);this._widget=new _r({target:this.container,props:Object.assign({},this.config),context:e}),this.api=this._widget.api,this.events=new na(this.api)}},t.Toolbar=class{constructor(t,e){this.container="string"==typeof t?document.querySelector(t):t,this.config=e,this._init()}destructor(){this._toolbar.$destroy(),this._toolbar=this.api=this.events=null}setConfig(t){t&&(this.config=Object.assign(Object.assign({},this.config),t),this._init())}setLocale(t,e){t&&this.setConfig({locale:t,api:e})}_init(){var t;this._toolbar&&this.destructor();const e=new Map([["wx-i18n",a(null===(t=this.config)||void 0===t?void 0:t.locale)]]);this._toolbar=new ka({target:this.container,props:this._configToProps(this.config),context:e}),this.events=new na(this.api)}_configToProps(t){let e=[{type:"combo"},{type:"search"},{type:"menu"}];return(null==t?void 0:t.items)&&(e=this._normalizeItems(t.items)),Object.assign(Object.assign({},t),{items:e})}_normalizeItems(t){return t.map((t=>"string"==typeof t?{type:t}:"function"==typeof t?{type:"template",template:t}:t))}},t.todoUpdates=function(t,e){function n(t){if(!t)return null;for(const s in t)if("object"!=typeof t[s])switch(s){case"id":case"targetId":case"parent":t[s]=e(t[s],1)||null;break;case"project":t[s]=e(t[s],2)||null}else n(t[s]);return t}return{tasks:function(s){n(s);const{id:o}=s,{reverse:i,parent:r,project:a,targetId:c}=s.data||{};switch(s.type){case"add-task":t.exec("add-task",{id:o,project:a,parent:r,targetId:c,reverse:i,task:{...s.data},skipProvider:!0});break;case"update-task":t.exec("update-task",{id:o,task:{...s.data},skipProvider:!0}),s?.data?.batch?.forEach((e=>{t.exec("update-task",{id:e.id,task:e,skipProvider:!0})}));break;case"delete-task":t.exec("delete-task",{id:o,skipProvider:!0});break;case"move-task":if(s.data?.opbatch?.length)s.data.opbatch?.forEach((e=>{t.exec("move-task",{...e,skipProvider:!0})}));else if(s?.data?.batch?.length)s.data.batch?.forEach((n=>{n=e(n,1),t.exec("move-task",{id:n,project:a,parent:r,targetId:c,reverse:i,skipProvider:!0})}));else{const{id:e}=s.data;t.exec("move-task",{id:e,project:a,parent:r,targetId:c,reverse:i,skipProvider:!0})}break;case"clone-task":for(let e=0;e<s?.data?.batch?.length;e++){const n=s.data.batch[e];0===e?t.exec("add-task",{id:n.id,project:a,parent:r,targetId:c,task:n,reverse:i,skipProvider:!0}):t.exec("add-task",{id:n.id,project:a,parent:n.parent,targetId:s.data.batch[e-1]?.id,task:n,skipProvider:!0})}}},projects:function(n){const s=e(n.data.id,2);switch(n.type){case"add-project":t.exec("add-project",{id:s,project:{label:n.data.label},skipProvider:!0});break;case"update-project":t.exec("update-project",{id:s,project:{label:n.data.label},skipProvider:!0});break;case"delete-project":t.exec("delete-project",{id:s,skipProvider:!0});break;case"set-sort":if(n.data.project=e(n.data.project,2),t.getState().activeProject===n.data.project){const{by:e,dir:s}=n.data;t.exec("set-sort",{by:e,dir:s,tree:!0,skipProvider:!0})}}}}},t.uid=Pe,Object.defineProperty(t,"__esModule",{value:!0}),t}({});
//# sourceMappingURL=todo.js.map
