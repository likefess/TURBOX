# Шаблоны экспорта

----------

**Путь**: на панели Главного меню выбрать Управление - Открыть картотеку - Шаблоны экспорта или нажатием комбинация клавиш Alt+T

**Назначение:**  Хранение настроенных шаблонов экспорта документа. Связь данных Турбо с полями шаблона печатного документа и формирование новых документов на основании шаблона, созданного пользователем.

**Порядок работы с картотекой**:

![](topic:.AddFiles.Screenshot_20103.jpg)

**Назначение кнопок картотеки:**

* Кнопка Добавить ![](topic:Com.AddFiles.Buttons.Btn_Add.png) - создает новый документ *Шаблон экспорта*. Открывает пустой документ в режиме редактирования;
* Кнопка Просмотр ![](topic:Com.AddFiles.Buttons.Btn_view.png) - открывает выбранный документ для просмотра;
* Кнопка Редактировать ![](topic:Com.AddFiles.Buttons.Btn_Edit.png) - открывает выбранный документ в режиме редактирования;
* Кнопка Фильтры ![](topic:Com.AddFiles.Buttons.Btn_Filter.png) - вызывает список дополнительных действий по отображению записей картотеки;
* Кнопка Закрыть ![](topic:Com.AddFiles.Buttons.BtnCloseCancel.png) - выход из картотеки;
* Кнопка Дополнительно ![](topic:Com.AddFiles.Buttons.Btn_SystemMenu.png) - вызывает список допустимых функций с записями картотеки.

**Порядок работы с бланком**:

![](topic:.AddFiles.Screenshot_20104.jpg)

1. заполнить поля в блоке **Основное**

    - Код - формируется автоматически при создании карточки, допускается редактирование вручную;
    - Название - наименование шаблона экспорта. Заполняется вручную;
    - Расположение - место хранения файла шаблона, выбрать из списка: Локально / Файловый архив;
    - Входной файл - указать путь к файлу шаблона. В качестве входного файла используется подготовленный шаблон в формате xls, xlsx, doc, docx
        * для Расположение = Локально - указать путь на локальном диске или полный сетевой путь;
        * для Расположение = Файловый архив - выбрать файл из файлового архива из картотеки *Файлы* (кнопка Выбор ![](topic:Com.AddFiles.Btn_select.png)).
    - Расположение - расположения экспортируемого документа, выбрать из списка: Локально / Файловый архив;
    - Выходной каталог - указать путь для хранения экспортируемого файла.
        * для Расположение = Локально - указать каталог на локальном диске или полный сетевой путь;
        * для Расположение = Файловый архив - указать каталог файлового архива из картотеки "Файлы" (кнопка Выбор ![](topic:Com.AddFiles.Btn_select.png)). По умолчанию документ сохраниться в корневой каталог файлового архива.
    - Место исполнения - выбор из списка: Клиент / Сервер;

    *!Примечание: на рабочем месте пользователя должен быть обязательно установлен пакет MicrosoftOffice, в случае отсутствия приложения будет выдано сообщение об отсутствие приложения*.

    - Обработчик - способ заполнения выходного файла. Выбор доступен после указания входного файла. Устанавливается автоматически в зависимости от формата выбранного входного файла;
    - Имя файла - имя файла выгрузки, задается вручную или с помощью [макроса](topic:.DocPrint.Выбор макроса) (кнопка Выбор ![](topic:Com.AddFiles.Btn_select.png)).

2. заполнить поля в блоке **Настройки**

    Выполнить настройки действий с документом экспорта, отметив флаги:
    - флаг *Не сохранять сформированный документ* - в установленном состоянии означает, что после формирования документ открывается в редакторе для просмотра, редактирования, но не сохраняется физически на устройстве. При этом блокируются поля *Расположение*, *Выходной каталог*.
    Документ сохраняется вручную пользователем средствами редактора;
    - флаг *Не удалять после архивации* - флаг доступен при выборе в поле *Расположение* выходного каталога *Файловый архив*. В установленном состоянии означает, что сформированный файл сохраняется в файловый архив и во временном каталоге папки Turbo.
    Если флаг не установлен , то файл будет сформирован и сохранен только в корневом каталоге файлового архива или указанной папке файлового архива в поле *Выходной каталог*;
    - флаг *Вычислять динамические значения* - в установленном состоянии означает, что в поле Значение в таблице *Настройка заполнения полей* будет отображаться фактически вычисленное значение;
    - флаг *Всегда обновлять динамические значения* - флаг устанавливается, если какие-то значения между экспортом документов изменяются (дата, время, сумма и т.д.).

3. заполнить поля в блоке **Описание**

    - Описание - произвольное текстовое описание. Заполняется вручную;

4. заполнить поля таблицы **Настройка заполнения полей**

    Данные в таблицу загружаются автоматически из подготовленного файла шаблона для дальнейшей настройки.

     ![](topic:.AddFiles.Screenshot_20110.jpg)

    - Имя переменной -  заполняется автоматически из шаблона документа. Поле заблокировано для изменения;
    - В таблице - заполняется автоматически "Да", если переменная располагается в таблице, иначе "Нет". Поле заблокировано для изменения;
    - Формат - выбирается из выпадающего списка или прописывается вручную установленной логикой Турбо;
    - Источник данных - выбрать из выпадающего списка;
    - Тип значения - выбирается из списка. Список доступен, если в «Источнике данных» стоит значение «Ручной ввод»;
    - Значение - заполняется в зависимости от выбранного значения в поле «Источник данных» (особенности заполнения см. документ [Настройки Значения для разных источников данных](topic:.DocPrint.Настройки значения));
    - кнопки *Копировать настройки*![](topic:Com.AddFiles.Buttons.Btn_repeat.png)/ *Вставить настройки*![](topic:Com.AddFiles.Buttons.Btn_downloads.png) - копирование строки с настройками, которую можно вставить как в текущем документе, так и в другой документ.
    Копирование всей информации выбранной строки кроме имени переменной.


5. для таблицы доступны **Сервисы** (кнопка Дополнительно ![](topic:Com.AddFiles.Buttons.Btn_OK.png))

    - ***Режим копирования*** - включает/выключает кнопки *Копировать настройки*/*Вставить настройки* в строках таблицы;
    - ***Обновить поля*** - сервис используется для заполнения таблицы "Настройка заполнения полей" в соответствии с шаблоном документа. Поле *Входной файл* должно быть обязательно заполнено.
        - Если шаблон настроен корректно, то в таблицу добавится количество строк, равное количеству полей шаблона.
        - Если таблица не пустая - будет очищена и перезаполнена;
    - ***Сверить поля*** - сервис используется для сравнение полей уже имеющихся данных в таблице "Настройка заполнения полей" шаблона и входного документа(в случае если документ изменялся).
    Новые поля будут добавлены в таблицу, удаленные из шаблона - убраны из таблицы, остальные поля будут не тронуты. Если найдено не совпадение, то пользователю выводится сообщение о необходимости обновления шаблона;

6. для настроенного шаблона доступны **Сервисы** (кнопка Дополнительно ![](topic:Com.AddFiles.Buttons.Btn_OK.png))

    - ***Загрузить данные*** - формирование документов на основании настроенного шаблона и выбранных записей картотеки;
    - ***Сформировать документ*** - формирование выходного документа, в котором вместо размеченных областей шаблона будут заполнены значения из записи, с возможностью перехода к сформированному документу.

**Кнопки:**

- Сохранить и закрыть - нажмите кнопку **ОК** ![](topic:Com.AddFiles.Buttons.Btn_Ok_grey.png).

- Закрыть без сохранения изменений - **Отмена**![](topic:Com.AddFiles.Buttons.BtnCloseCancel.png). 