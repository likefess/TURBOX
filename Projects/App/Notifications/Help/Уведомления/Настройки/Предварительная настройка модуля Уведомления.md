#Предварительная настройка модуля Уведомления 

Перед началом работы необходимо выполнить следующие настройки:

* [ЗАПУСК ПЛАНИРОВЩИКА][Запуск планировщика]
* [НАСТРОЙКА ПЛАНИРОВЩИКА][Настройка планировщика]
* [НАСТРОЙКА ПОЧТОВОГО АККАУНТА][Настройка почтового аккаунта]
* [НАСТРОЙКА ЯКОРЯ][Настройка якоря] 
* [НАСТРОЙКА ГЛОБАЛЬНОГО ПАРАМЕТРА][Настройка глобального параметра]
* [НАСТРОЙКА РОЛЕЙ ДОСТУПА][Настройка ролей доступа]
* [НАСТРОЙКА СОТРУДНИКА][Настройка сотрудника]
* [НАСТРОЙКА ШАБЛОНА ТЕКСТА УВЕДОМЛЕНИЙ][Настройка шаблона текста уведомлений]  
* [НАСТРОЙКА ПРАВИЛ ГЕНЕРАЦИИ УВЕДОМЛЕНИЙ][Настройка правил генерации уведомлений]
* [ОТПРАВКА УВЕДОМЛЕНИЙ][Отправка уведомлений]
* [ПРОСМОТР ТЕКУЩИХ УВЕДОМЛЕНИЙ][Просмотр текущих уведомлений]  
* [ПРОСМОТР ВСЕХ УВЕДОМЛЕНИЙ][Просмотр всех уведомлений]



###Запуск планировщика

**Путь**: в файловом менеджере откройте папку размещения ТУРБО Х. Внутри папки запустите \Bin64\Control.exe

**Порядок заполнения**:

![](topic:.AddFiles.Screenshot_2084.jpg)

* Откройте окно «Службы ТУРБО»;
* Перейдите на закладку «Управление». Убедитесь, что служба «ТХ.Планировщик» находится в состоянии «Работает»; 
* Если служба не в Состоянии «Работает», то нажмите на кнопку запуска >. Состояние должно измениться на «Работает»;
* Закройте окно «Службы ТУРБО» нажатием на кнопку Х.

###Настройка планировщика

**Путь**: Уведомления/Настройки/Настройки/Настройка планировщика

**Порядок заполнения**:

1.По пункту меню «Настройка планировщика» откройте форму «Настройка планировщика»;

2.Заполните поля:

![](topic:.AddFiles.Screenshot_2085.jpg)

* Название – укажите название для планировщика;
* Дата – укажите дату отправки уведомлений, если необходима разовая отправка;
* Время – укажите время отправки уведомлений, если необходима разовая отправка;
* Периодическое – установите флаг, если необходима не разовая, а периодическая отправка уведомлений. При установленном флаге отображаются дополнительные параметры. Поля для разовой отправки («Дата» и «Время») недоступны для редактирования. Их значения сохраняются, но не используются;
* Условие срабатывания – выберите периодичность запуска планировщика. Доступны следующие:
    * Ежеминутно – запуск планировщика выполняется в определённые секунды каждой минуты. Дополнительно отображаются поля «Секунды» (секунда, в которую выполняется отправка) и «Интервал» (интервал, через который выполняется ежеминутная отправка). Если «Интервал» меньше 60 секунд, то в поле «Секунды» через запятую укажите секунды, в которые будет происходить отправка;
    * Ежечасно – запуск планировщика выполняется в определённые минуты каждого часа. Дополнительно отображаются поля «Минуты» и «Интервал» (настраиваются аналогично полям для ежеминутной отправки);
    * Ежедневно – запуск планировщика выполняется при наступлении дня. Дополнительно отображаются поля «Каждый день», «Понедельник», «Вторник» и т.д.;
    * Еженедельно – запуск планировщика выполняется при наступлении конкретного дня каждой недели. Дополнительно отображается поле «День недели»;
    * Ежемесячно – запуск планировщика выполняется в определённые дни каждого месяца.  Дополнительно отображаются поля «Дни» и «Интервал» (настраиваются аналогично полям для ежеминутной отправки);
    * Ежегодно – запуск планировщика выполняется в определённый день каждого года. Дополнительно отображаются поля «Месяц» и «День»;
* Повторять – укажите время, до которого работает планировщик;
* До – отображается, если Повторять установлено «До даты». Укажите дату, до которой выполняется работа планировщика;
* Активно всегда – если планировщик работает в любое время, то установите флаг. Если необходима работа в конкретном временном промежутке, то снимите флаг;
* Активно с – при необходимости, укажите начало временно промежутка отправки уведомлений;
* До – при необходимости, укажите конец временно промежутка отправки уведомлений;
* Дата – установите флаг, если начало и конец временного промежутка отправки уведомлений должны быть конкретными датами;
* Время – установите флаг, если начало и конец временного промежутка отправки уведомлений должны быть конкретным временем дня.


3.После заполнения полей с параметрами отправки уведомлений нажмите кнопки **Сервис** ![](topic:.AddFiles.Btn_Services.png)   и  выберите опцию **Создать задание для планировщика**.

4.Если настройки планировщика заданы не корректно или необходимо удаление планировщика нажмите кнопку **Сервис**  ![](topic:.AddFiles.Btn_Services.png) и выберите  опцию **Удалить задание из планировщика**.

5.Для ввода в действие введенной информации нажмите на кнопку **Применить** ![](topic:.AddFiles.Btn_OK.png) .
Для сохранения документа и его закрытия нажмите кнопку **ОК** ![](topic:.AddFiles.Btn_Post.png) , иначе  -  **Отмена**![](topic:.AddFiles.BtnCloseCancel.png).

###Настройка почтового аккаунта

**Путь**: Администрирование/Настройки/Базовые настройки/Почтовые аккаунты

**Порядок заполнения**:

1.По пункту меню «Почтовые аккаунты» откройте форму «Почтовый аккаунт»

![](topic:Bas.Администрирование.AddFiles.Screenshot_2087.jpg)

2.Заполните поля:
 
* Почтовый адрес – укажите адрес почтового ящика;
* Имя отправителя – укажите имя, которым будут подписаны письма;
* Отправлять асинхронно при возможности – установите данный флаг;
* Отправлять на сервере при возможности – убедитесь, что флаг не установлен;
* Аккаунт не используется – установите данный флаг, если этот аккаунт не используется;
* Отправка – укажите сетевой протокол, который используется для рассылки электронной почты. Дальнейшие настройки зависят от выбранного протокола и уточняются у сервиса электронной почты.

3.Для проверки введённых настроек нажмите кнопку Тестовое письмо и введите адрес электронной почты, на который будет отправлено тестовое письмо. Проверьте электронную почту, на которую должно прийти электронное письмо.

4.Для сохранения настройки нажмите кнопку ОК.

###Настройка якоря

**Путь**: Администрирование/Настройки/Базовые настройки/Якоря

**Порядок заполнения**:

1.По пункту меню «Якоря» откройте форму «Якоря (данные участников)»

![](topic:.AddFiles.Screenshot_2088.jpg)

2.Найдите запись с кодом «DefaultMailAccount» и названием «Почтовый аккаунт по умолчанию».

3.Проверьте заполнение полей записи:

* Тип значения – выбрано значение «Объект (запись)»;
* Вид переменной – выбрано значение «глобальная»;
* Имя картотеки – выбрано значение Bas.Tab.Config.EMailServer;
* Значение - укажите активный и заведомо рабочий почтовый аккаунт.
 
4.Для сохранения настройки нажмите кнопку ОК.


###Настройка глобального параметра

[Глобальные настройки, параметры](topic:Bas.Администрирование.Настройки.Глобальные настройки)

При настройке уведомлений используется параметр  ShedulerHostName.
* Для локальной настройки в поле Значение указать 127.0.0.1:

  ![](topic:Bas.AddFiles.Screenshot_11966.jpg)

* Если планировщик запущен на сервере - в поле Значение указать IP-адрес и порт сервера в формате:

  ![](topic:Bas.AddFiles.Screenshot_11967.jpg)





###Настройка ролей доступа

**Путь**: Администрирование/Настройки/Управление доступом/Роли доступа

По умолчанию в карточке роли доступа отключены дополнительные права по использованию уведомлений. При необходимости, выполните настройку.

**Порядок заполнения**:

1.По пункту меню «Роли доступа» откройте форму «Роль (набор прав) пользователя»


2.Перейдите на закладку «Уведомления» в бокс «Разрешения»

3.Заполните поля:

![](topic:.AddFiles.Screenshot_2089.jpg)
 
* Разрешено настраивать правила уведомлений – при установленном флаге пользователь может выполнять дальнейшие настройки;
* Разрешено просматривать чужие уведомления – при необходимости просмотра чужих уведомлений, установите флаг. Без установленного флага допускается просматривать только уведомления, которые адресованы текущему пользователю.

4.Для сохранения настроек нажмите кнопку ОК.

###Настройка сотрудника

**Путь**: Справочник открывается из выбранного проекта, например, Управление цепочками поставок/Настройки/Базовые справочники/Сотрудники

**Порядок заполнения**:

1.По пункту меню «Сотрудники» откройте форму «Сотрудник».

2.Перейдите на закладку «Кадры». Заполните в блоке "Контакты" следующие поля:

![](topic:.AddFiles.Screenshot_2090.jpg)

- E_Mail – указать адрес электронной почты сотрудника;
- E_Mail2 – при необходимости указать второй адрес электронной почты сотрудника.

3.Перейдите на закладку «Вход в систему». Проверьте, что к карточке сотрудника привязана учетная запись пользователя. Иначе, привяжите имеющуюся, или создайте новую запись пользователя.

![](topic:.AddFiles.Screenshot_2091.jpg)

4.Перейдите на закладку «Уведомления». Заполнить поля:

![](topic:.AddFiles.Screenshot_2092.jpg)

- Формировать уведомление в клиенте Турбо - установить флаг, если для пользователя, привязанного к данному сотруднику, необходимо формирование уведомлений (как в ТУРБО Х, так и по электронной почте);
- Показывать всплывающие окна для уведомлений - установить флаг, если для пользователя, привязанного к данному сотруднику, необходимо отображать мигающие иконки, при поступлении уведомления в ТУРБО Х;
- Отправить уведомление по электронной почте – установить флаг, если для пользователя, привязанного к данному сотруднику, необходимо формировать электронные письма на почту;
- Удалять прочитанные уведомления – установить флаг, если для пользователя, привязанного к данному сотруднику, необходимо автоматически после прочтения удалять уведомления, сформированные в ТУРБО Х.

5.Для сохранения настроек нажмите кнопку ОК.

###Настройка шаблона текста уведомлений

**Путь**: Уведомления/Настройки/Настройки/Шаблоны текстов уведомлений

**Порядок заполнения**:

1.По пункту меню «Шаблоны текстов уведомлений» откройте форму «Шаблон текста уведомления».

2.Заполните поля:

![](topic:.AddFiles.Screenshot_2095.jpg)

* Код шаблона – заполняется автоматически. Изменяется вручную при необходимости;
* Описание – укажите произвольное описание;
* Тема – укажите тему, которая будет установлена в электронное письмо и в уведомление в ТУРБО Х;
* Текст уведомления – укажите текст, который будет установлен в электронном письме в уведомлении в ТУРБО Х.

***Важно***: при необходимости вставки в тему или текст уведомления значения какого-либо поля документа или справочника, укажите системное название этого поля со спецсимволом % (например, %Name%).

3.Для сохранения настроек нажмите кнопку ОК.


###Настройка правил генерации уведомлений

**Путь**: Уведомления/Настройки/Настройки/Правила генерации уведомлений

Выполнение настроек в данной форме возможно только в том случае, если корректно настроены роли доступа.

Порядок заполнения:

1.По пункту меню «Правила генерации уведомлений» откройте форму «Правило генерации уведомлений».

2.На закладке «Основное» заполните поля:

![](topic:.AddFiles.Screenshot_2097.jpg)

* Блок «Создать уведомления для»:

    * Код правила – заполняется автоматически от нумератора. При необходимости, измените вручную;
    * Описание – произвольный текстовый комментарий. Укажите при необходимости;
   * Предприятие – если необходимо, чтобы данное правило работало только для одного предприятия, заполните поле. Если правило должно работать на все предприятия, оставьте поле пустым;
   * Проект – укажите проект, к которому относится документ или справочник, по которому нужно формировать уведомления;
   * Класс записи – укажите документ или справочник, по которому нужно формировать уведомления;
   * Событие – укажите событие, по которому должно происходить создание уведомления. Возможна генерация уведомлений по созданию записи («Запись создана»), по удалению записи («Запись удалена»), по изменению значения поля («Изменение») или по установке конкретного значения в поле («Установлено на»);
   * Поле – название поля документа или справочника. Доступно для редактирования, если в качестве события выбрано «Изменение» или «Установлено на»;
   * Значение – значение поля, указанного выше, при установке которого будет сформировано уведомление. Доступно для редактирования, если в качестве события выбрано «Установлено на»;
   * Завершен – установите признак, если по данному правилу больше не нужно формировать уведомления. Уже созданные, но не отправленные уведомления, будут отправлены при следующей рассылке;

* Блок  «Уведомить для»:
    * Уведомить для – если необходимо, чтобы данное правило работало только для документов или справочников с определённой аналитикой, то установите значение «Записи, соответствующие заданному фильтру», и по кнопке рядом откройте форму фильтра, укажите аналитики и их значение. Если необходимо формировать уведомления по всем записям, то установите значение «Все записи»;
* Блок  «Уведомить до»:
    * Дата окончания – укажите дату, до которой должно работать данное правило. Если поле пустое, то уведомления формируются бессрочно;
* Блок  «Сообщения»:
   * Эл. почта отправителя – укажите электронную почту, с которой должна происходить рассылка электронных писем;
    * Шаблон уведомления – если необходимо использовать уже заготовленный шаблон сообщений, выберите значение из справочника;
    * Тема – укажите тему, которая будет установлена в уведомление и/или электронное письмо;
    * Текст уведомления – укажите текст, который будет установлен в уведомление и/или электронное письмо.

***Важно***: при необходимости вставки в тему или текст уведомления значения какого-либо поля документа или справочника, укажите системное название этого поля со спецсимволом % (например, %Name%).

3.На закладке «**Уведомить кого**» заполните поля:

![](topic:.AddFiles.Screenshot_2098.jpg)
 
* Тип назначения – укажите тип адресата, которому должно быть доставлено уведомление. «Пользователь» - для выбора конкретного сотрудника и привязанного к нему пользователя. «Роль пользователей» - для выбора группы сотрудников с данной ролью и привязанных к ним пользователей;
* Назначение – в зависимости от выбранного типа назначения укажите сотрудника или роль;
* Показывать всплывающие окна для уведомлений – при установленном флаге, пользователю отображаются мигающие иконки, при поступлении уведомления в ТУРБО Х;
- Уведомление по эл. почте – при установленном флаге, пользователю или группе пользователей происходит рассылка электронных писем;
* Эл. почта получателя – адрес электронной почты получателя уведомления. Автоматически заполняется из карточки указанного сотрудника. При необходимости, можно изменить вручную. Не заполняется для рассылки по роли пользователей, так как при рассылке по роли адрес подбирается из карточки сотрудника.

4.При необходимости просмотра уведомлений, сформированных по данному правилу, нажмите кнопку "**Сервис**"![](topic:.AddFiles.Btn_Services.png) и выберите пункт **Список уведомлений**.

5.Для сохранения записи нажмите кнопку ОК. 


***Примечание***: Также в Системе доступно создание правила генерации уведомлений из различных документов и справочников. 

При этом часть полей карточки правила генерации уведомлений уже будут заполнены автоматически. Доступно только пользователям с определённой настройкой прав. Для вызова нажмите кнопку Сервис  ![](topic:.AddFiles.Btn_Services.png) и выберите пункт **Создать правило генерации уведомления**.

###Отправка уведомлений

**Путь**: Уведомления/Данные/Основные данные/Отправка уведомлений

**Назначение формы**: Форма предназначена для ручного запуска отправки сформированных, но ещё не отправленных уведомлений.

В ТРУБО Х возможна отправка уведомлений следующими способами:

* Автоматически при помощи планировщика.
Автоматическая отправка выполняется планировщиком и доступна в многопользовательском режиме. Для запуска планировщика предварительно выполните настройку.
* Вручную.

Порядок ручного заполнения:

1.По пункту меню «Отправка уведомлений» откройте форму «Отправка уведомлений».

2.Заполните поля:

![](topic:.AddFiles.Screenshot_2101.jpg)

* Дата с – укажите начальную дату периода. Для отправки будут отобраны только уведомления, попадающие в период. Если оставите поле пустым, то будут отобраны все уведомления до даты, указанной в следующем поле;
* Дата по – укажите конечную дату периода. Для отправки будут отобраны только уведомления, попадающие в период. Если оставите поле пустым, то будут отобраны все уведомления с даты, указанной в предыдущем поле;
* Компания – укажите предприятие, по которому необходимо отправить уведомление. Если оставите поле пустым, то будут отобраны уведомления по всем предприятиям.

3.После заполнения полей нажмите кнопку **Отправить**. Форма закроется автоматически.


###Просмотр текущих уведомлений

**Путь**: Уведомления/Данные/Основные данные/Текущие уведомления

**Порядок использования**:

Для просмотра текущих непрочитанных уведомлений откройте картотеку по указанному пути или воспользуйтесь кнопкой  Уведомления ![](topic:.AddFiles.Btn_notif.png) на панели инструментов.

![](topic:.AddFiles.Screenshot_2109.jpg)

В открывшейся форме "Уведомления" выберите нужное уведомление и для перехода внутрь картотеки нажмите левой кнопкой мыши на выбранную запись. 

![](topic:.AddFiles.Screenshot_2111.jpg)

Назначение кнопок картотеки:

* Редактировать  ![](topic:.AddFiles.Btn_Edit.png)  - открывает для редактирования выбранную запись картотеки;
* Фильтры  ![](topic:.AddFiles.Btn_Filter.png) - применить фильтры к картотеке;
* Сервис ![](topic:.AddFiles.Btn_Services.png)  - перейти к источнику - открывает документ источник уведомления;
* Закрыть ![](topic:.AddFiles.BtnCloseCancel.png) - выход из картотеки;
* Применить ![](topic:.AddFiles.Btn_OK.png) - открывает список действий, применяемых к картотеке:
    * Удалить - удаляет выделенную запись;
    * Импорт - импорт записей в картотеку; 
    * Экспорт - экспорт выбранных записей в каталог; 
    * Помощь - также кнопка F1 для получения помощи.

*Внимание! после просмотра уведомление перестает отображаться в картотеке "Текущие уведомления". Для повторного отображения необходимо зайти в карточку уведомления и установить флаг не прочитано*. 

2.Дальнейшая работа с текущими уведомлениями аналогична работе со списком уведомлений  Все уведомления.

Внутри карточки уведомления можно прочитать тему и текст уведомления, посмотреть было ли сформировано письмо на электронную почту, а также перейти к документу или справочнику, на основании которого было создано уведомление.

![](topic:.AddFiles.Screenshot_2105.jpg)

Для перехода к документу или справочнику нажмите кнопку **Сервис** ![](topic:.AddFiles.Btn_Services.png) и выберите пункт **Перейти к источнику**.

3.На закладке «**Основание**» имеются поля, по которым можно отследить как было создано уведомление:

* Код правила – код правила генерации уведомлений, по которому было создано уведомление;
* Документ – документ или запись справочника, по которой было создано уведомление;
* Класс записи – класс записи документа или справочника, по которому было создано уведомление.

4.Для закрытия карточки уведомления нажмите кнопку **ОК**. Уведомление помечено как прочитанное, и теперь доступно только в картотеке «Все уведомления», либо удалено. Автоматическое удаление прочитанных уведомлений настраивается в карточке сотрудника  на закладке Уведомления.


###Просмотр всех уведомлений

**Путь**: Уведомления/Данные/Основные данные/Все уведомления

**Порядок использования**:

По пункту меню «Все уведомления» откройте картотеку «Список уведомлений».

![](topic:.AddFiles.Screenshot_2104.jpg)

В зависимости от прав пользователя, могут быть доступны уведомления, назначенные другим сотрудникам.

Записи картотеки открываются для просмотра двойным щелчком левой кнопки мыши или с помощью кнопки Редактировать  ![](topic:.AddFiles.Btn_Edit.png).

1.Уведомление открывается для просмотра из картотеки Список уведомлений.

2.Внутри карточки уведомления можно прочитать тему и текст уведомления, посмотреть было ли сформировано письмо на электронную почту, а также перейти к документу или справочнику, на основании которого было создано уведомление.

![](topic:.AddFiles.Screenshot_2114.jpg)

Для редактирования доступно только изменение статуса уведомления: при установленном флаге "Непрочитанно" уведомление автоматически попадает в картотеку Текущие уведомления.

Для перехода к документу или справочнику нажмите кнопку **Сервис** ![](topic:.AddFiles.Btn_Services.png) и выберите пункт **Перейти к источнику**.

3.На закладке «**Основание**» имеются поля, по которым можно отследить как было создано уведомление:

* Код правила – код правила генерации уведомлений, по которому было создано уведомление;
* Документ – документ или запись справочника, по которой было создано уведомление;
* Класс записи – класс записи документа или справочника, по которому было создано уведомление.

4.Для закрытия карточки уведомления нажмите кнопку **ОК**. Уведомление помечено как прочитанное, и теперь доступно только в картотеке «Все уведомления», либо удалено. Автоматическое удаление прочитанных уведомлений настраивается в карточке сотрудника  на закладке Уведомления.

Назначение кнопок картотеки:

* Редактировать  ![](topic:.AddFiles.Btn_Edit.png)  - открывает для редактирования выбранную запись картотеки;
* Фильтры  ![](topic:.AddFiles.Btn_Filter.png) - применить фильтры к картотеке;
* Сервис ![](topic:.AddFiles.Btn_Services.png)  - перейти к источнику - открывает документ источник уведомления;
* Закрыть ![](topic:.AddFiles.BtnCloseCancel.png) - выход из картотеки;
* Применить ![](topic:.AddFiles.Btn_OK.png) - открывает список действий, применяемых к картотеке:
    * Удалить - удаляет выделенную запись;
    * Импорт - импорт записей в картотеку; 
    * Экспорт - экспорт выбранных записей в каталог; 
    * Помощь - также кнопка F1 для получения помощи.


----------
