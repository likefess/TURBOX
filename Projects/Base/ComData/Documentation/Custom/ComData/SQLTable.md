---
Keywords: SQL.Table, SQLTable
---

# Компонент SQL.Table

Компонент SQL.Table реализует интерфейс [IKeyCursor](IKeyCursor "Интерфейс IKeyCursor") для доступа к Базам
Данных (БД):

* Microsoft SQL (MS SQL);
* PostgreSQL.


Компонентные классы созданные на основе SQL.Table позволяют определить колонки таблицы БД, как свойства класса,
обеспечивая синтаксическую подсказку при написании кода, осуществляющего работу с БД.

## Вложенные компоненты

Компонент поддерживает следующие вложенные компоненты:

* [IDataField](IDataField "Компонент IDataField") - определяет колонку таблицы БД.


## Сценарии использования

Для компонента **SQL.Table** применимы все сценарии использования, описанные для интерфейса [IKeyCursor](IKeyCursor "Интерфейс IKeyCursor").


### Чтение из таблицы БД.

Работа с БД при помощи компонента **SQL.Table** разбивается на три задачи:

* создание компонентного класса на основе **SQL.Table**, содержащего описание структуры таблицы;
* установка переменных параметров работы с БД;
* чтение данных, используя методы интерфейса [IRWCursor](IRWCursor.Default "Интерфейс IRWCursor").


## Типы

Используются типы, определенные в интерфейсе [IKeyCursor](IKeyCursor "Интерфейс IKeyCursor")

## Свойства

Используются все свойства, определенные в интерфейсе [IKeyCursor](IKeyCursor "Интерфейс IKeyCursor"). Также добавлены свойства:

Свойство **Connector** позволяет выбрать метод подключения к БД - через ADO (ADO connector), либо с помощью DBConnection (Turbo connector).
Turbo connector является системно-независимым методом подключения к БД и используется, например, при установке Turbo на ОС Linux.

Свойство **ConnectionString** (строка подключения) отвечает за параметры соединения с базой данных.
В зависимости от выбранного типа БД, параметры могут включать в себя:
* наименование драйвера/коннектора к БД;
* адрес расположения сервера с БД;
* порт;
* имя пользователя (логин);
* пароль;
* название БД на сервере;
* кодировку, настройки шифрования и прочее.

Типовые примеры строки подключения для подключения к PostgreSQL и MSSQL при использовании *ADO connector* соответственно:

**Driver**=PostgreSQL Unicode; **Server**=localhost; **Port**=5432; **Database**=Test; **User ID**=Username; **Password**=passw

**Provider**=MSOLEDBSQL; **Server**=MyServer\SQLEXPRESS; **Database**=Test; **User Id**=Username; **Password**=passw;

Типовые примеры строки подключения для подключения к PostgreSQL и MSSQL при помощи *Turbo connector* соответственно:

**DriverName**=PostgreSQL_DBX;**Host**=localhost:5432;**Base**=Test1;**DBUser**=postgres;**DBPassword**=passw1;

**DriverName**=MSSQL2019_ADO;**Host**=\SQLEXPRESS;**Base**=Test1; **DBUser**=Admin1;**DBPassword**=passw1;

Подключение по умолчанию производится с сервера Турбо, на котором открыта сессия. Для подключения c другого сервера необходимо
добавить в строку подключения параметры: **DataServer**='ExampleHost';**User**='UserWithAdminRules';**Password**='MyPassword';

Для подключения к базе данных по её имени, используя *Turbo connector*, в строке подключения нужно указать только имя БД.

В качестве источника данных можно выбрать один из вариантов: хранимую процедуру, SQL-запрос или название таблицы соответственно.
* **ServerProc**
* **SQLString**
* **TableName**


## Методы

Используются методы, определенные в интерфейсе [IKeyCursor](IKeyCursor "Интерфейс IKeyCursor").

-------
###Примечание

**proc Close** необходимо вызывать в конце работы с курсором для закрытия соединения с БД.

-------