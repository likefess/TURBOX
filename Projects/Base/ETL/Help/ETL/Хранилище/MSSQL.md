

 ---
Keywords: MSSQL
---


#Развёртывание Хранилища ETL на базе Microsoft SQL (MS SQL)

Развертывание Хранилища ETL состоит из следующих шагов:

* [Настройка БД хранилища][Настройка БД хранилища]
    * [Создание пользователя и определение роли][Создание пользователя и определение роли]
    * [Создание БД хранилища][Создание БД хранилища]

* [Настройка подключения к хранилищу в Турбо][Настройка подключения к хранилищу в Турбо]
    * [Установка драйвера ODBC][Установка драйвера ODBC]
    * [Настройка точки подключения][Настройка точки подключения]

Наиболее распространенные проблемы при настройке Хранилища ETL в СУБД семейства MS SQL
собраны в разделе [Типовые ошибки][Типовые ошибки].

## Настройка БД хранилища

### Создание пользователя и определение роли
  В обозревателе объектов Microsoft SQL Server Management Studio необходимо
  выбрать сервер, на котором будет размещаться хранилище ETL.

  ![](topic:.AddFiles.Screenshot_11661.jpg)

  Если пользователь БД не создан, то необходимо в контекстном меню, вызываемом по щелчку правой кнопки мыши, объекта "Безопасность/Имена для входа"
  выбрать пункт "Создать имя для входа".

 ![](topic:.AddFiles.Screenshot_11664.jpg)

 В открывшемся окне "Создание имени для входа" необходимо:
 * ввести логин пользователя в поле "Имя для входа". В данном примере имя пользователя "Admin9";
 * выбрать пункт "Проверки подлинности SQL Server";
 * ввести пароль и подтверждение пароля в соответствующие поля;
 * убрать флаг "Пользователь должен сменить пароль при следующем входе";
 * нажать кнопку "OK".

 ![](topic:.AddFiles.Screenshot_11665.jpg)




### Создание БД хранилища
В контекстном меню, вызываемом по щелчку правой кнопки мыши, объекта "Базы данных" выбрать пункт "Создать базу данных..."

 ![](topic:.AddFiles.Screenshot_11662.jpg)

В появившемся окне ввести название базы данных для хранилища ETL в поле "Имя базы данных:" и логин ранее созданного пользователя в поле "Владелец:".
В данном случае выбрано название "ETL_Storage" и пользователь "Admin9".
Нажать кнопку "OK".

![](topic:.AddFiles.Screenshot_11663.jpg)

## Настройка подключения к хранилищу в Турбо

### Установка драйвера ODBC
Драйвер необходим для осуществления доступа из Турбо к выбранной базе данных (БД).
Установка драйвера ODBC должна выполняться на сервере.
Если драйвер ODBC не установлен, его необходимо скачать по ссылке
[Драйвер ODBC](https://docs.microsoft.com/ru-ru/sql/connect/odbc/download-odbc-driver-for-sql-server?view=sql-server-ver15) и запустить.

Начиная с 19 версии требуется SSL, иначе возникает ошибка:

![](topic:.AddFiles.Screenshot_11951.jpg)

Для устранения требуется выполнить один из предложенных вариантов:

* настроить SSL на сервере MSSQL, воспользовавшись
[инструкцией к выпуску драйвера для SQL Server](https://docs.microsoft.com/en-us/sql/connect/oledb/release-notes-for-oledb-driver-for-sql-server?view=sql-server-ver16#1900);
* если без SSL, то занести параметр *Use Encryption for Data=False*:
 ![](topic:.AddFiles.Screenshot_11952.jpg)


### Настройка точки подключения

Необходимо ввести значения в
[точку подключения к хранилищу ETL](topic:.ETL.Сервис.Настройки.Точка подключения к хранилищу ETL):
* в параметре ConnectionString указать строку параметров для подключения к MS SQL;
* в параметре "DataBaseType" указать "MSSQL".

Строка подключения может иметь разный вид, в зависимости от желаемых настроек БД, авторизации пользователя и прочих параметров.
В простейшем случае используется следующая строка:
*Provider=MSOLEDBSQL; Server=ServerName\SQLEXPRESS; Database=ETL_Storage; User Id=Admin9; Password=passw1;*
где:
* **Provider** - определяет драйвер, который будет использован для подключения к БД.
Обычно используются два типа драйверов для подключения - драйверы OLE DB и ODBC.
 Если есть возможность, необходимо использовать подключение по OLE DB - более современный способ, который работает намного быстрее;
* **Server**  - название экземпляра SQL Server, на котором установлено хранилище ETL;
 Это может быть название локального сервера, например, "MyPC/SQLEXPRESS", либо сетевой адрес. По умолчанию экземпляр сервера именуются шаблоном ".\SQLEXPRESS";
* **Database** - название БД, в данном примере "ETL_Storage";
* **User Id** - логин пользователя, в данном примере "Admin9";
* **Password** - пароль пользователя, в данном примере "passw1".

Для проверки подключения к хранилищу воспользуйтесь кнопкой ![](topic:Com.AddFiles.Buttons.Btn_setting.png).
В выпадающем меню необходимо выбрать "Проверка подключения сервера к хранилищу".
Должно появиться Информационное сообщение: "Подключение успешно", а также версии сервера БД и драйвера ODBC.

## Типовые ошибки
При проверке подключения к хранилищу, Турбо выдаст сообщение:
* в случае, если логин или пароль введены неверно

  ![](topic:.AddFiles.Screenshot_11673.jpg)

* если не установлен драйвер (или установка произошла некорректно)

  ![](topic:.AddFiles.Screenshot_11674.jpg)