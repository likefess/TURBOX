#Датчики Ctrl.IGadget

---
###Назначение
Датчики могут использоваться как для визуализации данных отчёта так и для произвольных данных.

Визуальной составляющей датчика является специальным образом подготовленный шаблон svg-файла.
Шаблон содержит макросы (строки вида %макро%), которые на этапе формирования подменяются актуальными значениями.
Это позволяет влиять из кода не только на отображаемые значения, но и на видимость элементов, цвета, угол поворота стрелки и прочие параметры.

В простейшем случае датчик является аналогом Ctrl.IStatic и отображает единственное значение ("Карточка 1").
В более сложных случаях это может быть значение отражаемое стрелкой на шкале ("Датчик 1"),
а в общем - ограничены только возможностями svg-файлов и фантазией разработчика.

---
###API датчиков
**Публичные свойства объекта**

####`GadgetType    :String`
  Зарегистрированный тип датчика.
  Если передаётся неизвестное значение, то будет использован "Датчик 1".
####`Caption       :String`
  Надпись на датчике (заголовок).
####`Value         :Numeric`
  Текущее значение датчика.
####`ValueMin      :Numeric`
  Минимальное значение датчика.
####`ValueMax      :Numeric`
  Максимальное значение датчика.
####`Format        :String`
  Формат отображаемого значения.
####`ShowValue     :Logical`
  Показывать числовое значение.
####`HighlightColor :String`
  Цвет выделения для шкалы. Значение по умолчанию `#0bd688`.
####`DefaultColor   :String`
  Цвет элементов шкалы. Значение по умолчанию `#151b3b`.

**Публичные свойства класса**
####`GadgetTypes :String[]`
  Перечень зарегистрированных типов датчиков.
####`GadgetNames :String[]`
  Перечень зарегистрированных наименований датчиков.
####`GadgetArray :String[]`
  Перечень для заполнения списка в перечислимом поле.

---
###Стандартные макросы svg-шаблона
В svg-шаблоне доступны макросы:
- `%gauge%` - значение датчика в единицах шкалы
- `%value%` - значение датчика (абсолютное)
- `%percent%` - значение датчика в процентах
- `%caption%` - надпись датчика
- `%path%` - часть дуга от нуля до значения датчика (позволяет реализовывать окрашенную шкалу)

Если svg-шаблон использует отметки (риски) на шкале датчика, то дополнительно доступны макросы:
- `%valueMin%`, `%valueMax%` - минимальное и максимальное значения
- `%10%`, `%20%`, `%30%`, `%40%`, `%50%`, `%60%`, `%70%`, `%80%`, `%90%` - значение соответствующего элемента шкалы
- `%tickColor1%`, `%tickColor2%`, `%tickColor3%`, `%tickColor4%`, `%tickColor5%`, `%tickColor6%`, `%tickColor7%`, `%tickColor8%`, `%tickColor9%`, `%tickColor10%`, `%tickColor11%` - цвет соответствующей риски шкалы

---
###Добавление собственных датчиков в надпроектах

Датчик состоит из двух частей: класс-наследник `Com.Ctrl.IGadget` и svg-файл с шаблоном датчика.
Класс-наследник должен содержать:
- описание класса, которое будет использоваться как наименование зарегистрированного датчика
- метод `func InitSvg :String`, который инициализирует датчик и возвращает имя svg-шаблона

Простейший пример:
```
class inherited InfoBoard.Ctrl.IGadget "@InfoBoard:GadgetDemo=Пример датчика";

inobject private

  #override
  func InitSvg :String
    Result = 'Attachment\Svg\card.svg'
  end

end
```

Пример svg-шаблона **card.svg**:
```
<?xml version="1.0" encoding="windows-1251"?>
<svg width="490" height="284" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">
  <rect fill="pink" width="490" height="284" rx="15"/>
  <text fill="#FF0000" text-anchor="middle" font-size="72" y="158" x="245">%value%</text>
  <text fill="#FF0000" text-anchor="middle" font-size="24" y="190" x="245">%caption%</text>
</svg>
```

Наследники могут вводить собственные макросы, обработка которых должны производиться в методе `ReplaceSvgMacros`.