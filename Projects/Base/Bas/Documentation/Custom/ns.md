#Именованные настройки
---
Задача [TXAPP-3647](http://dragon.tengry.com/jira/browse/TXAPP-3647)

---

Это настройки, сохраняемые пользователем, с возможностью быстрого переключения.
Применяются для: картотек, отчётов, инфопанелей.

Для картотек сохраняются:
- фильтр
- упорядочивание
- иерархичность
- текущая папка
- раскладка столбцов

Для отчётов сохраняются:
- период (может быть динамическим)
- значения параметров.

Для инфопанелей сохраняются настройки размещённых на панели элементов (отчётов и картотек).
Для отчётов встроенных в панели видимость кнопки определяется флагом "Скрыть параметры и настройки".

Имя применённой настройки показывается в заголовке окна, в скобоках после имени окна.

Для картотек команды работы с именованными настройками размещаются в меню "Фильтры",
для отчётов и панелей появляется новая кнопка с командами "Управление именованными настройками".

Выбранная настройка сохраняется при закрытии окна, таким образом настройка восстанавливается при повторном открытии.

---
###Команды

#####"Сохранить настройки..."
Команда сохраняет текущий набор настроек под заданным именем
Если настройка с таким именем уже существует, то будет предложено на выбор:
- заменить существующий набор настроек текущим
- сохранить текущий набор под другим именем
- отменить сохранение

#####"Диспетчер настроек"
Открывает картотеку "Диспетчер настроек"

После команды "Диспетчер настроек" в алфавитном порядке идёт список настроек созданных пользователем,
а так же доступных ему в соответствии с правами доступа.
Клик на команде настройки применяет её.

Если список настроек не пуст, то в конце добавляется команда "Без настроек".
Она сбрасывает сохранённую настройку и заполняет сохраняемые параметры значениями по умолчанию.

---
###Диспетчер настроек

При открытии из настраиваемого объекта диспетчер показывает список настроек, которые могут быть к нему применены.
Двойной клик по настройке применяет её и закрывает диспетчер.

В меню "Фильтры" диспетчера есть особые команды "Показывать настройки других пользователей" и "Копировать себе".

"Показывать настройки других пользователей" позволяет включить отображение настроек созданных другими пользователями.
Они доступны только на чтение.

"Копировать себе" позволяет сдублировать 'чужую' настройку себе, чтобы иметь возможность изменить её.

Пользователь не обладающий правами администрирования может редактировать/удалять только свои настройки.
На редактирование ему доступно только наименование.

Администратор может редактировать чужие настройки, кроме этого ему доступно изменение владельца настройки и роли,
к которой она относится.

---
###Настройки

Именованные настройки хранятся в отдельной записи Bas.Config.NamedSettings и содержат следующие параметры:
- Форма и, если необходимо, запись, к которой относится настройка.
- Наименование заданное введённое пользователем.
- Пользователь и роль к которым относится настройка.
- Текст настройки в формате json.

Если у настройки задан пользователь, то такая настройка отображается у него в списке и доступна ему для редактирования.

Если у настройки задана роль, то такая настройка отображается у него в списке,
её изменение доступно только администратору.

Если у настройки не задан ни пользователь ни роль, то такая настройка отображается в списке у всех,
её изменение доступно только администратору.